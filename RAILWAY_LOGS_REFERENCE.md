# Railway 日誌輸出完整參考手冊

> **版本**: v3.34+  
> **更新日期**: 2025-11-10  
> **用途**: Railway 部署後的日誌監控指南

---

## 📋 目錄

1. [系統啟動日誌](#1-系統啟動日誌)
2. [數據庫操作日誌](#2-數據庫操作日誌)
3. [交易執行日誌](#3-交易執行日誌)
4. [信號生成日誌](#4-信號生成日誌)
5. [倉位監控日誌](#5-倉位監控日誌)
6. [WebSocket 連接日誌](#6-websocket-連接日誌)
7. [模型訓練日誌](#7-模型訓練日誌)
8. [風險控制日誌](#8-風險控制日誌)
9. [健康監控日誌](#9-健康監控日誌)
10. [錯誤和警告日誌](#10-錯誤和警告日誌)

---

## 1. 系統啟動日誌

### 1.1 初始化標頭
```
================================================================================
🚀 SelfLearningTrader v4.0+ 啟動中...
📌 核心理念: 模型擁有無限制槓桿控制權，唯一準則是勝率 × 信心度
🔥 v4.0+ 重大改进: 统一PostgreSQL + 代码减少34% + 性能提升30%
================================================================================
```

### 1.2 配置驗證
```
✅ 配置驗證通過（全面驗證：API、交易、風險、指標等）
```

**可能的警告**:
```
⚠️ [警告訊息] - 配置項不符合最佳實踐
```

### 1.3 Binance 客戶端連接
```
✅ Binance 客戶端已連接
```

**失敗情況** (Replit 環境):
```
❌ Binance API 連接失敗: HTTP 451: 
❌ Binance API 地理位置限制 (HTTP 451)
📍 此錯誤表示當前IP地址被Binance限制
✅ 解決方案：請將系統部署到Railway或其他支持的雲平台
⚠️  Replit環境無法訪問Binance API
⚠️ API連接測試未通過，將在實際調用時重試
⚠️ 系統將繼續初始化，實際API調用將由熔斷器保護
```

### 1.4 數據服務初始化
```
================================================================================
✅ DataService v3.17.2+ 初始化完成
   📡 WebSocket模式: 停用（純REST）
================================================================================
✅ 已加載 50 個 USDT 永續合約
✅ 數據服務初始化完成
```

### 1.5 PostgreSQL 數據庫初始化
```
🗄️  初始化PostgreSQL数据库...

🔑 URL已包含 sslmode=require，保持不变
======================================================================
🔌 正在初始化PostgreSQL连接池...
   最小连接数: 2
   最大连接数: 10
   连接超时: 30秒
✅ PostgreSQL连接池初始化成功
======================================================================
✅ 数据库连接池已创建（2-10连接）

======================================================================
📊 开始初始化数据库表结构...
======================================================================
📝 创建 trades 表...
✅ trades 表创建成功
📝 创建 ml_models 表...
✅ ml_models 表创建成功
📝 创建 market_data 表...
✅ market_data 表创建成功
📝 创建 trading_signals 表...
✅ trading_signals 表创建成功
======================================================================
✅ 数据库表结构初始化完成！
======================================================================
✅ 数据库表结构初始化完成
✅ PostgreSQL数据服务已创建
```

**v3.34+ 新增診斷日誌**:
```
💾 准备保存交易: BTCUSDT LONG
📊 save_trade 参数: symbol=BTCUSDT, direction=LONG, entry_price=67000.0...
✅ 数据库 INSERT 成功，返回值: (123,)
✅ 交易记录已保存，PostgreSQL ID: 123
📊 统计: 成功=1, 失败=0
```

### 1.6 模型組件初始化
```
================================================================================
✅ ModelEvaluator v3.17+ 初始化完成
   📊 評分系統: 6 大維度 + 100% 虧損懲罰
   📁 報告目錄: reports/daily
================================================================================
✅ 模型評估器初始化完成

============================================================
✅ 模型自動初始化器已創建（v3.18.6+生產級）
   📁 模型目錄: models
   🎯 訓練參數: n_estimators=100, max_depth=6, min_child_weight=10, gamma=0.1
   🎯 目標函數: binary:logistic, 評估指標: logloss
============================================================
✅ 模型初始化器已創建
```

**模型加載**:
```
============================================================
✅ ML模型已加载: models/xgboost_model.json
   模型大小: 55.27 KB
   🔥 v3.19：使用12个ICT/SMC特征进行预测
============================================================
```

### 1.7 特徵引擎初始化
```
============================================================
✅ 特徵工程引擎已創建 v4.0 (Pure ICT/SMC + Unified Schema)
   🎯 功能：純ICT/SMC機構交易特徵
   📊 總特徵數：12個（與訓練一致）
============================================================
✅ FeatureEngine初始化完成（用于ML特征收集）
```

### 1.8 UnifiedTradeRecorder 初始化
```
======================================================================
✅ UnifiedTradeRecorder v4.0 初始化完成
   📊 数据源: PostgreSQL（唯一）
   🔄 重训练间隔: 50笔交易
   🧪 特征引擎: 启用
======================================================================
✅ UnifiedTradeRecorder初始化完成（PostgreSQL唯一数据源）
✅ 模型初始化器與交易記錄器已關聯
```

### 1.9 技術指標引擎初始化
```
✅ IntelligentCache 初始化完成
   📦 L1内存缓存: 5000 条目
   💾 L2持久化: 启用 (/tmp/elite_cache)

✅ EliteTechnicalEngine 初始化完成
   🎯 统一指标计算引擎（消除3处重复）
   💾 智能缓存已启用
✅ 统一技术引擎初始化完成（v4.0+，唯一实现）
```

### 1.10 交易策略初始化
```
================================================================================
✅ SelfLearningTrader v3.18.7+ 初始化完成（豁免期策略）
   🧠 決策引擎: ML模型 + 規則混合
   🤖 ML狀態: ✅ 已加載（44個特徵）
   📡 WebSocket: 已啟用（即時市場數據）
   🛡️  風險控制: 6層防護（質量門檻+方向驗證+RR控制+倉位限制+動態槓桿+智能出場）
   🏆 多信號競價: 加權評分（信心40% + 勝率40% + R:R 20%）

   🎓 豁免期策略（前100筆交易）:
      ├─ 勝率門檻: 20% (正常期: 45%)
      ├─ 信心門檻: 25% (正常期: 40%)
      ├─ 質量門檻: 25% (正常期: 40%)
      └─ 槓桿範圍: 1-3x（強制壓制）(正常期: 無上限)
================================================================================
```

### 1.11 槓桿引擎初始化
```
================================================================================
✅ 槓桿引擎初始化完成（v3.18.7+ 豁免期策略）
   📊 正常期勝率閾值: 45%
   📊 正常期信心度閾值: 40%
   📊 正常期槓桿範圍: 無限制（0.5x ~ ∞）
   🎓 豁免期勝率閾值: 20%
   🎓 豁免期信心度閾值: 25%
   🎓 豁免期槓桿範圍: 強制壓制（1-3x）
   🎓 豁免期交易數: 前50筆
================================================================================
```

### 1.12 倉位控制器初始化
```
================================================================================
✅ PositionController v3.28+ 初始化完成（全倉保護 + 時間止損）
   ⏱️  監控間隔: 60 秒
   🛡️  優先級: 0（最高優先級）
   🚨 緊急平倉: PnL ≤ -99%
   📡 WebSocket: 已啟用（優先使用）
   🔥 整合 PositionMonitor24x7（進場失效 + 逆勢自動平倉）
   🛡️ 全倉保護: 啟用（85% 閾值，120秒冷卻）
   ⏰ 時間止損: 啟用（持倉>2.0小時且虧損→強制平倉）
================================================================================
```

### 1.13 WebSocketManager 初始化
```
================================================================================
✅ WebSocketManager v3.17.2+ 初始化完成（流動性×波動率優化）
   📊 交易對模式: 0個
   🎯 選擇策略: 流動性 × 波動率（過濾<1M + <0.5%）
   🔀 分片大小: 50
   📡 K線Feed: 啟用
   💰 價格Feed: 啟用
   📡 帳戶Feed: 啟用
================================================================================
```

### 1.14 UnifiedScheduler 初始化
```
================================================================================
✅ UnifiedScheduler v3.18.6+ 初始化完成（WebSocket整合）
   🎯 模式: SelfLearningTrader
   📡 WebSocketManager: 動態加載所有可交易USDT永續合約
   📈 K線Feed: @kline_1m（取代REST輪詢）
   📊 帳戶Feed: listenKey（即時倉位）
   ⏱️  交易週期: 每 60 秒
   🛡️  倉位監控: 每 60 秒
   📊 每日報告: 00:00 UTC
================================================================================
✅ UnifiedScheduler 初始化完成
✅ DataService已連接WebSocket（優先使用WebSocket數據）
```

### 1.15 健康監控啟動
```
================================================================================
✅ SystemHealthMonitor v3.29+ 初始化完成
   ⏱️  检查间隔: 60秒
   🚨 告警阈值: 连续3次失败
   📊 监控组件: WS/内存/API/DB/交易/延迟
================================================================================
✅ 系统健康监控初始化完成（v3.29+）
🏥 健康监控已启动
✅ 健康监控已启动（6大组件：WS/内存/API/DB/交易/延迟）
```

### 1.16 系統啟動完成
```
✅ 所有核心組件初始化完成
✅ 信號處理器已註冊（SIGINT, SIGTERM）

🚀 啟動 UnifiedScheduler...
```

---

## 2. 數據庫操作日誌

### 2.1 連接池管理
```
🔌 正在初始化PostgreSQL连接池...
   最小连接数: 2
   最大连接数: 10
   连接超时: 30秒
✅ PostgreSQL连接池初始化成功
```

### 2.2 SSL 連接處理
```
🔑 URL已包含 sslmode=require，保持不变
```

**或**:
```
🔒 检测到Railway环境，添加SSL要求
✅ SSL配置已应用：sslmode=require
```

### 2.3 交易記錄保存 (v3.34+ 增強)
```
💾 准备保存交易: BTCUSDT LONG
📊 save_trade 参数: symbol=BTCUSDT, direction=LONG, entry_price=67000.0, quantity=0.01...
✅ 数据库 INSERT 成功，返回值: (123,)
✅ 交易记录已保存，PostgreSQL ID: 123
```

**失敗情況**:
```
❌ 数据库 INSERT 返回 None（可能是 RETURNING 子句问题）
❌ 保存交易记录失败: 数据库返回 None
```

### 2.4 統計更新
```
📊 统计: 成功=1, 失败=0
```

### 2.5 查詢執行
```
🔍 执行查询: SELECT COUNT(*) FROM trades WHERE status='open'
✅ 查询成功，结果行数: 1
```

**自動重試**:
```
⚠️ 查询失败，正在重试 (1/3): connection timeout
⚠️ 查询失败，正在重试 (2/3): connection timeout
✅ 重试成功
```

### 2.6 健康檢查
```
✅ 数据库健康检查通过
```

**失敗**:
```
❌ 数据库健康检查失败: connection refused
```

---

## 3. 交易執行日誌

### 3.1 交易週期開始
```
================================================================================
🔄 交易週期 #1 | 2025-11-10 05:36:00 UTC
================================================================================
```

### 3.2 賬戶餘額顯示
```
💰 賬戶餘額: 總額=$1000.00 | 可用=$950.00 | 保證金=$50.00 | 未實現盈虧=$+10.50
```

### 3.3 當前持倉顯示
```
📦 當前持倉: 無
```

**有持倉時**:
```
📦 當前持倉: 2 個 | 總未實現盈虧: $+15.30
================================================================================
   BTCUSDT LONG | 入場: $67000.00 | PnL: $+10.20 (+0.75%) | 
   信心: 85% | 勝率: 70% | 持倉時間: 15分鐘
   ETHUSDT SHORT | 入場: $3500.00 | PnL: $+5.10 (+0.42%) | 
   信心: 78% | 勝率: 65% | 持倉時間: 8分鐘
================================================================================
```

### 3.4 掃描交易對
```
📊 掃描 50 個交易對中...
```

### 3.5 信號發現
```
✅ 發現 3 個有效信號（共掃描 50 個交易對）
```

**無信號時**:
```
⚠️  本輪無有效信號
```

### 3.6 信號競價過程
```
🏆 信號競價開始（3個候選）...

評估信號 #1: BTCUSDT LONG
   ├─ 信心: 85% (34.0分)
   ├─ 勝率: 70% (28.0分)
   ├─ R:R: 2.5 (5.0分)
   └─ 綜合評分: 67.0

評估信號 #2: ETHUSDT SHORT
   ├─ 信心: 78% (31.2分)
   ├─ 勝率: 65% (26.0分)
   ├─ R:R: 3.0 (6.0分)
   └─ 綜合評分: 63.2

評估信號 #3: SOLUSDT LONG
   ├─ 信心: 72% (28.8分)
   ├─ 勝率: 60% (24.0分)
   ├─ R:R: 2.0 (4.0分)
   └─ 綜合評分: 56.8

🏆 信號競價選中: BTCUSDT LONG | 
   綜合評分: 67.0 | 
   信心: 85% (40%) | 
   勝率: 70% (40%) | 
   R:R: 2.5 (20%) | 
   槓桿: 8.5x
```

### 3.7 下單執行
```
📊 滑點保護: BTCUSDT LONG | 
   當前價=67000.00, 限價=67050.00→67050.0, 
   數量=0.01→0.01, 容忍度=0.10%

✅ 訂單成功: BTCUSDT LONG
   入場價格: $67000.00
   數量: 0.01
   槓桿: 8x
   止損: $66500.00 (-0.75%)
   止盈: $68500.00 (+2.24%)
   名義價值: $5360.00
```

**失敗情況**:
```
❌ 訂單失敗: BTCUSDT LONG
   錯誤: Insufficient margin
   詳情: 可用保證金不足
```

### 3.8 開倉記錄
```
📝 記錄開倉: BTCUSDT LONG @ $67000.00
✅ 開倉記錄已保存（PostgreSQL ID: 123）
```

### 3.9 週期統計
```
📊 本週期統計:
   ├─ 掃描交易對: 50 個
   ├─ 發現信號: 3 個
   ├─ 執行交易: 1 個
   ├─ 當前持倉: 3 個
   └─ 週期耗時: 2.5 秒

⏰ 下一週期: 60 秒後
```

---

## 4. 信號生成日誌

### 4.1 規則引擎信號
```
📊 BTCUSDT 規則引擎分析:
   ├─ 方向: LONG
   ├─ 市場結構: 看漲 (+1.0)
   ├─ Order Block: 2個 (+0.6)
   ├─ FVG: 1個 (+0.3)
   ├─ 流動性掃獵: 檢測到 (+0.5)
   ├─ 趨勢對齊: 強一致 (+0.8)
   └─ 初始信心: 72%
```

### 4.2 ML 模型預測
```
🤖 BTCUSDT ML預測:
   ├─ 勝率: 0.685 (68.5%)
   ├─ 信心: 0.752 (75.2%)
   ├─ 綜合分數: 71.8
   └─ 預測來源: ml_model_multi
```

**ML fallback**:
```
⚠️ BTCUSDT ML預測失敗，使用規則引擎: 0.720
```

### 4.3 門檻驗證
```
🎓 BTCUSDT 豁免期: 已完成 15/50 筆 | 
   門檻 勝率≥35% 信心≥40% | 
   槓桿限制: 1-3x

✅ BTCUSDT 通過門檻驗證: 
   勝率=68.5% ≥ 35% ✅
   信心=75.2% ≥ 40% ✅
   R:R=2.5 ≥ 1.5 ✅
```

**拒絕情況**:
```
❌ BTCUSDT 拒絕開倉: 勝率過低 | 
   勝率=42% < 45% | 信心=55% R:R=2.0
```

### 4.4 槓桿計算
```
📊 BTCUSDT 槓桿計算:
   ├─ 基礎槓桿: 5.0x (勝率×信心)
   ├─ 豁免期壓制: 3.0x (上限)
   └─ 最終槓桿: 3.0x
```

### 4.5 止損/止盈調整
```
📊 BTCUSDT SL/TP 調整:
   ├─ 原始止損: -1.5%
   ├─ 槓桿放大因子: 1.10x
   ├─ 調整後止損: -1.65%
   ├─ 止損價格: $66000.00
   └─ 止盈價格: $68500.00 (R:R=2.5)
```

---

## 5. 倉位監控日誌

### 5.1 24/7 監控週期
```
🔍 倉位監控週期開始...
當前持倉數: 2 個
```

### 5.2 智能出場判斷
```
📊 BTCUSDT LONG 出場分析:
   ├─ 當前PnL: +1.2% ($80.50)
   ├─ 持倉時間: 15分鐘
   ├─ 當前信心: 72% (入場: 85%)
   ├─ 當前勝率: 65% (入場: 70%)
   └─ 決策: HOLD
```

**觸發平倉**:
```
🚨 BTCUSDT LONG 觸發平倉:
   原因: 進場理由失效（信心降至55% < 70%門檻）
   當前PnL: -0.5% ($-33.50)
   執行: 立即平倉
```

### 5.3 部分止盈
```
💰 BTCUSDT LONG 觸發部分止盈:
   當前盈利: +60% 
   執行: 平倉50%
   保留倉位: 0.005 BTC
   鎖定利潤: $402.50
```

### 5.4 風險熔斷
```
🚨 BTCUSDT LONG 觸發 100% 虧損熔斷 (PnL=-99%)，立即平倉
```

### 5.5 時間止損
```
⏰ ETHUSDT SHORT 觸發時間止損:
   持倉時間: 2.5小時 > 2.0小時閾值
   當前PnL: -0.8%
   執行: 強制平倉
```

---

## 6. WebSocket 連接日誌

### 6.1 啟動過程
```
================================================================================
🚀 WebSocketManager v3.18+ 啟動中（冷啟動優化）...
================================================================================
📡 步驟1/4：使用預設交易對列表（50個）
📡 步驟2/4：啟動ShardFeed（K線+價格）...
   創建 1 個分片（每片50個交易對）
```

### 6.2 ShardFeed 初始化
```
================================================================================
✅ ShardFeed 初始化完成
   📊 總幣種數量: 50
   🔀 分片數量: 1
   📦 分片大小: 50
   📡 K線Feed: 啟用
   💰 價格Feed: 啟用
================================================================================
✅ ShardFeed已創建
```

### 6.3 AccountFeed 初始化
```
================================================================================
✅ AccountFeed 初始化完成
   📡 監控類型: ACCOUNT_UPDATE（即時倉位）
   🔌 WebSocket URL: wss://fstream.binance.com/ws/
   ⏱️  listenKey自動續期: 每15分鐘（過期前提前續期）
   ⏱️  接收超時: 120秒（可配置）
   💓 健康檢查: 每30秒主動ping
   🔄 智能重連: 指數退避（5-60秒）
================================================================================
✅ AccountFeed已創建
```

### 6.4 連接建立
```
📡 正在連接 WebSocket: wss://fstream.binance.com/stream
✅ WebSocket 連接成功
🎧 開始監聽數據流...
```

### 6.5 數據接收
```
📊 接收 K線數據: BTCUSDT 1m | 價格: $67000.00 | 成交量: 125.5
💰 接收價格更新: ETHUSDT | 買: $3500.00 | 賣: $3500.50
📦 接收倉位更新: BTCUSDT LONG | 未實現盈虧: $+12.50
```

### 6.6 健康狀態
```
💓 WebSocket心跳正常（延遲: 50ms）
```

**異常重連**:
```
⚠️ WebSocket 連接中斷，正在重連...
🔄 重連嘗試 1/10（5秒後）
✅ WebSocket 重連成功
```

---

## 7. 模型訓練日誌

### 7.1 訓練鎖定檢查
```
🔒 模型訓練已鎖定（DISABLE_MODEL_TRAINING=True）
   ✅ 系統將使用現有模型，不進行初始訓練或重訓練
   ✅ 檢測到現有模型: models/xgboost_model.json
```

### 7.2 初始訓練觸發
```
⚠️ 未檢測到初始化模型，開始自動訓練...
🚀 開始收集訓練數據...
```

### 7.3 數據收集
```
📊 加載真實交易數據（PostgreSQL優先）...
✅ 加載 150 筆真實交易數據（12特徵）
📊 數據不足，從市場數據生成 50 個合成樣本...
✅ 總計收集 200 筆訓練數據
   真實交易: 150
   合成樣本: 50
```

### 7.4 模型訓練
```
🧠 開始訓練 XGBoost 模型...
📊 訓練集: 160 樣本
📊 驗證集: 40 樣本
🎯 參數: n_estimators=100, max_depth=6, learning_rate=0.1

訓練進度:
[0]     train-logloss:0.6543     valid-logloss:0.6589
[10]    train-logloss:0.5234     valid-logloss:0.5412
[20]    train-logloss:0.4521     valid-logloss:0.4876
...
[99]    train-logloss:0.3012     valid-logloss:0.3567

✅ XGBoost 模型訓練完成
📊 最佳迭代: 85
📊 訓練AUC: 0.782
📊 驗證AUC: 0.701
```

### 7.5 模型保存
```
💾 保存模型: models/xgboost_model.json
✅ 模型保存成功（55.27 KB）
```

### 7.6 重訓練觸發
```
⚠️ 觸發動態重訓練（性能驟降 or 市場狀態劇變 or 樣本累積）...
📊 當前樣本數: 250（上次訓練: 200）
📊 模型表現: 勝率 42% < 45% 閾值
🔄 開始重訓練...
✅ 動態重訓練完成，模型已更新
```

---

## 8. 風險控制日誌

### 8.1 全倉保護
```
🛡️ 全倉保護觸發:
   總保證金使用率: 87% > 85% 閾值
   當前持倉: 3 個
   執行: 暫停新開倉（冷卻120秒）
```

### 8.2 倉位限制
```
⚠️ 倉位數量達到上限:
   當前: 5 個 = 最大: 5 個
   拒絕新信號: SOLUSDT LONG
```

### 8.3 單倉上限
```
⚠️ BTCUSDT 倉位過大:
   理論名義價值: $6000.00 > 50%權益 ($5000.00)
   調整為: $5000.00
```

### 8.4 熔斷器
```
⚠️  熔斷器警告級: 失敗1次 (操作: generic, 優先級: NORMAL)
⚠️  熔斷器警告級: 失敗2次 (操作: generic, 優先級: NORMAL)
🔄 熔斷器級別變化: warning → throttled (失敗次數: 4)
```

**恢復**:
```
✅ 熔斷器已恢復: throttled → normal（連續成功10次）
```

---

## 9. 健康監控日誌

### 9.1 監控啟動
```
🏥 健康監控已啟動
```

### 9.2 檢查結果
```
✅ 健康檢查通過:
   ├─ WebSocket: 正常 (延遲 50ms)
   ├─ 內存使用: 45% (正常)
   ├─ API連接: 正常
   ├─ 數據庫: 正常
   ├─ 交易執行: 正常 (勝率 52%)
   └─ 系統延遲: 120ms (正常)
```

**異常告警**:
```
⚠️ 健康檢查異常:
   ├─ WebSocket: ❌ 連接中斷
   ├─ 內存使用: ⚠️ 78% (接近上限)
   └─ 連續失敗次數: 2/3
```

**觸發告警**:
```
🚨 系統健康告警！
   連續失敗: 3次 ≥ 3次閾值
   問題組件: WebSocket, 數據庫
   建議: 檢查網絡連接和數據庫狀態
```

---

## 10. 錯誤和警告日誌

### 10.1 API 錯誤
```
❌ Binance API 錯誤 451: 
   code=0, 
   msg=Service unavailable from a restricted location according to 'b. Eligibility' in https://www.binance.com/en/terms. 
   endpoint=/fapi/v1/ping, 
   params={}
```

### 10.2 數據庫錯誤
```
❌ 數據庫連接失敗: connection refused
❌ 查詢超時: timeout after 30s
❌ 數據庫 INSERT 返回 None（可能是 RETURNING 子句問題）
```

### 10.3 訂單錯誤
```
❌ 訂單失敗: Insufficient margin
   詳情: {"code":-4164,"msg":"Order's notional must be no smaller than 5.0 (unless you choose reduce only)."}
```

### 10.4 數據獲取失敗
```
⚠️ 獲取 BTCUSDT K線失敗（重試 1/3）: timeout
⚠️ 獲取 BTCUSDT K線失敗（重試 2/3）: timeout
✅ 重試成功
```

### 10.5 特徵提取警告
```
⚠️ BTCUSDT 特徵缺失: ['atr', 'bb_width']
⚠️ 使用默認值填充
```

### 10.6 配置警告
```
⚠️ 槓桿超過建議範圍: 125x > 20x（推薦）
⚠️ 止損距離過小: 0.2% < 0.3%（最小建議）
```

---

## 📊 日誌級別分類

### INFO（藍色/綠色）
- ✅ 成功操作
- 📊 統計信息
- 📡 正常數據流
- 🔄 週期性任務

### WARNING（黃色）
- ⚠️ 配置建議
- ⚠️ 非關鍵錯誤
- ⚠️ 重試操作
- ⚠️ 接近閾值

### ERROR（紅色）
- ❌ API失敗
- ❌ 數據庫錯誤
- ❌ 訂單失敗
- ❌ 系統異常

### DEBUG（灰色，需設置 LOG_LEVEL=DEBUG）
- 🔍 詳細變量值
- 🔍 函數調用追蹤
- 🔍 內部狀態變化

---

## 🔍 關鍵監控指標

### 成功部署的信號
```
✅ PostgreSQL连接池初始化成功
✅ 数据库表结构初始化完成！
✅ ML模型已加载: models/xgboost_model.json
✅ WebSocket 連接成功
✅ 所有核心組件初始化完成
```

### 需要立即檢查的警告
```
❌ Binance API 地理位置限制 (HTTP 451)  ← 必須部署到 Railway
❌ DATABASE_URL未配置！                ← 檢查環境變量
❌ 數據庫 INSERT 返回 None              ← v3.34 已修復
🚨 系統健康告警！                       ← 檢查對應組件
```

### v3.34 修復驗證要點
```
✅ 交易记录已保存，PostgreSQL ID: 123   ← 數據寫入成功
📊 统计: 成功=1, 失败=0                 ← 計數器正常
🔑 URL已包含 sslmode=require，保持不变  ← SSL 智能處理
```

---

## 🎯 使用建議

### Railway 部署後首次檢查
1. 搜索 `✅ PostgreSQL连接池初始化成功` - 確認數據庫連接
2. 搜索 `✅ ML模型已加载` - 確認模型加載
3. 搜索 `交易记录已保存，PostgreSQL ID` - 確認數據寫入
4. 搜索 `❌` 和 `🚨` - 檢查所有錯誤

### 交易執行監控
1. 每小時檢查 `🔄 交易週期` - 確認系統運行
2. 監控 `✅ 訂單成功` - 追蹤交易執行
3. 檢查 `📊 本週期統計` - 評估系統表現

### 問題排查
1. HTTP 451 → 必須部署到 Railway
2. 數據庫錯誤 → 檢查 DATABASE_URL 環境變量
3. 訂單失敗 → 檢查賬戶餘額和 API 權限
4. WebSocket 中斷 → 檢查網絡穩定性

---

**最後更新**: 2025-11-10  
**適用版本**: v3.34+
