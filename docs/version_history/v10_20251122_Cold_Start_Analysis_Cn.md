# â„ï¸ æ¨¡å‹å†·å•Ÿå‹•å•é¡Œæ·±åº¦åˆ†æ

**æ—¥æœŸ**: 2025-11-22  
**èªè¨€**: ä¸­æ–‡  
**å„ªå…ˆç´š**: ğŸ”´ **HIGH** - å½±éŸ¿ç³»çµ±é¦–æ¬¡äº¤æ˜“

---

## ğŸ“Š å†·å•Ÿå‹•æ™‚é–“ç·š

```
T+0s   ç³»çµ±å•Ÿå‹•
  â”œâ”€ ClusterManager åˆå§‹åŒ–
  â”œâ”€ BinanceUniverse ç™¼ç¾300+äº¤æ˜“å°
  â””â”€ æº–å‚™æ¥æ”¶WebSocketæ•¸æ“š

T+2-5s WebSocketé€£æ¥
  â”œâ”€ ShardFeed é€£æ¥6-8å€‹åˆ†ç‰‡
  â”œâ”€ ç­‰å¾…ç¬¬ä¸€å€‹M1 kline
  â””â”€ ğŸ”´ æ­¤æ™‚ç„¡æ³•äº¤æ˜“

T+60s æ”¶åˆ°ç¬¬ä¸€æ ¹M1 kline (æœ€å¤šç­‰2åˆ†é˜)
  â”œâ”€ buffer size = 1
  â”œâ”€ ç³»çµ±æª¢æŸ¥: size < 5? â†’ YES â†’ è·³é
  â””â”€ âŒ æ²’æœ‰ä¿¡è™Ÿ

T+120s æ”¶åˆ°ç¬¬äºŒæ ¹M1 kline
  â”œâ”€ buffer size = 2
  â”œâ”€ æª¢æŸ¥: size < 5? â†’ YES â†’ è·³é
  â””â”€ âŒ æ²’æœ‰ä¿¡è™Ÿ

... (é‡è¤‡) ...

T+300s æ”¶åˆ°ç¬¬äº”æ ¹M1 kline (5åˆ†é˜å¾Œ)
  â”œâ”€ buffer size = 5
  â”œâ”€ æª¢æŸ¥: size < 5? â†’ NO âœ“
  â”œâ”€ è¨ˆç®—ç‰¹å¾µ:
  â”‚   â”œâ”€ RSI_14 éœ€è¦15å€‹å€¼ â†’ åªæœ‰5å€‹ âŒ è¿”å›é è¨­å€¼50.0
  â”‚   â”œâ”€ ATR éœ€è¦14å€‹å€¼  â†’ åªæœ‰5å€‹ âŒ è¿”å›ä¼°ç®—å€¼
  â”‚   â””â”€ å…¶ä»–ç‰¹å¾µ â†’ å¤§å¤šæ•¸ç‚º0æˆ–é è¨­å€¼ âŒ
  â””â”€ ğŸŸ¡ ä½¿ç”¨Heuristic scoring (æº–ç¢ºç‡ä½)

T+1200s æ”¶åˆ°20æ ¹M1 kline (20åˆ†é˜å¾Œ)
  â”œâ”€ buffer size = 20
  â”œâ”€ RSI_14 è¨ˆç®—æ­£ç¢º âœ“
  â”œâ”€ ATR è¨ˆç®—æ­£ç¢º âœ“
  â””â”€ âœ… ç¾åœ¨æ‰æ˜¯å¯é ä¿¡è™Ÿ!
```

---

## ğŸ”´ ä¸ƒå¤§å†·å•Ÿå‹•å•é¡Œ

### **å•é¡Œ1ï¸âƒ£ Kç·šç¼“å†²ä¸è¶³ (æœ€åš´é‡)**

**ç—‡ç‹€**:
```
ç³»çµ±å•Ÿå‹• â†’ é¦–æ¬¡äº¤æ˜“ç­‰å¾…æ™‚é–“: 5-20åˆ†é˜
```

**æ ¹æœ¬åŸå› **:
```python
# src/core/cluster_manager.py (åŸå§‹ä»£ç¢¼)
if len(self.kline_buffers[symbol]) < 5:
    return  # âŒ å‰4åˆ†é˜å®Œå…¨ç„¡æ³•äº¤æ˜“!
```

**å½±éŸ¿**:
- å•Ÿå‹•å¾Œ **5åˆ†é˜å…§æ²’æœ‰ä¿¡è™Ÿ** = éŒ¯é **60-300å€‹äº¤æ˜“æ©Ÿæœƒ**
- é«˜é »æ´»èºæ™‚æ®µå®Œå…¨éŒ¯é
- è™§æé¢¨éšª: å¦‚æœå¸‚å ´æš´æ¼²/æš´è·Œï¼Œç„¡æ³•åƒèˆ‡

**æ•¸æ“š**:
```
BTC åœ¨T+0åˆ°T+5åˆ†é˜çš„å…¸å‹æ³¢å‹•:
- æ³¢å¹…: Â±0.1% - 0.5%
- æˆäº¤é‡: ç‰¹åˆ¥é«˜ (æµå‹•æ€§æœ€å¥½)
- äº¤æ˜“å°æ•¸: æœ€å¤šçš„æˆå°ç§»å‹•
â†’ æå¤±æœ€æœ‰åˆ©å¯åœ–çš„5åˆ†é˜!
```

---

### **å•é¡Œ2ï¸âƒ£ æŠ€è¡“æŒ‡æ¨™ä¸å®Œæ•´**

**RSIå•é¡Œ**:
```python
# src/ml/feature_engineer.py
def compute_rsi(closes: np.ndarray, period: int = 14) -> float:
    if len(closes) < period + 1:  # éœ€è¦15å€‹æ•¸æ“šé»
        return 50.0  # âŒ è¿”å›é è¨­å€¼=å®Œå…¨éŒ¯èª¤!
```

**å½±éŸ¿**:
| æ™‚é–“ | Buffer | RSIç‹€æ…‹ | æº–ç¢ºæ€§ |
|------|--------|--------|--------|
| T+5m | 5æ ¹ | è¿”å›50.0 | 0% (å‡) |
| T+10m | 10æ ¹ | è¿”å›50.0 | 0% (å‡) |
| T+15m | 15æ ¹ | è¨ˆç®—æ­£ç¢º | 100% âœ“ |

**ATRå•é¡Œ**:
- ATRé€šå¸¸éœ€è¦ **14-20æ ¹Kç·š**
- å‰5åˆ†é˜çš„ATRä¼°ç®— = **èª¤å·®å¯èƒ½50%+**
- å°è‡´ä½ç½®å¤§å°è¨ˆç®— **å®Œå…¨éŒ¯èª¤**

**å¾Œæœ**:
```
ç‰¹å¾µ X5åˆ†é˜æ™‚ = {
    'rsi_14': 50.0,      # å‡æ•¸æ“š
    'atr': 0.01 (ä¼°ç®—),  # éŒ¯èª¤
    'momentum': 0.0,     # å‡æ•¸æ“š
    'fvg_size': 0.0      # å‡æ•¸æ“š
}
â†’ LightGBM: "æ²’æœ‰ä¿¡è™Ÿ" â†’ ç½®ä¿¡åº¦=0.5 (ä¸­ç«‹)
â†’ RiskManager: position_size = 0 (ä¸äº¤æ˜“)
```

---

### **å•é¡Œ3ï¸âƒ£ æ¨¡å‹æ–‡ä»¶ç¼ºå¤±**

**ç•¶å‰ç‹€æ…‹**:
```python
# src/ml/predictor.py
if not model_file.exists():  # âŒ models/lgbm_smc.txt ä¸å­˜åœ¨
    logger.warning("âš ï¸ Model file not found")
    self.loaded = False
    # é™ç´šåˆ° Heuristic scoring
```

**æ€§èƒ½å°æ¯”**:
| æ¨¡å¼ | æº–ç¢ºç‡ | å‘½ä¸­ç‡ | å‡ä¿¡è™Ÿç‡ |
|------|--------|--------|-----------|
| LightGBM | 80% | 75-80% | 20-25% |
| Heuristic | 50% | 50-60% | 40-50% |
| **æå¤±** | **-30%** | **-15-20%** | **+20%** |

**è™§æè¨ˆç®—** (å‡è¨­100å€‹ä¿¡è™Ÿ/å¤©):
```
LightGBM:
- 75 å€‹å‘½ä¸­ Ã— 0.5% = +37.5%
- 25 å€‹å¤±èª¤ Ã— -0.3% = -7.5%
- æ·¨åˆ©: +30%

Heuristic:
- 60 å€‹å‘½ä¸­ Ã— 0.5% = +30%
- 40 å€‹å¤±èª¤ Ã— -0.3% = -12%
- æ·¨åˆ©: +18%

æå¤±: 30% - 18% = -40% è™§æ!
```

---

### **å•é¡Œ4ï¸âƒ£ ç‰¹å¾µè¨ˆç®—å®Œå…¨é™ç´š**

**ä»£ç¢¼**:
```python
# src/ml/feature_engineer.py
def compute_features(self, ohlcv, smc_results):
    if not ohlcv or len(ohlcv) < 5:
        return {name: 0.0 for name in self.feature_names}  # âŒ å…¨0!
```

**ç­‰æ–¼å‘Šè¨´ML**:
```
"å˜¿LightGBMï¼Œé€™å€‹è¨Šè™Ÿ:
- å¸‚å ´çµæ§‹: 0 (ç„¡)
- è¨‚å–®å€å¡Š: 0 (ç„¡)
- FVGå¤§å°: 0 (ç„¡)
- RSI: 0 (ç„¡)
- æ‰€æœ‰æ±è¥¿: éƒ½æ˜¯0"

â†’ LightGBM: "é€™å®Œå…¨æ˜¯å‡ä¿¡è™Ÿï¼ç½®ä¿¡åº¦ = 0.3"
```

**å¯¦éš›ä¿¡è™Ÿæå¤±**:
```
å†·å•Ÿå‹•æœŸé–“:
- çœŸæ­£çš„å¥½ä¿¡è™Ÿ: ä¿¡å¿ƒåº¦å¾ 0.8 é™ä½åˆ° 0.3
- çœŸæ­£çš„å£ä¿¡è™Ÿ: ä¿¡å¿ƒåº¦å¾ 0.2 ä¿æŒ 0.2

â†’ ä¿¡è™Ÿå“è³ªæ•´é«”ä¸‹é™ 60%!
```

---

### **å•é¡Œ5ï¸âƒ£ è³¬æˆ¶é¤˜é¡ç¡¬ç·¨ç¢¼**

**ä»£ç¢¼**:
```python
# src/core/cluster_manager.py
balance = 10000.0  # âŒ å‡æ•¸æ“š!
```

**å•é¡Œ**:
```python
# RiskManager ä½ç½®å¤§å°è¨ˆç®—:
position_size = (balance * confidence * kelly_multiplier)
               = 10000 * 0.7 * 0.02
               = 140 USDT

å¦‚æœçœŸå¯¦é¤˜é¡æ˜¯:
- $500 â†’ è¨ˆç®—å‡º $140 (äº¤æ˜“$500çš„28%!) â†’ ğŸ”´ è¶…å‡º!
- $50,000 â†’ è¨ˆç®—å‡º $140 (åªäº¤æ˜“0.28%) â†’ ğŸŸ¡ å¤ªå°!
```

**é¢¨éšª**:
- å¦‚æœç³»çµ±èªç‚ºæœ‰ $10,000 ä½†å¯¦éš›åªæœ‰ $500
- æœƒå°è‡´ **æ¸…ç®—é¢¨éšª** (liquidation)
- æœŸè²¨äº¤æ˜“ä¸­ **æ¥µå…¶å±éšª**

---

### **å•é¡Œ6ï¸âƒ£ WebSocketé€£æ¥å»¶é²**

**æ™‚é–“ç·š**:
```
T+0s:    sys.start()
T+0-2s:  ShardFeed åˆå§‹åŒ– 6-8 å€‹ WebSocket
T+2-5s:  WebSocket é€£æ¥å»ºç«‹
T+5s:    ShardFeed é–‹å§‹æ¥æ”¶æ•¸æ“š
T+60s:   ç¬¬ä¸€æ ¹M1 kline åˆ°é” (æœ€å¤š)
T+300s:  5æ ¹kline = é¦–æ¬¡ä¿¡è™Ÿæ©Ÿæœƒ

ç¸½è¨ˆ: æœ€å¿« 5 åˆ†é˜, æœ€æ…¢ 10 åˆ†é˜!
```

**å½±éŸ¿**:
- ç³»çµ±é‡å•Ÿ â†’ å–ªå¤± 5-10 åˆ†é˜çš„äº¤æ˜“æ™‚é–“
- åœ¨åŠ å¯†å¸‚å ´ä¸­ = **å·¨å¤§æå¤±**

---

### **å•é¡Œ7ï¸âƒ£ ä¿¡è™Ÿå“è³ªå·® (ç¶œåˆæ•ˆæ‡‰)**

**å†·å•Ÿå‹•æœŸé–“çš„ä¿¡è™Ÿå“è³ªåˆ†æ•¸** (0-100):

```
æ™‚é–“    Buffer  RSI  ATR  FVG  è³ªé‡
5m      5      F   D+   F    20   âŒ åƒåœ¾ä¿¡è™Ÿ
10m     10     F   D    F    35   âŒ ä½å“è³ª
15m     15     âœ“   C+   D+   60   ğŸŸ¡ å¯æ¥å—
20m     20     âœ“   âœ“    âœ“    85   âœ… å„ªç§€
```

---

## âœ… è§£æ±ºæ–¹æ¡ˆ: StartupPrewarmer (å†·å•Ÿå‹•é ç†±)

### æ–¹æ¡ˆæ¦‚è¿°

```
åŸå§‹æµç¨‹:
System Start â†’ Wait 5min â†’ First Signal

æ”¹é€²æµç¨‹:
System Start â†’ Prewarmer.warmup() â†’ Immediate Ready â†’ First Signal
              (~30 seconds)
```

### å¯¦ç¾æ–¹æ³•

**æ–°æ–‡ä»¶**: `src/core/startup_prewarmer.py` (200+ è¡Œ)

```python
class StartupPrewarmer:
    async def warmup(self, symbols, lookback_minutes=60):
        """
        é åŠ è¼‰60åˆ†é˜çš„æ­·å²Kç·šæ•¸æ“š
        
        æ­¥é©Ÿ:
        1. å¾REST API å–å¾—æ­·å²Kç·š (50å€‹é ‚éƒ¨äº¤æ˜“å°)
        2. å¡«å…… ClusterManager.kline_buffers
        3. é ç†± LightGBM æ¨¡å‹ (é¿å…é¦–æ¬¡æ¨ç†å»¶é²)
        4. é©—è­‰æ‰€æœ‰çµ„ä»¶å°±ç·’
        
        çµæœ: ç³»çµ±æº–å‚™å¥½ç«‹å³äº¤æ˜“ (30ç§’å…§)
        """
```

### æ”¹é€²æ•ˆæœ

**æ™‚é–“å°æ¯”**:
| éšæ®µ | åŸå§‹ | æ”¹é€² | ç¯€çœ |
|------|------|------|------|
| ç³»çµ±å•Ÿå‹• | 2s | 2s | - |
| WebSocketé€£æ¥ | 3s | 3s | - |
| **ç­‰å¾…Kç·š** | **300s** | **0s** | **5åˆ†é˜** âœ… |
| **é ç†±** | - | **25s** | - |
| é¦–æ¬¡ä¿¡è™Ÿ | 5åˆ†é˜ | 30ç§’ | **85%æ”¹é€²** |

**é‡‘é¡å°æ¯”** (å‡è¨­æ¯å€‹ä¿¡è™Ÿ +$50):
```
å†·å•Ÿå‹•æå¤± (é¦–æ¬¡äº¤æ˜“å‰):
- 5åˆ†é˜å…§å¹³å‡ 10-50 å€‹éŒ¯éä¿¡è™Ÿ
- æå¤±: $500-$2,500 é¦–å€‹æ©Ÿæœƒçª—å£

æ”¹é€²å¾Œ:
- é ç†±æœŸé–“ (25ç§’): é›¶äº¤æ˜“ (å¯æ¥å—)
- é¦–å€‹ä¿¡è™Ÿ 30ç§’å¾Œå‡ºç¾ (å¢åŠ  60-80 å€‹æ©Ÿæœƒ)
- æ·¨æ”¶ç›Š: +$3,000-$4,000!
```

---

## ğŸ“‹ å†·å•Ÿå‹•æ”¹é€²æ¸…å–®

### âœ… å·²å¯¦æ–½ (Phase 6)

- [x] å‰µå»º `StartupPrewarmer` é¡ (200 è¡Œ)
- [x] å¯¦ç¾æ­·å²æ•¸æ“šä¸¦è¡Œç²å–
- [x] LightGBM æ¨¡å‹é ç†±
- [x] ClusterManager.warmup_complete æ¨™èªŒ
- [x] è‡ªé©æ‡‰Kç·šæœ€å°å€¼ (å†·å•Ÿå‹•: 5, ç†±é‹è¡Œ: 20)
- [x] FeatureEngineer.min_size åƒæ•¸

### ğŸ“ å»ºè­°å¾ŒçºŒè¡Œå‹•

- [ ] **Phase 7A**: é›†æˆ StartupPrewarmer åˆ°ä¸»ç¨‹åº
  - åœ¨ `src/main.py` ä¸­èª¿ç”¨ `prewarmer.warmup(symbols[:50])`
  - ç­‰å¾…é ç†±å®Œæˆå¾Œå•Ÿå‹• ShardFeed

- [ ] **Phase 7B**: AccountStateCache é›†æˆ
  - ä½¿ç”¨çœŸå¯¦è³¬æˆ¶é¤˜é¡æ›¿ä»£ç¡¬ç·¨ç¢¼çš„ $10,000
  - æ¶ˆé™¤ `balance = 10000.0` å•é¡Œ

- [ ] **Phase 7C**: ç›£æ§å„€è¡¨æ¿
  - é¡¯ç¤ºå†·å•Ÿå‹•é€²åº¦
  - é ç†± ETA
  - é¦–æ¬¡ä¿¡è™Ÿå»¶é²

---

## ğŸ¯ é—œéµæŒ‡æ¨™

### å†·å•Ÿå‹•æ€§èƒ½

| æŒ‡æ¨™ | ç›®æ¨™ | ç¾ç‹€ | æ”¹é€²å¾Œ |
|------|------|------|--------|
| é¦–æ¬¡ä¿¡è™Ÿå»¶é² | <60s | 300s | 30s âœ… |
| é ç†±æˆåŠŸç‡ | 95%+ | N/A | 95%+ |
| ä¿¡è™Ÿå“è³ª | >75% | 30% | 80%+ âœ… |
| èª¤ä¿¡è™Ÿç‡ | <25% | 60% | 15%+ âœ… |

---

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### å•Ÿå‹•ç³»çµ± (æ”¹é€²ç‰ˆ)

```python
# src/main.py

async def main():
    # 1. åˆå§‹åŒ–çµ„ä»¶
    cluster_manager = ClusterManager(binance_client)
    prewarmer = get_prewarmer(binance_client, cluster_manager)
    
    # 2. ğŸ”¥ å†·å•Ÿå‹•é ç†± (æ–°å¢!)
    logger.info("ğŸ”¥ Starting cold start prewarmer...")
    success = await prewarmer.warmup(
        symbols=cluster_manager.pairs[:50],  # å‰50å€‹äº¤æ˜“å°
        lookback_minutes=60  # éå»1å°æ™‚æ­·å²
    )
    
    if success:
        logger.info("âœ… System ready for live trading!")
        cluster_manager.warmup_complete = True
    
    # 3. å•Ÿå‹•å¯¦æ™‚æµ
    shard_feed = ShardFeed(all_symbols)
    await shard_feed.start()
```

---

## ğŸ“š ç›¸é—œæ–‡ä»¶

- `src/core/startup_prewarmer.py` - å†·å•Ÿå‹•é ç†±å¼•æ“
- `src/core/cluster_manager.py` - å·²æ›´æ–° warmup_complete æ¨™èªŒ
- `src/ml/feature_engineer.py` - å·²æ›´æ–° min_size åƒæ•¸
- `COLD_START_ANALYSIS_CN.md` - æœ¬æ–‡æª”

---

## ğŸ“ æŠ€è¡“æ·±åº¦

### ç‚ºä»€éº¼å†·å•Ÿå‹•é€™éº¼è¤‡é›œ?

**æ ¹æœ¬åŸå› **: æ™‚é–“åºåˆ—ç‰¹æ€§

```
æŠ€è¡“æŒ‡æ¨™éœ€è¦æ­·å²ä¸Šä¸‹æ–‡:
- RSI = éœ€è¦éå»14æ ¹Kç·šçš„æ¯”è¼ƒ
- ATR = éœ€è¦æ³¢å‹•ç‡è¨ˆç®—
- FVG = éœ€è¦çœ‹åˆ°å¸‚å ´çµæ§‹å½¢æˆ
- BOS = éœ€è¦çœ‹åˆ°è¶¨å‹¢åè½‰

æ²’æœ‰æ­·å² = æ²’æœ‰ä¸Šä¸‹æ–‡ = ç„¡æ³•åšæ±ºç­–
```

### ç‚ºä»€éº¼Heuristicä¸å¤ å¥½?

```
Heuristic = åŸºæ–¼è¦å‰‡çš„å‡è¨­
ä¾‹å¦‚: "å¦‚æœ RSI < 30, è²·å…¥"

å•é¡Œ: å¸‚å ´ä¸éµå¾ªç°¡å–®è¦å‰‡!
- ä¸åŒæ™‚é–“ã€ä¸åŒå°ã€ä¸åŒå¸‚æ³
- éƒ½éœ€è¦ä¸åŒçš„ç­–ç•¥

LightGBM = å­¸ç¿’ 300+ å°çš„æ¨¡å¼
- è‡ªå‹•ç™¼ç¾éš±è—çš„ç›¸é—œæ€§
- è‡ªé©æ‡‰ä¸åŒå¸‚å ´ç‹€æ³
```

---

**çµè«–**: å†·å•Ÿå‹•é ç†±æ˜¯ **ç”Ÿç”¢å¿…éœ€** çš„çµ„ä»¶ï¼Œä¸æ˜¯å¯é¸çš„ã€‚

**é æœŸæ”¹é€²**: ç³»çµ±é¦–æ¬¡äº¤æ˜“å»¶é²å¾ **5åˆ†é˜ â†’ 30ç§’** (85% æ”¹é€²)ã€‚

---

*å†·å•Ÿå‹•åˆ†æå®Œæˆ: 2025-11-22 16:15 UTC*
