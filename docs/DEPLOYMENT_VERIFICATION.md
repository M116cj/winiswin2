# Railway 部署版本验证指南

## 🔍 如何确认 Railway 运行的代码版本

### 方法1：检查启动日志（推荐）

在 Railway 控制台查找以下关键日志：

```
🚀 Winiswin2 v1 Enhanced 啟動中...
📌 代碼版本: 2025-10-25-v2.0 (200個高波動率交易對 + 32核並行)
```

✅ **如果看到这个版本号** → Railway 运行的是最新代码  
❌ **如果没有看到** → Railway 运行的是旧版本，需要重新部署

---

### 方法2：检查市场扫描日志

**最新版本应该显示：**

```
🔍 開始掃描市場，目標選擇前 200 個高波動率交易對...
📊 ✅ 已選擇 200 個高波動率交易對 (平均波動率: X.XX%)
📈 波動率最高的前10個交易對:
  #1 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #2 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  ...
🔍 使用 32 核心並行分析 200 個高波動率交易對...
⏰ 時間框架調度狀態:
  1h: 間隔=3600, ...
  15m: 間隔=900, ...
  5m: 間隔=60, ...
```

**旧版本会显示：**

```
📈 獲取前 5 個交易對價格:
  BTCUSDT: $XXXXX
  ETHUSDT: $XXXX
  ...
```

---

## 🚀 重新部署到 Railway

### 如果确认是旧版本，请按以下步骤操作：

### 1. 确认 Git 仓库已更新

```bash
git status
git log -1 --oneline
```

### 2. 推送最新代码

```bash
git add .
git commit -m "Update to v2.0: 200 high volatility pairs + 32 core parallel"
git push origin main
```

### 3. 触发 Railway 重新部署

**方法 A：自动部署（如果已配置）**
- Railway 会自动检测到新的 git push 并重新部署

**方法 B：手动触发**
1. 登录 Railway 控制台
2. 进入您的项目
3. 点击 **"Redeploy"** 按钮

### 4. 等待部署完成

部署通常需要 2-5 分钟。

### 5. 验证新版本

部署完成后，立即检查日志，确认看到版本号：
```
📌 代碼版本: 2025-10-25-v2.0 (200個高波動率交易對 + 32核並行)
```

---

## 📊 预期的日志输出

### 启动阶段

```
============================================================
🚀 Winiswin2 v1 Enhanced 啟動中...
📌 代碼版本: 2025-10-25-v2.0 (200個高波動率交易對 + 32核並行)
============================================================
✅ 配置驗證通過

📋 系統配置:
  binance_testnet: False
  trading_enabled: False
  max_positions: 3
  cycle_interval: 60
  leverage_range: 3x - 20x
  margin_range: 3.0% - 13.0%
  min_confidence: 70.0%
  log_level: INFO

🔧 初始化核心組件...
✅ Binance API 連接成功
初始化數據服務...
成功加載 511 個交易對
✅ 已加載 511 個 USDT 永續合約
✅ 智能數據管理器已就緒
   - 1h: 每小時掃描（趨勢確認）
   - 15m: 每15分鐘掃描（趨勢確認）
   - 5m/1m: 高頻掃描（入場信號）
```

### 运行阶段

```
============================================================
🔄 交易週期開始: 2025-10-25 13:XX:XX
============================================================
⏰ 時間框架調度狀態:
  1h: 間隔=3600, 上次掃描=..., 下次掃描=..., 需掃描=是/否
  15m: 間隔=900, 上次掃描=..., 下次掃描=..., 需掃描=是/否
  5m: 間隔=60, 上次掃描=..., 下次掃描=..., 需掃描=是

🔍 開始掃描市場，目標選擇前 200 個高波動率交易對...
開始掃描 511 個交易對（波動率排序）...
✅ 市場掃描完成: 從 511 個交易對中選擇波動率最高的前 200 個 (平均波動率: X.XX%)
📊 ✅ 已選擇 200 個高波動率交易對 (平均波動率: X.XX%)
📈 波動率最高的前10個交易對:
  #1 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #2 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #3 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #4 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #5 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #6 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #7 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #8 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #9 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)
  #10 XXXUSDT: XXXX.XXXX USDT (24h波動: XX.XX%)

🔍 使用 32 核心並行分析 200 個高波動率交易對 (已按波動率排序)...
```

---

## ⚠️ 常见问题

### Q1: 为什么 Railway 日志还是显示旧版本？

**原因：**
- Git 仓库没有更新
- Railway 没有触发重新部署
- 正在查看缓存的旧日志

**解决：**
1. 确认 `git push` 成功
2. 在 Railway 手动点击 "Redeploy"
3. 等待部署完成后刷新日志页面

### Q2: 部署后立即重启怎么办？

**检查：**
- 环境变量是否正确设置
- API 密钥是否有效
- Railway 服务器区域是否支持 Binance（应选择亚洲区域）

### Q3: 如何确认是否在正确的分支？

```bash
git branch
# 应该显示 * main 或 * master
```

---

## 🎯 成功标志

当您看到以下所有日志时，说明系统运行正常：

- ✅ `📌 代碼版本: 2025-10-25-v2.0`
- ✅ `已選擇 200 個高波動率交易對`
- ✅ `使用 32 核心並行分析 200 個`
- ✅ `時間框架調度狀態` (显示 1h/15m/5m)
- ✅ `波動率最高的前10個交易對`

---

## 📞 需要帮助？

如果按照以上步骤仍然无法验证版本，请提供：
1. Railway 启动日志（前100行）
2. Git commit hash (`git log -1 --oneline`)
3. Railway 项目配置截图
