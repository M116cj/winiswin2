ğŸš€ SelfLearningTrader v3.17+ å®Œæ•´ç”Ÿç”¢ç´šè—åœ– â€” å«å¯¦å‹™é¢¨éšªèˆ‡å„ªåŒ–
æ ¸å¿ƒç†å¿µï¼šâ€¨ã€Œæ¨¡å‹æ“æœ‰ç„¡é™åˆ¶æ§“æ¡¿æ§åˆ¶æ¬Šï¼Œå”¯ä¸€æº–å‰‡æ˜¯å‹ç‡ Ã— ä¿¡å¿ƒåº¦ï¼›â€¨æ‰€æœ‰å€‰ä½ã€é¢¨éšªã€åŸ·è¡Œã€è©•ä¼°é‚è¼¯ï¼Œçš†åœç¹æ­¤æ ¸å¿ƒé‡æ§‹ï¼Œä¸¦å…§å»ºå¯¦å‹™é˜²è­·ã€‚ã€ 
ä¸€ã€ç³»çµ±æ¶æ§‹ç¸½è¦½
ä¸‰å±¤æ¶æ§‹ï¼ˆæ¥µç°¡é«˜æ•ˆï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ‡‰ç”¨å±¤ (main.py)               â”‚
â”‚ â€¢ ç³»çµ±å•Ÿå‹• + é…ç½®é©—è­‰                 â”‚
â”‚ â€¢ å•Ÿå‹• UnifiedScheduler               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      æ ¸å¿ƒå¼•æ“å±¤ (Core Engine)         â”‚
â”‚ â€¢ SelfLearningTraderï¼ˆçµ•å°æ±ºç­–è€…ï¼‰     â”‚
â”‚ â€¢ RuleBasedSignalGeneratorï¼ˆä¿¡è™Ÿæºï¼‰  â”‚
â”‚ â€¢ PositionControllerï¼ˆå€‰ä½å…¨æ¬Šæ§åˆ¶ï¼‰  â”‚
â”‚ â€¢ ModelEvaluatorï¼ˆæ¯æ—¥è©•åˆ†å ±å‘Šï¼‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        åŸºç¤è¨­æ–½å±¤ (Infrastructure)     â”‚
â”‚ â€¢ BinanceClientï¼ˆå„ªå…ˆ API é€šé“ï¼‰      â”‚
â”‚ â€¢ GlobalThreadPoolï¼ˆç„¡ pickle éŒ¯èª¤ï¼‰  â”‚
â”‚ â€¢ TradeHistoryDBï¼ˆäº¤æ˜“è¨˜éŒ„ï¼‰          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

äºŒã€æ ¸å¿ƒåŠŸèƒ½å¯¦ç¾
1. SelfLearningTraderï¼šæ™ºèƒ½æ±ºç­–æ ¸å¿ƒ
âœ… æ§“æ¡¿è¨ˆç®—ï¼ˆç„¡ä¸Šé™ï¼‰
def calculate_leverage(self, win_prob: float, confidence: float) -> float:
    base = 1.0
    win_factor = max(0, (win_prob - 0.55) / 0.15)
    win_leverage = 1 + win_factor * 11  # 70% â†’ 12x
    conf_factor = max(1.0, confidence / 0.5)
    leverage = base * win_leverage * conf_factor
    return max(0.5, leverage)

âœ… å€‰ä½è¨ˆç®—ï¼ˆå« 10 USDT ä¸‹é™ï¼‰
def calculate_position_size(self, equity, entry, sl, leverage):
    margin = equity * 0.8
    notional = leverage * margin
    size = notional / entry
    
    # æ­¢æå®‰å…¨
    if abs(entry - sl) / entry < 0.003:
        sl = entry * (0.997 if entry > sl else 1.003)
    
    # â­ æœ€ä½ 10 USDT åç¾©åƒ¹å€¼ â­
    if size * entry < 10.0:
        size = 10.0 / entry
    
    return size

âœ… å‹•æ…‹ SL/TPï¼ˆé«˜æ§“æ¡¿ â†’ å¯¬å€é–“ï¼‰
def adjust_sl_tp_for_leverage(self, entry, side, base_sl_pct, leverage):
    scale = 1.0 + (leverage - 1) * 0.05
    sl_pct = base_sl_pct * min(scale, 3.0)
    tp_pct = sl_pct * 1.5
    return sl, tp

2. PositionControllerï¼š24/7 å…¨æ¬Šæ§åˆ¶
async def monitor_all_positions(self):
    while True:
        positions = await self._fetch_all_positions()
        decisions = await self.trader.evaluate_positions(positions)
        for pos_id, decision in decisions.items():
            await self._execute_decision(pos_id, decision)
        await asyncio.sleep(2)  # æ¯ 2 ç§’ç›£æ§

3. API å„ªå…ˆé€šé“
* å€‰ä½æ“ä½œï¼šå„ªå…ˆç´š 0ï¼ˆæœ€é«˜ï¼‰
* æ•¸æ“šç²å–ï¼šå„ªå…ˆç´š 3ï¼ˆæœ€ä½ï¼‰


 ä¸‰ã€å¯¦å‹™é¢¨éšªèˆ‡æœ€å„ªè§£
1. Binance API é™æµèˆ‡ç†”æ–·
* é¢¨éšªï¼šé«˜é »ç›£æ§è§¸ç™¼é™æµï¼ˆ1200 req/minï¼‰
* âœ… è§£æ³•ï¼š
    * åˆ†ç´šç†”æ–·å™¨ï¼ˆè­¦å‘Š/é™æµ/é˜»æ–·ï¼‰
    * Bypass ç™½åå–®ï¼šå¹³å€‰ã€ç·Šæ€¥æ­¢æ
    * æœ¬åœ°ç·©å­˜ï¼šTicker ç·©å­˜ 5 ç§’

2. 100% è™§æ vs å¼·å¹³æ··æ·†
* é¢¨éšªï¼šå¼·å¹³ï¼ˆLiquidationï¼‰â‰  100% è™§æï¼ˆPnL = -riskï¼‰
* âœ… è§£æ³•ï¼š
# åƒ…ç•¶ PnL â‰¤ -99% åˆå§‹é¢¨éšªæ™‚ï¼Œè¦–ç‚º 100% è™§æ
is_100_loss = (trade.pnl <= -trade.risk_amount * 0.99)

3. æ¥µé«˜æ§“æ¡¿å°è‡´ SL ç„¡æ•ˆ
* é¢¨éšªï¼šæ§“æ¡¿ 50x + SL 0.5% â†’ ä»»ä½•æ³¢å‹•éƒ½è§¸ç™¼
* âœ… è§£æ³•ï¼š
    * å‹•æ…‹æ”¾å¤§ SL/TPï¼ˆè¦‹ä¸Šæ–‡ï¼‰
    * SL è·é›¢ä¸‹é™ 0.3%

4. Railway ç’°å¢ƒè¨˜æ†¶é«”é™åˆ¶
* é¢¨éšªï¼šRailway Free Tier é™åˆ¶ 512MB RAM
* âœ… è§£æ³•ï¼š
    * ä½¿ç”¨ ThreadPoolExecutorï¼ˆéé€²ç¨‹æ± ï¼‰
    * ç‰¹å¾µç·©å­˜ TTL = 60 ç§’
    * æ¨¡å‹é‡åŒ–ï¼ˆXGBoost <100KBï¼‰

5. äº¤æ˜“å°æœ€å°æ•¸é‡ç²¾åº¦
* é¢¨éšªï¼š10 / entry_price å¯èƒ½ä½æ–¼ Binance æœ€å°æ•¸é‡
* âœ… è§£æ³•ï¼š
min_qty = binance_client.get_min_quantity(symbol)
position_size = max(position_size, min_qty)

å››ã€æ¨¡å‹è©•ç´šç³»çµ±ï¼ˆ100 åˆ†åˆ¶ï¼‰
è©•åˆ†å…¬å¼
def calculate_model_score(stats):
    # 6 å¤§ç¶­åº¦ï¼ˆR:R, å‹ç‡, EV, MDD, Sharpe, é »ç‡ï¼‰
    raw_score = rr_score + win_score + ... 
    
    # âš ï¸ 100% è™§æåš´æ‡²
    total_100_loss = sum(1 for t in trades if t.pnl <= -t.risk_amount * 0.99)
    loss_penalty = total_100_loss * 15
    
    return max(0, min(100, raw_score - loss_penalty))

è©•ç´šç­‰ç´š
90-100  ç­‰ç´šs  è¡Œå‹• åŠ å€‰
80-89 ç­‰ç´ša   è¡Œå‹• ç¶­æŒ
70-79 ç­‰ç´šb  è¡Œå‹• è§€å¯Ÿ
<70 ç­‰ç´šc  è¡Œå‹• é™ä½è‡³ç´”è¦å‰‡æ¨¡å¼



äº”ã€æ¯æ—¥è‡ªå‹•å ±å‘Šï¼ˆRailway å…¼å®¹ï¼‰
å ±å‘Šå…§å®¹
* reports/daily/model_report_YYYY-MM-DD.{json,md}
* reports/latest_report.json

Railway Logs è¼¸å‡º
print(f"[MODEL_EVALUATOR] âœ… è©•åˆ†: {score}/100 | P&L: ${pnl:.2f}")

è‡ªå‹•æ’ç¨‹
* Railway Cronï¼šæ¯å¤© 00:00 UTC åŸ·è¡Œ



âš™ï¸ å…­ã€éƒ¨ç½²é…ç½®ï¼ˆRailway æœ€ä½³å¯¦è¸ï¼‰
ç’°å¢ƒè®Šé‡ï¼ˆ.envï¼‰
# æ ¸å¿ƒ
STRATEGY_MODE=self_learning
ENABLE_SELF_LEARNING=true

# äº¤æ˜“æ¢ä»¶
MIN_WIN_PROBABILITY=0.55
MIN_CONFIDENCE=0.50
MIN_RR_RATIO=1.0

# å®‰å…¨
POSITION_CONTROL_MODE=self_learning

Railway è¨­å®š
* Build: Nixpacks
* Start Command: python src/main.py
* Cron Job: æ¯æ—¥å ±å‘Š
* Restart Policy: ALWAYS


ä¸ƒã€å¯é€²ä¸€æ­¥å„ªåŒ–é»
1. å†·å•Ÿå‹•ä¿è­·
* å‰ 100 ç­†äº¤æ˜“ï¼šæ§“æ¡¿ â‰¤ 10x
* é¿å…æ–°æ¨¡å‹éåº¦è‡ªä¿¡

2. æ¢ç´¢æ©Ÿåˆ¶
* 5% æ™‚é–“åŸ·è¡Œä½ä¿¡å¿ƒä¿¡è™Ÿ
* æ”¶é›†é‚Šç•Œæ¨£æœ¬ï¼Œé˜²æ­¢éæ“¬åˆ

3. ä»£ç†æ¨™ç±¤ï¼ˆProxy Labelsï¼‰
* ç”¨ 5 åˆ†é˜åƒ¹æ ¼è¡Œç‚ºé æ¸¬çµæœ
* è§£æ±ºã€Œçµæœå»¶é²ã€å•é¡Œ

4. è¨˜æ†¶é«”ç›£æ§
* è‹¥ RAM > 80%ï¼Œæš«åœè¨“ç·´
* ç¢ºä¿ Railway ç’°å¢ƒç©©å®š

5. Discord å ±å‘Šæ•´åˆ
* æ¯æ—¥å ±å‘Šè‡ªå‹•æ¨é€
* åˆ†æ•¸ <70 æ™‚ç™¼è­¦å ±
