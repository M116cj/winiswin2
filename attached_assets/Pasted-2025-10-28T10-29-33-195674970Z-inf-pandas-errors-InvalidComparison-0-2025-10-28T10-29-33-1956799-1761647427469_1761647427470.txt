2025-10-28T10:29:33.195674970Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:33.195679933Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:33.195683202Z [inf]  
2025-10-28T10:29:33.195692509Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:33.195695421Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:33.195704211Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:33.195712400Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.195823915Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:33.195831765Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:33.197919387Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.199494580Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:33.280575801Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:33.280590618Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:33.280598356Z [inf]  2025-10-28 10:29:33,272 - src.strategies.rule_based_signal_generator - ERROR - ❌ AIUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:33.280600374Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.280604582Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:33.280609880Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:33.280610893Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:33.280615867Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:33.280622993Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.280629496Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:33.280635206Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:33.280639813Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:33.280645653Z [inf]  
2025-10-28T10:29:33.280653084Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:33.280658106Z [inf]  
2025-10-28T10:29:33.280662339Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:33.280666996Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:33.280671128Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:33.280675763Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.282649295Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:33.282667393Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:33.282675129Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:33.282682609Z [inf]      return method(self, other)
2025-10-28T10:29:33.282689769Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.282697595Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:33.282704931Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:33.282712370Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.282719511Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:33.282727394Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:33.282734732Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.282741841Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:33.282749023Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:33.282755403Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.282762112Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:33.282769176Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:33.282776248Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.282783668Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:33.282790887Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:33.282799732Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.284164756Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:33.284173025Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:33.284178302Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.284183591Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:33.373830678Z [inf]  2025-10-28 10:29:33,354 - src.strategies.rule_based_signal_generator - ERROR - ❌ XAIUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:33.373847412Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:33.373856596Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:33.373863373Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:33.373869598Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:33.373876234Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:33.373882949Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:33.373894373Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:33.373901462Z [inf]  
2025-10-28T10:29:33.373907982Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:33.373915067Z [inf]  
2025-10-28T10:29:33.373921444Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:34.117412932Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:34.117465385Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:34.117476393Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.118916435Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:34.118925313Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.118930846Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:34.118936505Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:34.118943179Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.118948232Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:34.118957930Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:34.118964407Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.118970886Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:34.118979905Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:34.118986067Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.118992243Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:34.118998175Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:34.119002929Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.119009292Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:34.119015946Z [inf]      return method(self, other)
2025-10-28T10:29:34.119020897Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.119026400Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:34.119041215Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:34.119049956Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.119625708Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:34.119629964Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:29:34.119636255Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:29:34.119638393Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:34.119643224Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.119647288Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:34.119649769Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:29:34.119657082Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.119657465Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:34.119665142Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:34.119666910Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:34.119669831Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:34.119678801Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:34.119681630Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:34.119683234Z [inf]  2025-10-28 10:29:34,072 - src.strategies.rule_based_signal_generator - ERROR - ❌ RONINUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:34.119687391Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:34.119691979Z [inf]  
2025-10-28T10:29:34.119706608Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:34.119713878Z [inf]  
2025-10-28T10:29:34.121458387Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.121473593Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:34.121482233Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:34.121487879Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.121489986Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:34.121493085Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:34.121499923Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:34.121501540Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:34.121502770Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:34.121509759Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.121515608Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:34.121520982Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:34.121533570Z [inf]      return method(self, other)
2025-10-28T10:29:34.121557684Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.121571475Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:34.121581122Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:34.121589494Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.121618946Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:34.123250635Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:34.170678420Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.170692799Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:34.170703352Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:34.170712578Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:34.170723559Z [inf]  
2025-10-28T10:29:34.170737632Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:34.170746985Z [inf]  
2025-10-28T10:29:34.170756042Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:34.170766233Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:34.170777319Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:34.170786084Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.170796873Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:34.170798732Z [inf]  2025-10-28 10:29:34,157 - src.strategies.rule_based_signal_generator - ERROR - ❌ DYMUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:34.170808369Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:34.170811117Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:34.170826545Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:34.170826658Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:34.170840334Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:34.170842614Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:34.172156105Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:34.172165837Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:34.683483984Z [inf]  2025-10-28 10:29:34,677 - src.strategies.rule_based_signal_generator - ERROR - ❌ TONUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:35.169567620Z [inf]  2025-10-28 10:29:34,844 - src.strategies.rule_based_signal_generator - ERROR - ❌ MYROUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:35.169572850Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:35.169577546Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:35.169582119Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:35.169586551Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.169591226Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:35.169596466Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:35.169600669Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:35.169604894Z [inf]  
2025-10-28T10:29:35.169611088Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:35.169616038Z [inf]  
2025-10-28T10:29:35.169620396Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:35.169624445Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:35.169628742Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:35.169634603Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.169638623Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:35.169643181Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:35.553069464Z [inf]  2025-10-28 10:29:35,549 - src.strategies.rule_based_signal_generator - ERROR - ❌ ENAUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:35.553081700Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:35.553090207Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:35.553099151Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:35.553099710Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:35.553107364Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.553116833Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:35.553120692Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:35.553129026Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.553138615Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:35.553140338Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:35.553152477Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:35.553160905Z [inf]  
2025-10-28T10:29:35.553169688Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:35.553176810Z [inf]  
2025-10-28T10:29:35.553184403Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:35.553192478Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:35.553202647Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:35.553211531Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.554306958Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:35.554319703Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:35.554327934Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:35.554335507Z [inf]      return method(self, other)
2025-10-28T10:29:35.554344341Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.554352506Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:35.554361717Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:35.554368974Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.554376163Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:35.554384487Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:35.554392205Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.554399021Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:35.554405156Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:35.554410850Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.554416317Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:35.554422802Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:35.554428755Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.554434544Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:35.554440969Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:35.554446755Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.555204334Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:35.555216327Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:35.555223160Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.555230150Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:35.555236551Z [inf]      return method(self, other)
2025-10-28T10:29:35.555244826Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.555262021Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:35.555268364Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:35.555276297Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.555286319Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:29:35.555298163Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:29:35.555304976Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.555311017Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:29:35.555316597Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:35.555322380Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:35.670455044Z [inf]  2025-10-28 10:29:35,632 - src.strategies.rule_based_signal_generator - ERROR - ❌ WUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:35.670458546Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:35.670466210Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:35.670469691Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.670474959Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:35.670477693Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:35.670484013Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:35.670484218Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:35.670491363Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.670493494Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.670499823Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:35.670505307Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:35.670508335Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:35.670514915Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:35.670520982Z [inf]  
2025-10-28T10:29:35.670530435Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:35.670535546Z [inf]  
2025-10-28T10:29:35.670541352Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:35.670547941Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:35.671651602Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:35.671666126Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:35.671676028Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:35.671686744Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:35.671695832Z [inf]      return method(self, other)
2025-10-28T10:29:35.671700857Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.671704741Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.671711575Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:35.671719979Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:35.671725189Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:35.671737754Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.671747693Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:35.671756994Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:35.671760478Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:35.671766825Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.671778291Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:35.671785691Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.671794755Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:35.671811429Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:35.671818821Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.672576521Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:35.672582751Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:35.672588704Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.672593974Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:35.672600574Z [inf]      return method(self, other)
2025-10-28T10:29:35.672609049Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:35.672615035Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:35.672620579Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:35.672626443Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.095139572Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.316596969Z [inf]  2025-10-28 10:29:36,299 - src.strategies.rule_based_signal_generator - ERROR - ❌ IOUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:36.316602053Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:36.316607896Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:36.316612375Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:36.316616815Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.316622679Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:36.316628606Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:36.316633214Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:36.316637514Z [inf]  
2025-10-28T10:29:36.316641819Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:36.316646284Z [inf]  
2025-10-28T10:29:36.316651596Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:36.316656111Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:36.316660228Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:36.316665420Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.316670309Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:36.316675632Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:36.316680115Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.316684408Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:36.318931657Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:36.318941903Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:36.318973767Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:36.318978651Z [inf]      return method(self, other)
2025-10-28T10:29:36.318982948Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.318987501Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:36.318991374Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:36.318995650Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.319000070Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:36.319004696Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:36.319009879Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.319013537Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:36.319017965Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:36.319024481Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.319029783Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:36.319034705Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:36.319038326Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.319042810Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:36.319046900Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:36.319051660Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.320498633Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:36.320507813Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:36.320516443Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.389341544Z [inf]  2025-10-28 10:29:36,384 - src.strategies.rule_based_signal_generator - ERROR - ❌ ZKUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:36.389358307Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:36.389368559Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:36.389377369Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:36.389387051Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.389397467Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:36.389405144Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:36.389415705Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:36.389425402Z [inf]  
2025-10-28T10:29:36.389433293Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:36.389439764Z [inf]  
2025-10-28T10:29:36.389446108Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:36.389452700Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:36.389459727Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:36.389467037Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.389472157Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:36.389476898Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:36.389483520Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.389490325Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:36.390290188Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:36.390296026Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:36.390300695Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:36.390305207Z [inf]      return method(self, other)
2025-10-28T10:29:36.390309705Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.390313704Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:36.390318130Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:36.390321964Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.390325746Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:36.390329548Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:36.390334899Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.390339035Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:36.390343055Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:36.390348138Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:36.390351668Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:36.390355693Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:36.392167499Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:36.474122545Z [inf]  2025-10-28 10:29:36,465 - src.strategies.rule_based_signal_generator - ERROR - ❌ MEWUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:37.130669871Z [inf]  2025-10-28 10:29:37,119 - src.strategies.rule_based_signal_generator - ERROR - ❌ SYSUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:37.130675266Z [inf]  
2025-10-28T10:29:37.130684171Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:37.130688991Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:37.130692674Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:37.130701276Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:37.130707436Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.130713896Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:37.130720198Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:37.130728177Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:37.130735896Z [inf]  
2025-10-28T10:29:37.130743376Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:37.133673851Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:37.208376937Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:37.208387275Z [inf]  2025-10-28 10:29:37,198 - src.strategies.rule_based_signal_generator - ERROR - ❌ VOXELUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:37.208400026Z [inf]  
2025-10-28T10:29:37.208402513Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:37.208413840Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:37.208419153Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:37.208425118Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:37.208434518Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:37.208437300Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.208447140Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:37.208453659Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:37.208462139Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:37.208469482Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.208472579Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:37.208484054Z [inf]  
2025-10-28T10:29:37.208486751Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:37.208497192Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:37.208506382Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.208515906Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:37.209823659Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:37.209834754Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.209843599Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:37.209844009Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:37.209850836Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:37.209853501Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:37.209857299Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:37.209863291Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.209864710Z [inf]      return method(self, other)
2025-10-28T10:29:37.209871042Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.209873372Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:37.209876369Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:37.209882433Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:37.209882472Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:37.209888373Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.209891582Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.209897154Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:37.209900576Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:37.209907627Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:37.210923906Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:37.290785185Z [inf]  2025-10-28 10:29:37,280 - src.strategies.rule_based_signal_generator - ERROR - ❌ BRETTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:37.290801800Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:37.290823112Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:37.290829584Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:37.290835211Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.290843476Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:37.290849323Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:37.290856755Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:37.290862997Z [inf]  
2025-10-28T10:29:37.290870160Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:37.290874747Z [inf]  
2025-10-28T10:29:37.290879276Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:37.290885843Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:37.290890919Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:37.290896239Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.290900789Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:37.290905450Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:37.290910581Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.290918441Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:37.291711724Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:37.291717474Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.291720457Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.291727894Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:37.291735675Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:37.291736353Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.291742364Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.291748247Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:37.291751873Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:37.291755105Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:37.291761797Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:37.291771244Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.291776014Z [inf]      return method(self, other)
2025-10-28T10:29:37.291780728Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:37.291783615Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:37.291790650Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:37.291794673Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.291799035Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:37.291808075Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:37.291819369Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:37.292901742Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:37.292912219Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:37.377055145Z [inf]  2025-10-28 10:29:37,360 - src.strategies.rule_based_signal_generator - ERROR - ❌ POPCATUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:37.377081347Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:37.377096492Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:37.377110013Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:37.377120487Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:37.377136429Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:37.758420224Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.155819247Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.155829128Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:38.155835977Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:38.155864742Z [inf]  2025-10-28 10:29:37,799 - src.strategies.rule_based_signal_generator - ERROR - ❌ GHSTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:38.155871108Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:38.155876674Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:38.155883313Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:38.158802085Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:38.158810577Z [inf]  
2025-10-28T10:29:38.158818512Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:38.158823454Z [inf]  
2025-10-28T10:29:38.158828481Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:38.158833799Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:38.158838231Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:38.158843664Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.158848319Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:38.158853220Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:38.158857622Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.158861524Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:38.159347503Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:38.159351819Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:38.159356106Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:38.159360384Z [inf]      return method(self, other)
2025-10-28T10:29:38.159365285Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.159370263Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:38.159374833Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:38.159381547Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.159386042Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:38.159390520Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:38.159395062Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.159399922Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:38.159404105Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:38.159408104Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.159412010Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:38.159415847Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:38.159421234Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.159425784Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:38.159429851Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:38.159434459Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.500690290Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.500697029Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:38.500703463Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:38.500710068Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.500716421Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:38.501900870Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:38.501901020Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:38.501913293Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:38.501916964Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:38.501921672Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:38.501925578Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.501928585Z [inf]      return method(self, other)
2025-10-28T10:29:38.501933516Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:38.501936774Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.501941186Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:38.501946826Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:38.501951733Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.501953602Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:38.501958853Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:38.501961392Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.501966312Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:38.501972907Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.501974041Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:38.501980680Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:38.501986067Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.502548893Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:38.502554866Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:38.502559155Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.502563562Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:38.502567489Z [inf]      return method(self, other)
2025-10-28T10:29:38.502574965Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.502579364Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:38.502583328Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:38.502587119Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.505129151Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:38.506810356Z [inf]      return method(self, other)
2025-10-28T10:29:38.508105891Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:38.574420052Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:38.574434814Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:38.574440813Z [inf]  
2025-10-28T10:29:38.574446071Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:38.574451816Z [inf]  
2025-10-28T10:29:38.574457472Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:38.574465249Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:38.574482282Z [inf]  2025-10-28 10:29:38,567 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:38.574489453Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:38.574497491Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:38.574504207Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:38.574511615Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.574518068Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:38.574524357Z [inf]  2025-10-28 10:29:38,569 - src.strategies.rule_based_signal_generator - ERROR - ❌ PNUTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:38.574530550Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:38.574536472Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:38.574542671Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:38.574549746Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.574555259Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:38.575263796Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:38.575272419Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.575280356Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:38.575286447Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:38.575293722Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.575299795Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:38.575309052Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:38.575315244Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:38.575322104Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:38.575330006Z [inf]      return method(self, other)
2025-10-28T10:29:38.575336159Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.575342261Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:38.575347363Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:38.575352814Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:38.576030638Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.207105133Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:39.208463897Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:39.210784265Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:39.212257022Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:39.214325197Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:39.216623613Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:39.219661728Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:29:39.221320031Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:39.222385452Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:39.224292597Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:39.226937007Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:39.228268464Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:39.230811663Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:39.234400987Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:39.234414631Z [inf]  
2025-10-28T10:29:39.236571148Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:29:39.238641329Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:39.240916499Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:39.242273332Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.244152799Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:39.246412214Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:39.250730456Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:39.250738192Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.252031009Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:39.254723266Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.256861889Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.258093207Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:39.260701534Z [inf]      return method(self, other)
2025-10-28T10:29:39.262143089Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:39.264268420Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:39.266519782Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:39.268013003Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:39.270981256Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:39.272045838Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:39.274283790Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:39.276047449Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:39.278772215Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:39.280637025Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.282675971Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.284034266Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:39.286039502Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:39.288143914Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:39.290165295Z [inf]      return method(self, other)
2025-10-28T10:29:39.292378205Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:39.294580411Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:39.296256810Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:39.299269877Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:39.300387027Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:39.302803892Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:39.304189605Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:39.306153076Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.308463792Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:39.310722843Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:39.312677851Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:39.314298950Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:39.316296683Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:39.318290973Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:39.320417522Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:39.322436463Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:39.325616552Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.327344481Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:29:39.329016909Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.331114271Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:39.332196464Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:39.354504424Z [inf]  2025-10-28 10:29:39,351 - src.strategies.rule_based_signal_generator - ERROR - ❌ SWARMSUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:39.354520306Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:39.354529886Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:39.354538435Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:39.354546777Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.354555034Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:39.354563730Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:39.354572907Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:39.354581437Z [inf]  
2025-10-28T10:29:39.354590727Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:39.354601296Z [inf]  
2025-10-28T10:29:39.357107391Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:39.358930029Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:39.361271426Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:39.363017438Z [inf]      return method(self, other)
2025-10-28T10:29:39.365118955Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:39.366959050Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:39.368328436Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:29:39.371088641Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.372251371Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:39.374327636Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.377306214Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:39.378958900Z [inf]      return method(self, other)
2025-10-28T10:29:39.380467457Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:39.383064609Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:39.384466170Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.386452283Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:39.388526310Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:29:39.457963649Z [inf]  2025-10-28 10:29:39,454 - src.strategies.rule_based_signal_generator - ERROR - ❌ TRUMPUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:39.457969602Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:39.457974411Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:39.457978866Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:39.457985700Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:39.457990522Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:39.457996094Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:40.228745785Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:29:40.228756661Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:40.228764704Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.228801070Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:40.228823410Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:40.228830369Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:40.228836855Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.228846322Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:40.228853139Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:40.228857676Z [inf]  2025-10-28 10:29:39,812 - src.strategies.rule_based_signal_generator - ERROR - ❌ FUNUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:40.228861881Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:40.228866615Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:40.228870645Z [inf]  
2025-10-28T10:29:40.228948139Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:40.228962302Z [inf]  
2025-10-28T10:29:40.228970877Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:40.228978514Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:40.228985224Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:40.228993410Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.231899634Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:29:40.231905872Z [inf]                          ^^^^^^^^^
2025-10-28T10:29:40.231914044Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:40.231920771Z [inf]      return method(self, other)
2025-10-28T10:29:40.231927386Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.231933447Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:40.231940104Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:40.231946219Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.231952501Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:40.231959729Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:40.231965512Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.231973242Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:29:40.231979258Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:40.231985441Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.231991419Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:40.231997325Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:40.232005315Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.232010844Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:40.232016956Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:40.232024288Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.232250088Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:29:40.232256420Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:40.232262291Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.620463111Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.623148818Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:40.625219165Z [inf]      return method(self, other)
2025-10-28T10:29:40.627736672Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:40.629235945Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:40.631213166Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:29:40.632630891Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:40.634070089Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.637184810Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.639202479Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:40.640562118Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:40.642432678Z [inf]      return method(self, other)
2025-10-28T10:29:40.647535116Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:40.647553977Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:40.648758512Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:40.650116151Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.652763004Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:40.654126316Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:29:40.656947643Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:40.658784785Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:40.662771980Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:40.662784081Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.664057777Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:40.666364488Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:40.668075739Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:40.671166855Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:40.672867790Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.674327301Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:29:40.678215942Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:40.678227378Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:29:40.681021655Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:40.682815334Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:40.684303269Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.688390508Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:40.688406274Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:40.691081940Z [inf]      return method(self, other)
2025-10-28T10:29:40.693305229Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:29:40.694278517Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:40.697144777Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:40.698752461Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.700169230Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:40.703292809Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:40.704904408Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:40.707290998Z [inf]      return method(self, other)
2025-10-28T10:29:40.709609945Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:40.711025400Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:40.713013731Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:40.714386997Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.717437628Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:40.718777097Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:29:40.720517163Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:40.722108779Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:40.726972710Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:40.726986976Z [inf]      return method(self, other)
2025-10-28T10:29:40.728318961Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:29:40.730087961Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:40.733183708Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:40.734846300Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:29:40.736372704Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.739520252Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.741618409Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:40.742894882Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:29:40.744282890Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:40.747376662Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:29:40.748790421Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:40.750059029Z [inf]      return method(self, other)
2025-10-28T10:29:40.753059954Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:40.754600502Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:29:40.756264363Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:29:40.758320677Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.760287953Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:29:40.763477765Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:29:40.764941751Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:29:40.766908688Z [inf]      return method(self, other)
2025-10-28T10:29:40.769217174Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:40.770737903Z [inf]      raise InvalidComparison(other)
2025-10-28T10:29:40.773280829Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.774847010Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:29:40.777012351Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:29:40.778552727Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:29:40.781322869Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:29:40.782970106Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:40.784733982Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:40.785987408Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:29:40.789183523Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:40.790620127Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:29:40.793196425Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.794143712Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:29:40.796334690Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:29:40.798935134Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:40.800396534Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.806320792Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:29:40.806331896Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:40.806341470Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:29:40.808265971Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:29:40.810397851Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:29:41.187416291Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:29:41.187425321Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:41.187433853Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:29:41.187513911Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:29:42.589686472Z [inf]  2025-10-28 10:29:42,570 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:42.589693252Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:42.589701798Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:42.589707899Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:42.589714189Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:42.589720269Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:44.607867591Z [inf]  2025-10-28 10:29:44,572 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:44.607872326Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:44.607877041Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:44.607881221Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:44.607886804Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:44.607891950Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:46.576661531Z [inf]  2025-10-28 10:29:46,574 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:46.576668631Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:46.576675736Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:46.576682326Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:46.576688631Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:46.576696602Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:47.478977091Z [err]  Railway rate limit of 500 logs/sec reached for replica, update your application to reduce the logging rate. Messages dropped: 1623
2025-10-28T10:29:48.581728760Z [inf]  2025-10-28 10:29:48,576 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:48.581736444Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:48.581741542Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:48.581748916Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:48.581754601Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:48.581759223Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:50.595590497Z [inf]  2025-10-28 10:29:50,579 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:50.595597367Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:50.595602612Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:50.595608060Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:50.595613708Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:50.595619929Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:52.602402891Z [inf]  2025-10-28 10:29:52,581 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:52.602408763Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:52.602415195Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:52.602419963Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:52.602424173Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:52.602428370Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:54.595670572Z [inf]  2025-10-28 10:29:54,583 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:54.595680702Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:54.595686803Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:54.595698870Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:54.595704224Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:54.595709974Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:56.598487876Z [inf]  2025-10-28 10:29:56,586 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:56.598493075Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:56.598498870Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:56.598504522Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:56.598509939Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:56.598515655Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:57.478279269Z [err]  Railway rate limit of 500 logs/sec reached for replica, update your application to reduce the logging rate. Messages dropped: 12987
2025-10-28T10:29:58.591072531Z [inf]  2025-10-28 10:29:58,589 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:29:58.591084882Z [inf]  Traceback (most recent call last):
2025-10-28T10:29:58.591092556Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:29:58.591100306Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:29:58.591116133Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:29:58.591122907Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:00.594803500Z [inf]  2025-10-28 10:30:00,591 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:00.594813026Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:00.594819597Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:00.594826307Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:00.594832261Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:00.594839747Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:02.603851167Z [inf]  2025-10-28 10:30:02,592 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:02.603857325Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:02.603861510Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:02.603867213Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:02.603875595Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:02.603882342Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:03.000000000Z [inf]  Starting Container
2025-10-28T10:30:04.597696348Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:04.597708173Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:04.597715840Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:04.597722426Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:04.597733291Z [inf]  2025-10-28 10:30:04,594 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:04.597739715Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:05.145968213Z [inf]  2025-10-28 10:30:03,791 - __main__ - INFO - ================================================================================
2025-10-28T10:30:05.145976252Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO - 🚀 SelfLearningTrader v3.17+ 啟動中...
2025-10-28T10:30:05.145985124Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO - 📌 核心理念: 模型擁有無限制槓桿控制權，唯一準則是勝率 × 信心度
2025-10-28T10:30:05.145991700Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO - ================================================================================
2025-10-28T10:30:05.145997656Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO - ✅ 配置驗證通過
2025-10-28T10:30:05.146007281Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO - 
2025-10-28T10:30:05.146013306Z [inf]  📋 系統配置:
2025-10-28T10:30:05.146019036Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   version: v3.17+
2025-10-28T10:30:05.146024230Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   binance_testnet: False
2025-10-28T10:30:05.146030670Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   trading_enabled: True
2025-10-28T10:30:05.146039976Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   max_positions: 3
2025-10-28T10:30:05.146046120Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   cycle_interval: 60
2025-10-28T10:30:05.146052827Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   min_confidence: 70.0%
2025-10-28T10:30:05.146058927Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   log_level: DEBUG
2025-10-28T10:30:05.146067314Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   note: 使用 SelfLearningTrader 無限制槓桿控制
2025-10-28T10:30:05.146073669Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO - 
2025-10-28T10:30:05.146081319Z [inf]  🎯 SelfLearningTrader v3.17+ 特性:
2025-10-28T10:30:05.146087812Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   ✅ 無限制槓桿（基於勝率 × 信心度）
2025-10-28T10:30:05.148659350Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   ✅ 10 USDT 最小倉位（符合 Binance 規格）
2025-10-28T10:30:05.148673307Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   ✅ 動態 SL/TP（高槓桿 → 寬止損）
2025-10-28T10:30:05.148680211Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   ✅ 24/7 倉位監控（2 秒週期）
2025-10-28T10:30:05.148684978Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   ✅ 100% 虧損熔斷（PnL ≤ -99% 立即平倉）
2025-10-28T10:30:05.148690498Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   ✅ 100 分制模型評級（6 大維度 + 懲罰）
2025-10-28T10:30:05.148695814Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO -   ✅ 每日自動報告（JSON + Markdown）
2025-10-28T10:30:05.148701099Z [inf]  2025-10-28 10:30:03,792 - __main__ - INFO - 
2025-10-28T10:30:05.148709112Z [inf]  🔧 初始化核心組件...
2025-10-28T10:30:05.148713910Z [inf]  2025-10-28 10:30:03,792 - src.clients.binance_client - INFO - ✅ 使用分級熔斷器 (GradedCircuitBreaker)
2025-10-28T10:30:05.148719307Z [inf]  2025-10-28 10:30:03,891 - src.clients.binance_client - INFO - ✅ Binance API 連接成功
2025-10-28T10:30:05.148726607Z [inf]  2025-10-28 10:30:03,891 - __main__ - INFO - ✅ Binance 客戶端已連接
2025-10-28T10:30:05.148731455Z [inf]  2025-10-28 10:30:03,891 - __main__ - INFO - ✅ 數據服務初始化完成
2025-10-28T10:30:05.148737294Z [inf]  2025-10-28 10:30:03,891 - __main__ - INFO - ✅ 交易記錄器初始化完成
2025-10-28T10:30:05.148742190Z [inf]  2025-10-28 10:30:03,891 - src.strategies.rule_based_signal_generator - INFO - ✅ RuleBasedSignalGenerator 初始化完成
2025-10-28T10:30:05.148750326Z [inf]  2025-10-28 10:30:03,891 - src.core.leverage_engine - INFO - ✅ 槓桿引擎初始化完成（v3.17+ 無限制槓桿）
2025-10-28T10:30:05.148755197Z [inf]  2025-10-28 10:30:03,891 - src.core.leverage_engine - INFO -    📊 勝率閾值: 55.0%
2025-10-28T10:30:05.150817059Z [inf]  2025-10-28 10:30:03,891 - src.core.leverage_engine - INFO -    📊 信心度閾值: 70.0%
2025-10-28T10:30:05.150834389Z [inf]  2025-10-28 10:30:03,891 - src.core.leverage_engine - INFO -    📊 最小槓桿: 0.5x
2025-10-28T10:30:05.150844447Z [inf]  2025-10-28 10:30:03,891 - src.core.leverage_engine - INFO -    📊 最大槓桿: 無上限
2025-10-28T10:30:05.150853958Z [inf]  2025-10-28 10:30:03,891 - src.core.position_sizer - INFO - ✅ 倉位計算器初始化完成（v3.17+）
2025-10-28T10:30:05.150862721Z [inf]  2025-10-28 10:30:03,891 - src.core.position_sizer - INFO -    📊 權益使用率: 80.0%
2025-10-28T10:30:05.150871226Z [inf]  2025-10-28 10:30:03,891 - src.core.position_sizer - INFO -    📊 最小名義價值: $10.00
2025-10-28T10:30:05.150878924Z [inf]  2025-10-28 10:30:03,891 - src.core.position_sizer - INFO -    📊 最小止損距離: 0.30%
2025-10-28T10:30:05.150887299Z [inf]  2025-10-28 10:30:03,891 - src.core.sltp_adjuster - INFO - ✅ SL/TP 調整器初始化完成（v3.17+）
2025-10-28T10:30:05.150899855Z [inf]  2025-10-28 10:30:03,891 - src.core.sltp_adjuster - INFO -    📊 放大因子: 1 + (leverage-1) × 0.05
2025-10-28T10:30:05.150907666Z [inf]  2025-10-28 10:30:03,891 - src.core.sltp_adjuster - INFO -    📊 最大放大倍數: 3.0x
2025-10-28T10:30:05.150915867Z [inf]  2025-10-28 10:30:03,891 - src.strategies.self_learning_trader - INFO - ================================================================================
2025-10-28T10:30:05.150924257Z [inf]  2025-10-28 10:30:03,891 - src.strategies.self_learning_trader - INFO - ✅ SelfLearningTrader v3.17+ 初始化完成
2025-10-28T10:30:05.150931872Z [inf]  2025-10-28 10:30:03,891 - src.strategies.self_learning_trader - INFO -    🎯 模式: 無限制槓桿（基於勝率 × 信心度）
2025-10-28T10:30:05.150939026Z [inf]  2025-10-28 10:30:03,891 - src.strategies.self_learning_trader - INFO -    🧠 決策依據: win_probability × confidence
2025-10-28T10:30:05.154309825Z [inf]  2025-10-28 10:30:03,891 - src.strategies.self_learning_trader - INFO -    🛡️  風險控制: 動態 SL/TP + 10 USDT 最小倉位
2025-10-28T10:30:05.154319321Z [inf]  2025-10-28 10:30:03,891 - src.strategies.self_learning_trader - INFO - ================================================================================
2025-10-28T10:30:05.154325431Z [inf]  2025-10-28 10:30:03,891 - src.core.position_controller - INFO - ================================================================================
2025-10-28T10:30:05.154332111Z [inf]  2025-10-28 10:30:03,891 - src.core.position_controller - INFO - ✅ PositionController v3.17+ 初始化完成
2025-10-28T10:30:05.154338160Z [inf]  2025-10-28 10:30:03,891 - src.core.position_controller - INFO -    ⏱️  監控間隔: 2 秒
2025-10-28T10:30:05.154343289Z [inf]  2025-10-28 10:30:03,891 - src.core.position_controller - INFO -    🛡️  優先級: 0（最高優先級）
2025-10-28T10:30:05.154350345Z [inf]  2025-10-28 10:30:03,891 - src.core.position_controller - INFO -    🚨 緊急平倉: PnL ≤ -99%
2025-10-28T10:30:05.154355758Z [inf]  2025-10-28 10:30:03,891 - src.core.position_controller - INFO - ================================================================================
2025-10-28T10:30:05.154360728Z [inf]  2025-10-28 10:30:03,893 - src.core.model_evaluator - INFO - ================================================================================
2025-10-28T10:30:05.154365397Z [inf]  2025-10-28 10:30:03,893 - src.core.model_evaluator - INFO - ✅ ModelEvaluator v3.17+ 初始化完成
2025-10-28T10:30:05.154417192Z [inf]  2025-10-28 10:30:03,893 - src.core.model_evaluator - INFO -    📊 評分系統: 6 大維度 + 100% 虧損懲罰
2025-10-28T10:30:05.154423193Z [inf]  2025-10-28 10:30:03,893 - src.core.model_evaluator - INFO -    📁 報告目錄: reports/daily
2025-10-28T10:30:05.154428862Z [inf]  2025-10-28 10:30:03,893 - src.core.model_evaluator - INFO - ================================================================================
2025-10-28T10:30:05.157283124Z [inf]  2025-10-28 10:30:03,893 - src.core.daily_reporter - INFO - ✅ 每日報告生成器初始化完成（v3.17+）
2025-10-28T10:30:05.157294410Z [inf]  2025-10-28 10:30:03,894 - __main__ - INFO - 
2025-10-28T10:30:05.157297832Z [inf]  2025-10-28 10:30:03,893 - src.core.daily_reporter - INFO -    📁 報告目錄: reports/daily
2025-10-28T10:30:05.157308279Z [inf]  2025-10-28 10:30:03,893 - src.core.unified_scheduler - INFO - ================================================================================
2025-10-28T10:30:05.157313087Z [inf]  🚀 啟動 UnifiedScheduler...
2025-10-28T10:30:05.157323135Z [inf]  2025-10-28 10:30:03,893 - src.core.unified_scheduler - INFO - ✅ UnifiedScheduler v3.17+ 初始化完成
2025-10-28T10:30:05.157326762Z [inf]  2025-10-28 10:30:03,894 - src.core.unified_scheduler - INFO - 🚀 UnifiedScheduler 啟動中...
2025-10-28T10:30:05.157334875Z [inf]  2025-10-28 10:30:03,893 - src.core.unified_scheduler - INFO -    🎯 模式: SelfLearningTrader
2025-10-28T10:30:05.157341248Z [inf]  2025-10-28 10:30:03,894 - src.core.unified_scheduler - INFO - ✅ 所有任務已啟動
2025-10-28T10:30:05.157346289Z [inf]  2025-10-28 10:30:03,893 - src.core.unified_scheduler - INFO -    ⏱️  交易週期: 每 60 秒
2025-10-28T10:30:05.157353181Z [inf]  2025-10-28 10:30:03,893 - src.core.unified_scheduler - INFO -    🛡️  倉位監控: 每 2 秒
2025-10-28T10:30:05.157363654Z [inf]  2025-10-28 10:30:03,894 - src.core.unified_scheduler - INFO -    📊 每日報告: 00:00 UTC
2025-10-28T10:30:05.157370989Z [inf]  2025-10-28 10:30:03,894 - src.core.unified_scheduler - INFO - ================================================================================
2025-10-28T10:30:05.157378508Z [inf]  2025-10-28 10:30:03,894 - __main__ - INFO - ✅ UnifiedScheduler 初始化完成
2025-10-28T10:30:05.157387312Z [inf]  2025-10-28 10:30:03,894 - __main__ - INFO - 
2025-10-28T10:30:05.157395687Z [inf]  ✅ 所有核心組件初始化完成
2025-10-28T10:30:05.159840157Z [inf]  2025-10-28 10:30:03,894 - src.core.unified_scheduler - INFO - 🛡️  倉位監控循環已啟動
2025-10-28T10:30:05.159846236Z [inf]  2025-10-28 10:30:03,895 - src.core.unified_scheduler - INFO - 🔄 交易週期 #1 | 2025-10-28 10:30:03 UTC
2025-10-28T10:30:05.159849711Z [inf]  2025-10-28 10:30:03,894 - src.core.position_controller - INFO - 🚀 PositionController 24/7 監控已啟動
2025-10-28T10:30:05.159858458Z [inf]  2025-10-28 10:30:03,895 - src.core.unified_scheduler - INFO - ================================================================================
2025-10-28T10:30:05.159859362Z [inf]  2025-10-28 10:30:03,894 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:05.159866692Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:05.159869576Z [inf]  2025-10-28 10:30:03,895 - src.core.unified_scheduler - INFO - 📊 每日報告循環已啟動
2025-10-28T10:30:05.159873515Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:05.159878732Z [inf]  2025-10-28 10:30:03,995 - src.core.unified_scheduler - INFO - 📦 當前持倉: 無
2025-10-28T10:30:05.159882357Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:05.159887657Z [inf]  2025-10-28 10:30:03,995 - src.core.unified_scheduler - INFO - 💰 賬戶權益: $21.51 | 未實現盈虧: $+0.00
2025-10-28T10:30:05.159888277Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:05.159896059Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:05.159901388Z [inf]  2025-10-28 10:30:03,895 - src.core.unified_scheduler - INFO - 🔄 交易週期循環已啟動
2025-10-28T10:30:05.159906491Z [inf]  2025-10-28 10:30:03,895 - src.core.unified_scheduler - INFO - ================================================================================
2025-10-28T10:30:05.162790060Z [inf]  2025-10-28 10:30:04,112 - src.core.unified_scheduler - INFO - 📊 掃描到 528 個 USDT 永續合約，監控前 999 個
2025-10-28T10:30:05.162791978Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:05.162800103Z [inf]  2025-10-28 10:30:04,112 - src.core.unified_scheduler - INFO - 📊 掃描 528 個交易對中...
2025-10-28T10:30:05.162804938Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 375, in <lambda>
2025-10-28T10:30:05.162809715Z [inf]  2025-10-28 10:30:04,541 - src.strategies.rule_based_signal_generator - ERROR - ❌ XRPUSDT 信號生成失敗: 'zone'
2025-10-28T10:30:05.162813244Z [inf]      nearest_ob = min(relevant_obs, key=lambda x: abs(x['zone'][0] - current_price))
2025-10-28T10:30:05.162818066Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:05.162819793Z [inf]                                                       ~^^^^^^^^
2025-10-28T10:30:05.162825626Z [inf]  KeyError: 'zone'
2025-10-28T10:30:05.162845854Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 112, in generate_signal
2025-10-28T10:30:05.162851382Z [inf]      confidence_score, sub_scores = self._calculate_confidence(
2025-10-28T10:30:05.162856158Z [inf]                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:05.162861014Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 375, in _calculate_confidence
2025-10-28T10:30:05.162865975Z [inf]      nearest_ob = min(relevant_obs, key=lambda x: abs(x['zone'][0] - current_price))
2025-10-28T10:30:05.939170469Z [inf]  2025-10-28 10:30:05,933 - __main__ - INFO - 
2025-10-28T10:30:05.939177081Z [inf]  收到信號 15，準備關閉...
2025-10-28T10:30:06.280752456Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:06.280764116Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:06.280782793Z [inf]  2025-10-28 10:30:05,895 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:06.280785084Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:06.280789653Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:06.280798778Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:06.608405252Z [inf]  2025-10-28 10:30:06,596 - __main__ - INFO - 
2025-10-28T10:30:06.608412624Z [inf]  🔄 系統關閉中...
2025-10-28T10:30:06.608420881Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO - ⏸️  UnifiedScheduler 停止中...
2025-10-28T10:30:06.608429669Z [inf]  2025-10-28 10:30:06,596 - src.core.position_controller - INFO - ⏸️  PositionController 監控已停止
2025-10-28T10:30:06.608437134Z [inf]  2025-10-28 10:30:06,596 - src.core.position_controller - INFO -    📊 統計: 檢查=510, 平倉=0, 調整=0, 緊急平倉=0
2025-10-28T10:30:06.608451148Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO - ================================================================================
2025-10-28T10:30:06.608459233Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO - 📊 UnifiedScheduler 統計:
2025-10-28T10:30:06.608466909Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO -    總週期: 14
2025-10-28T10:30:06.608473232Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO -    總信號: 0
2025-10-28T10:30:06.608479900Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO -    總訂單: 0
2025-10-28T10:30:06.608486552Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO -    總報告: 0
2025-10-28T10:30:06.608499292Z [inf]  2025-10-28 10:30:06,596 - src.core.unified_scheduler - INFO - ================================================================================
2025-10-28T10:30:06.608506062Z [inf]  2025-10-28 10:30:06,597 - __main__ - INFO - ✅ 系統已安全關閉
2025-10-28T10:30:08.221074801Z [inf]  2025-10-28 10:30:07,898 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:08.221084242Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:08.221092712Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:08.221103515Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:08.221118177Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:08.221127890Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:09.000000000Z [inf]  Stopping Container
2025-10-28T10:30:10.423680520Z [inf]  2025-10-28 10:30:09,901 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:10.423693559Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:10.423702529Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:10.423710051Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:10.423718593Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:10.423726721Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:12.446143082Z [inf]  2025-10-28 10:30:11,902 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:12.446154329Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:12.446163230Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:12.446174142Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:12.446181864Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:12.446189140Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:14.399177195Z [inf]  2025-10-28 10:30:13,904 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:30:14.399182814Z [inf]  Traceback (most recent call last):
2025-10-28T10:30:14.403368014Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:30:14.403383539Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:30:14.403391242Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:30:14.403398657Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'