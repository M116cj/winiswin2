2025-11-03T05:16:16.374542247Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.374547262Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.374552626Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.374562816Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.374564389Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.374577945Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.374578645Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.374588010Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.374594439Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.374601318Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.374607882Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.374614018Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.374620017Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.374626396Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.376593114Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.376601778Z [inf]  KeyError: 5
2025-11-03T05:16:16.376607141Z [inf]  2025-11-03 05:16:11,749 - src.core.unified_scheduler - INFO - üîç Êï∏ÊìöË®∫Êñ∑ #2 - ETHUSDT:
2025-11-03T05:16:16.376614035Z [inf]  2025-11-03 05:16:11,749 - src.core.unified_scheduler - INFO -    1h: 50Ë°å, Âàó=['open', 'high', 'low', 'close', 'volume']...
2025-11-03T05:16:16.376620453Z [inf]  2025-11-03 05:16:11,749 - src.core.unified_scheduler - INFO -       ÊúÄÊñ∞ÂÉπÊ†º: 3762.52
2025-11-03T05:16:16.376627260Z [inf]  2025-11-03 05:16:11,749 - src.core.unified_scheduler - INFO -    15m: 50Ë°å, Âàó=['open', 'high', 'low', 'close', 'volume']...
2025-11-03T05:16:16.376632708Z [inf]  2025-11-03 05:16:11,749 - src.core.unified_scheduler - INFO -       ÊúÄÊñ∞ÂÉπÊ†º: 3761.81
2025-11-03T05:16:16.376638045Z [inf]  2025-11-03 05:16:11,749 - src.core.unified_scheduler - INFO -    5m: 50Ë°å, Âàó=['open', 'high', 'low', 'close', 'volume']...
2025-11-03T05:16:16.376642987Z [inf]  2025-11-03 05:16:11,749 - src.core.unified_scheduler - INFO -       ÊúÄÊñ∞ÂÉπÊ†º: 3762.52
2025-11-03T05:16:16.376650948Z [inf]  2025-11-03 05:16:11,749 - src.strategies.rule_based_signal_generator - INFO - ‚úÖ ETHUSDT Êï∏ÊìöÈ©óË≠âÈÄöÈÅé (#2)
2025-11-03T05:16:16.376655947Z [inf]  2025-11-03 05:16:11,749 - src.strategies.rule_based_signal_generator - INFO -    1hÊï∏Êìö: 50Ë°å, ÊúÄÊñ∞Êî∂Áõ§=3762.52
2025-11-03T05:16:16.376663444Z [inf]  2025-11-03 05:16:11,749 - src.strategies.rule_based_signal_generator - INFO -    15mÊï∏Êìö: 50Ë°å, ÊúÄÊñ∞Êî∂Áõ§=3761.81
2025-11-03T05:16:16.376668043Z [inf]  2025-11-03 05:16:11,749 - src.strategies.rule_based_signal_generator - INFO -    5mÊï∏Êìö: 50Ë°å, ÊúÄÊñ∞Êî∂Áõ§=3762.52
2025-11-03T05:16:16.376673029Z [inf]  2025-11-03 05:16:11,753 - src.strategies.rule_based_signal_generator - INFO -    üîß ÊäÄË°ìÊåáÊ®ôË®àÁÆó: 7ÂÄãÊàêÂäü
2025-11-03T05:16:16.376677979Z [inf]  2025-11-03 05:16:11,753 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ ema_20: 50ÂÄãÂÄº
2025-11-03T05:16:16.378602212Z [inf]  2025-11-03 05:16:11,753 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ ema_50: 50ÂÄãÂÄº
2025-11-03T05:16:16.378610995Z [inf]  
2025-11-03T05:16:16.378611196Z [inf]  2025-11-03 05:16:11,753 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ rsi_14: 50ÂÄãÂÄº
2025-11-03T05:16:16.378617665Z [inf]  2025-11-03 05:16:11,753 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ sma_10: 50ÂÄãÂÄº
2025-11-03T05:16:16.378623274Z [inf]  2025-11-03 05:16:11,777 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ETHUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.378629869Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.378629874Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.378636868Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.378641311Z [inf]  
2025-11-03T05:16:16.378643366Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.378651424Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.378651648Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.378657690Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.378664669Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.378664751Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.378672264Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.378677239Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.378682837Z [inf]  KeyError: 5
2025-11-03T05:16:16.380621774Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.380639334Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.380646858Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.380654067Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.380656282Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.380664223Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.380664514Z [inf]  KeyError: 5
2025-11-03T05:16:16.380670370Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.380673244Z [inf]  2025-11-03 05:16:11,778 - src.core.unified_scheduler - INFO - üîç Êï∏ÊìöË®∫Êñ∑ #3 - BCHUSDT:
2025-11-03T05:16:16.380678223Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.380710163Z [inf]  2025-11-03 05:16:11,778 - src.core.unified_scheduler - INFO -    1h: 50Ë°å, Âàó=['open', 'high', 'low', 'close', 'volume']...
2025-11-03T05:16:16.380719325Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.380725479Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.380731318Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.380736495Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.380741761Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.380746754Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.380751978Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.380757156Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.382426800Z [inf]  2025-11-03 05:16:11,778 - src.core.unified_scheduler - INFO -       ÊúÄÊñ∞ÂÉπÊ†º: 533.84
2025-11-03T05:16:16.382440631Z [inf]  2025-11-03 05:16:11,778 - src.core.unified_scheduler - INFO -    15m: 50Ë°å, Âàó=['open', 'high', 'low', 'close', 'volume']...
2025-11-03T05:16:16.382446960Z [inf]  2025-11-03 05:16:11,778 - src.core.unified_scheduler - INFO -       ÊúÄÊñ∞ÂÉπÊ†º: 533.91
2025-11-03T05:16:16.382453939Z [inf]  2025-11-03 05:16:11,778 - src.core.unified_scheduler - INFO -    5m: 50Ë°å, Âàó=['open', 'high', 'low', 'close', 'volume']...
2025-11-03T05:16:16.382459838Z [inf]  2025-11-03 05:16:11,778 - src.core.unified_scheduler - INFO -       ÊúÄÊñ∞ÂÉπÊ†º: 533.87
2025-11-03T05:16:16.382466153Z [inf]  2025-11-03 05:16:11,778 - src.strategies.rule_based_signal_generator - INFO - ‚úÖ BCHUSDT Êï∏ÊìöÈ©óË≠âÈÄöÈÅé (#3)
2025-11-03T05:16:16.382471610Z [inf]  2025-11-03 05:16:11,778 - src.strategies.rule_based_signal_generator - INFO -    1hÊï∏Êìö: 50Ë°å, ÊúÄÊñ∞Êî∂Áõ§=533.84
2025-11-03T05:16:16.382476752Z [inf]  2025-11-03 05:16:11,778 - src.strategies.rule_based_signal_generator - INFO -    15mÊï∏Êìö: 50Ë°å, ÊúÄÊñ∞Êî∂Áõ§=533.91
2025-11-03T05:16:16.382482913Z [inf]  2025-11-03 05:16:11,778 - src.strategies.rule_based_signal_generator - INFO -    5mÊï∏Êìö: 50Ë°å, ÊúÄÊñ∞Êî∂Áõ§=533.87
2025-11-03T05:16:16.382489899Z [inf]  2025-11-03 05:16:11,780 - src.strategies.rule_based_signal_generator - INFO -    üîß ÊäÄË°ìÊåáÊ®ôË®àÁÆó: 7ÂÄãÊàêÂäü
2025-11-03T05:16:16.382494648Z [inf]  2025-11-03 05:16:11,781 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ ema_20: 50ÂÄãÂÄº
2025-11-03T05:16:16.382499927Z [inf]  2025-11-03 05:16:11,781 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ ema_50: 50ÂÄãÂÄº
2025-11-03T05:16:16.382505627Z [inf]  2025-11-03 05:16:11,781 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ rsi_14: 50ÂÄãÂÄº
2025-11-03T05:16:16.382512902Z [inf]  2025-11-03 05:16:11,781 - src.strategies.rule_based_signal_generator - INFO -      ‚úÖ sma_10: 50ÂÄãÂÄº
2025-11-03T05:16:16.384576130Z [inf]  2025-11-03 05:16:11,801 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå BCHUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.384588209Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.384591205Z [inf]  
2025-11-03T05:16:16.384598913Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.384606948Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.384613644Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.384617483Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.384625309Z [inf]  
2025-11-03T05:16:16.384628798Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.384636865Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.384640471Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.384650663Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.384652501Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.384661823Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.384663658Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.384673114Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.384674432Z [inf]  KeyError: 5
2025-11-03T05:16:16.384697002Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.384704740Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.386549085Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.386561353Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.386568430Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.386574232Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.386581441Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.386587588Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.386596168Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.386602949Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.386608166Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.386614655Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.386620804Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.386626599Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.386633294Z [inf]  KeyError: 5
2025-11-03T05:16:16.386639476Z [inf]  2025-11-03 05:16:11,825 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå XRPUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.386645227Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.386650804Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.386657782Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.386664603Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.386671804Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.386677400Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.388560678Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.388562840Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.388576727Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.388580099Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.388589236Z [inf]  KeyError: 5
2025-11-03T05:16:16.388594317Z [inf]  
2025-11-03T05:16:16.388598965Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.388605206Z [inf]  
2025-11-03T05:16:16.388610407Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.388616669Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.388621915Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.388627050Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.388632778Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.388638203Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.388643589Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.388653851Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.388658204Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.388662579Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.388667071Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.388672249Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.390791871Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.390804500Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.390813088Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.390820607Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.390829490Z [inf]  KeyError: 5
2025-11-03T05:16:16.390837448Z [inf]  2025-11-03 05:16:11,851 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå LTCUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.390844982Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.390852510Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.390859284Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.390868767Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.390877323Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.390883818Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.390893183Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.390898945Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.390905037Z [inf]  KeyError: 5
2025-11-03T05:16:16.390911434Z [inf]  
2025-11-03T05:16:16.390918257Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.390923885Z [inf]  
2025-11-03T05:16:16.390928949Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.390934030Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.393234410Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.393236656Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.393248460Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.393259040Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.393262801Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.393269748Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.393278688Z [inf]  KeyError: 5
2025-11-03T05:16:16.393283085Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.393293414Z [inf]  2025-11-03 05:16:11,876 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå TRXUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.393297549Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.393305614Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.393311846Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.393316437Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.393323076Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.393329490Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.393336419Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.393344407Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.393351530Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.393360005Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.393367703Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.395965388Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.395972077Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.395973283Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.395979059Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.395983825Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.395991555Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.395995851Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.396000574Z [inf]  KeyError: 5
2025-11-03T05:16:16.396005822Z [inf]  
2025-11-03T05:16:16.396009784Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.396013950Z [inf]  
2025-11-03T05:16:16.396019500Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.396026109Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.396030745Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.396036106Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.396040051Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.396043804Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.396047715Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.396053121Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.397956812Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.397961416Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.397970924Z [inf]  KeyError: 5
2025-11-03T05:16:16.397975322Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.397980753Z [inf]  2025-11-03 05:16:11,904 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ETCUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.397983385Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.397989039Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.397989583Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.397995531Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.397998390Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.398001139Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.398007430Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.398008339Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.398015079Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.398016660Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.398020083Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.398031718Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.398044147Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.398052045Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.399931324Z [inf]  KeyError: 5
2025-11-03T05:16:16.399943165Z [inf]  
2025-11-03T05:16:16.399961424Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.399970320Z [inf]  
2025-11-03T05:16:16.399976999Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.399983236Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.399993390Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.400003520Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.400009814Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.400016415Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.400023130Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.400029353Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.400036769Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.400043718Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.400049820Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.400055468Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.400061932Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.400069207Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.400075912Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.400082807Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.400089828Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.402146567Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.402158950Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.402164967Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.402172791Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.402176997Z [inf]  KeyError: 5
2025-11-03T05:16:16.402182340Z [inf]  2025-11-03 05:16:11,927 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå LINKUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.402189454Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.402196253Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.402203702Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.402208181Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.402212931Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.402218078Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.402223940Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.402230090Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.402234625Z [inf]  KeyError: 5
2025-11-03T05:16:16.402239120Z [inf]  
2025-11-03T05:16:16.402245403Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.402252161Z [inf]  
2025-11-03T05:16:16.402258378Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.402263409Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.404119998Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.404147399Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.404155265Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.404162404Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.404169400Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.404176455Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.404182594Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.404188325Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.404194564Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.404205817Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.404211570Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.404222019Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.404227449Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.404231428Z [inf]  KeyError: 5
2025-11-03T05:16:16.404235817Z [inf]  2025-11-03 05:16:11,952 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå XLMUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.404241717Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.404246800Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.404251446Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.404256053Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.404261209Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.406285183Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.406318674Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.406327430Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.406335538Z [inf]  KeyError: 5
2025-11-03T05:16:16.406343295Z [inf]  
2025-11-03T05:16:16.406351816Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.406359518Z [inf]  
2025-11-03T05:16:16.406366447Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.406373201Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.406382031Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.406388475Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.406394259Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.406406024Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.406412653Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.406419053Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.406425620Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.406432890Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.406439313Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.406447869Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.408271835Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.408281983Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.408289672Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.408298207Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.408304617Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.408313024Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.408321442Z [inf]  KeyError: 5
2025-11-03T05:16:16.408329412Z [inf]  2025-11-03 05:16:11,977 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ADAUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.408338777Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.408347120Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.408354150Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.408364496Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.408371332Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.408380080Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.408387235Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.408394964Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.408416888Z [inf]  KeyError: 5
2025-11-03T05:16:16.408424345Z [inf]  
2025-11-03T05:16:16.408432934Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.408441200Z [inf]  
2025-11-03T05:16:16.410373200Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.410383281Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.410391979Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.410399090Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.410405102Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.410413881Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.410421339Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.410426570Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.410432312Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.410438341Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.410444635Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.410593244Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.410601004Z [inf]  KeyError: 5
2025-11-03T05:16:16.410610344Z [inf]  2025-11-03 05:16:11,998 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå XMRUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.410619691Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.410631463Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.410631612Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.410639706Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.410647327Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.410653438Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.413281718Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.413300012Z [inf]  
2025-11-03T05:16:16.413305287Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.413313666Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.413323843Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.413327149Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.413334249Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.413341106Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.413349615Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.413353355Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.413359580Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.413368125Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.413376783Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.413386401Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.413395380Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.413403811Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.413412001Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.413420099Z [inf]  KeyError: 5
2025-11-03T05:16:16.413429283Z [inf]  
2025-11-03T05:16:16.415776418Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.415788708Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.415797471Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.415807453Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.415814212Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.415821279Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.415827576Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.415833547Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.415839945Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.415849710Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.415856484Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.415864396Z [inf]  KeyError: 5
2025-11-03T05:16:16.415872202Z [inf]  2025-11-03 05:16:12,047 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ZECUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.415878750Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.415885549Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.415892106Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.415899483Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.415906183Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.415913368Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.415921412Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.417392982Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.417397829Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.417402149Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.417408998Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.417411705Z [inf]  KeyError: 5
2025-11-03T05:16:16.417417977Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.417418338Z [inf]  
2025-11-03T05:16:16.417424154Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.417426497Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.417431546Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.417434402Z [inf]  
2025-11-03T05:16:16.417438654Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.417441685Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.417444705Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.417449236Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.417451655Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.417455934Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.417459354Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.417465212Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.417471306Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.418951544Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.418952274Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.418959607Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.418961923Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.418966167Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.418969551Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.418973084Z [inf]  KeyError: 5
2025-11-03T05:16:16.418978286Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.418979629Z [inf]  2025-11-03 05:16:12,072 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå XTZUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.418987198Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.418988874Z [inf]  KeyError: 5
2025-11-03T05:16:16.418994324Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.418996601Z [inf]  
2025-11-03T05:16:16.419002480Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.419004743Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.419008701Z [inf]  
2025-11-03T05:16:16.419011850Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.419015199Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.419021412Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.419026544Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.420880987Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.420890518Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.420890734Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.420899418Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.420900556Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.420906039Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.420912185Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.420919006Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.420926586Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.420933948Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.420940501Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.420946175Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.420968231Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.420985730Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.420999404Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.421008056Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.421017006Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.421026634Z [inf]  KeyError: 5
2025-11-03T05:16:16.421037802Z [inf]  2025-11-03 05:16:12,102 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå BNBUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.423024587Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.423037332Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.423045043Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.423051865Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.423059601Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.423067780Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.423073560Z [inf]  KeyError: 5
2025-11-03T05:16:16.423079591Z [inf]  
2025-11-03T05:16:16.423086417Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.423094624Z [inf]  
2025-11-03T05:16:16.423101068Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.423106771Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.423114400Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.423120570Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.423125149Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.423131640Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.423137638Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.423144013Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.423152575Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.424731569Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.424742635Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.424749711Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.424755804Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.424762814Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.424769531Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.424774339Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.424780587Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.424786887Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.424792525Z [inf]  KeyError: 5
2025-11-03T05:16:16.424798149Z [inf]  2025-11-03 05:16:12,126 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ATOMUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.424803447Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.424808719Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.424814315Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.424820218Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.424825452Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.424830062Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.424835398Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.424840426Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.428036598Z [inf]  KeyError: 5
2025-11-03T05:16:16.428046108Z [inf]  
2025-11-03T05:16:16.428053592Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.428060436Z [inf]  
2025-11-03T05:16:16.428066825Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.428079112Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.428086455Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.428093064Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.428098951Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.430659701Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.433119770Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.433131050Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.435794075Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.437789784Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.439853226Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.442603874Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.444328263Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.446519300Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.448432802Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.450880922Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.453109816Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.453125925Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.455335775Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.457342533Z [inf]  KeyError: 5
2025-11-03T05:16:16.459565748Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.461290803Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.463650287Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.465989267Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.468228852Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.470502898Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.472518694Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.475650219Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.475665548Z [inf]  KeyError: 5
2025-11-03T05:16:16.477215833Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.479165773Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.487617515Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.487629869Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.487638504Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.487651622Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.489547725Z [inf]  KeyError: 5
2025-11-03T05:16:16.491512484Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.493305278Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.495236770Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.500272578Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.500285861Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.502698130Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.505118245Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.505130107Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.507170948Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.510238793Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.515014321Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.515033491Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.517246043Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.517258725Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.525794982Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.525803518Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.525810391Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.525824598Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.527733448Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.529967525Z [inf]  KeyError: 5
2025-11-03T05:16:16.531788592Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.533979210Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.535362174Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.537804828Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.540061477Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.542096280Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.543588076Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.545824785Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.547664806Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.549764437Z [inf]  KeyError: 5
2025-11-03T05:16:16.551709010Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.553677249Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.555615164Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.558598728Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.562643104Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.562655081Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.565264077Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.565283509Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.567463871Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.570718872Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.573493807Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.573503811Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.575228557Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.577667315Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.580176419Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.582614876Z [inf]  KeyError: 5
2025-11-03T05:16:16.585147798Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.585156279Z [inf]  KeyError: 5
2025-11-03T05:16:16.588146198Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.589888408Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.591938046Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.593978459Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.596419483Z [inf]  2025-11-03 05:16:13,407 - src.core.elite.unified_data_pipeline - INFO - ‚úÖ ÊâπÈáèÊï∞ÊçÆËé∑ÂèñÂÆåÊàê: 64‰∏™symbols | ÊàêÂäü64 | Â§±Ë¥•0 | ËÄóÊó∂0.10Áßí | Âπ≥Âùá1.6ms/symbol
2025-11-03T05:16:16.598693933Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.600566845Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.602748402Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.605277007Z [inf]  KeyError: 5
2025-11-03T05:16:16.605283546Z [inf]  
2025-11-03T05:16:16.607638260Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.611273098Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.611282646Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.613688891Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.966300023Z [inf]  2025-11-03 05:16:13,549 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ALICEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.966313433Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.966320507Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.966322369Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.966326339Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.966329677Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.966333676Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.966337608Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.966340406Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.966345694Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.966348018Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.966354593Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.966355414Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.966360227Z [inf]  KeyError: 5
2025-11-03T05:16:16.966361571Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.966371332Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.966377885Z [inf]  KeyError: 5
2025-11-03T05:16:16.966384043Z [inf]  
2025-11-03T05:16:16.966390402Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.966395022Z [inf]  
2025-11-03T05:16:16.970005849Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.970019055Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.970025599Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.970031784Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.970036987Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.970042377Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.970048259Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.970052863Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.970058396Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.970064899Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.970070559Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.970075754Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.970081433Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.970088073Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.970093738Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.970099717Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.970104855Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.970110907Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.970116347Z [inf]  KeyError: 5
2025-11-03T05:16:16.970122090Z [inf]  2025-11-03 05:16:13,570 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå HBARUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.970345278Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.970352739Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.970357718Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.970362733Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.970367140Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.970372447Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.970379581Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.970384560Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.970389822Z [inf]  KeyError: 5
2025-11-03T05:16:16.970399098Z [inf]  
2025-11-03T05:16:16.970405570Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.970410376Z [inf]  
2025-11-03T05:16:16.970413902Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.970417710Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.970421766Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.970425450Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.970429259Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.970433027Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.970437035Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.972072436Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.972072728Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.972082024Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.972083817Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.972089347Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.972092233Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.972096855Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.972100236Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.972106133Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.972107639Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.972113840Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.972116931Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.972120880Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.972126436Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.972131959Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.972137292Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.972143041Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.972148387Z [inf]  KeyError: 5
2025-11-03T05:16:16.972153354Z [inf]  2025-11-03 05:16:13,594 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ONEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.972158647Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.974130345Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.974137091Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.974139514Z [inf]  KeyError: 5
2025-11-03T05:16:16.974145974Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.974147636Z [inf]  
2025-11-03T05:16:16.974152242Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.974156325Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.974163402Z [inf]  
2025-11-03T05:16:16.974165477Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.974170872Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.974172478Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.974180581Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.974180728Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.974187503Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.974189167Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.974194945Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.974200777Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.974206854Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.974212478Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.974217962Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.976155767Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.976163236Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.976170161Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.976172333Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.976178995Z [inf]  KeyError: 5
2025-11-03T05:16:16.976183143Z [inf]  KeyError: 5
2025-11-03T05:16:16.976186027Z [inf]  2025-11-03 05:16:13,617 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå DENTUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.976192162Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.976193539Z [inf]  
2025-11-03T05:16:16.976198783Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.976203125Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.976206031Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.976211458Z [inf]  
2025-11-03T05:16:16.976213684Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.976219805Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.976220754Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.976228548Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.976228650Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.976237455Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.976237887Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.977903638Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.977906449Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.977909544Z [inf]  2025-11-03 05:16:13,640 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå CELRUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.977913751Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.977914041Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.977920293Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.977921723Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.977922423Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.977924757Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.977929999Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.977930582Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.977930679Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.977936363Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.977937778Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.977938594Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.977945063Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.977946289Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.977950049Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.977954164Z [inf]  KeyError: 5
2025-11-03T05:16:16.979759649Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.979768719Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.979774774Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.979780983Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.979792077Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.979799055Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.979805272Z [inf]  KeyError: 5
2025-11-03T05:16:16.979810449Z [inf]  
2025-11-03T05:16:16.979815950Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.979821610Z [inf]  
2025-11-03T05:16:16.979827009Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.979834110Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.979839325Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.979844078Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.979850410Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.979856557Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.979861657Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.979867318Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.979872666Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:16.981560596Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.981570739Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:16.981578929Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:16.981584878Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.981590798Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:16.981596763Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:16.981601817Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.981607393Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:16.981612757Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.981618622Z [inf]  KeyError: 5
2025-11-03T05:16:16.981624120Z [inf]  2025-11-03 05:16:13,663 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå HOTUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:16.981630695Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.981636165Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:16.981641998Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:16.981647447Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.981653018Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.981658264Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.981663942Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.981669324Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:16.983609383Z [inf]  KeyError: 5
2025-11-03T05:16:16.983619749Z [inf]  
2025-11-03T05:16:16.983627558Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:16.983634004Z [inf]  
2025-11-03T05:16:16.983640133Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.983648877Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:16.983654758Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:16.983661805Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:16.983667077Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:16.985181382Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:16.987640130Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:16.989465652Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:16.991629540Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:16.993630350Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.995789649Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:16.997868128Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:16.999748056Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.002005754Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.004166778Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.006483603Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.009130006Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.009138272Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:17.011068837Z [inf]  KeyError: 5
2025-11-03T05:16:17.013230618Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.015002039Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.018135201Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.019990052Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.023242014Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.023251372Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:17.025737077Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.028395971Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.030823571Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.033711861Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.033719192Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:17.036033713Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.038706719Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.042377855Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.042386942Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:17.045895653Z [inf]  KeyError: 5
2025-11-03T05:16:17.045902464Z [inf]  
2025-11-03T05:16:17.048887337Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.051336732Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.051343971Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.054650620Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.056896803Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.059572564Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.059585821Z [inf]  KeyError: 5
2025-11-03T05:16:17.062116928Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.065950087Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.065960244Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:17.068029984Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.070651792Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.073554007Z [inf]  KeyError: 5
2025-11-03T05:16:17.073579459Z [inf]  
2025-11-03T05:16:17.075702390Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.077765360Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.079921826Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.082445734Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.085498685Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.085508316Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:17.089291029Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.089296369Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:17.091345998Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.093288979Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.095633011Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.097118978Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.100453113Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.102438718Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.105195774Z [inf]  KeyError: 5
2025-11-03T05:16:17.105206067Z [inf]  
2025-11-03T05:16:17.109273133Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.109285921Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.110990404Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.113146292Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.115238166Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.117002954Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.119168459Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.121136110Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.123379255Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.125187833Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.128384166Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.131676814Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.131689667Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:17.133539225Z [inf]  KeyError: 5
2025-11-03T05:16:17.135619089Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.140749191Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.140758491Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.143403916Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.143411581Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.145473742Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.147395582Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.149219834Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.151909204Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.154184673Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.156111171Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.158464206Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.160451560Z [inf]  2025-11-03 05:16:15,380 - src.core.unified_scheduler - INFO - ‚è±Ô∏è  ÊâπÊ¨° 3: 64‰∏™symbolsÊï∞ÊçÆËé∑ÂèñÂÆåÊàêÔºåËÄóÊó∂0.49Áßí
2025-11-03T05:16:17.162757325Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.165836841Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.165845313Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.168305068Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.170725725Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.173280217Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.173296429Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:17.175698318Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.177974435Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.179821426Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.181638189Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.183556730Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.185365977Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.187324137Z [inf]  KeyError: 5
2025-11-03T05:16:17.189556027Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.192297555Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.195344981Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.195355299Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.197223875Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.199263064Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.202110396Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.203728306Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.205806344Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.207768100Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.209890963Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.211719044Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.214008237Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.217487863Z [inf]  KeyError: 5
2025-11-03T05:16:17.217499467Z [inf]  
2025-11-03T05:16:17.222159383Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.222166438Z [inf]  KeyError: 5
2025-11-03T05:16:17.223935306Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.226472875Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.228925227Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.228982238Z [inf]  KeyError: 5
2025-11-03T05:16:17.233362091Z [inf]  2025-11-03 05:16:15,805 - src.strategies.rule_based_signal_generator - INFO -    Stage1È©óË≠â: ÊúâÊïà=149, ÊãíÁµï=0
2025-11-03T05:16:17.233370262Z [inf]  2025-11-03 05:16:15,805 - src.strategies.rule_based_signal_generator - INFO -    Stage3ÊñπÂêë: Êúâ=130, ÁÑ°=19
2025-11-03T05:16:17.236281746Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:17.238420752Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.239633380Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:17.241277515Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:17.243295742Z [inf]  KeyError: 5
2025-11-03T05:16:17.245467889Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.247170450Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.249183285Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:17.251356942Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:17.253288131Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.255090219Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.258292043Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.259814849Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.261496910Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.264745092Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.266302191Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.268601506Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.270656140Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.271872292Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.273374550Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.275010218Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.278391426Z [inf]  KeyError: 5
2025-11-03T05:16:17.279622414Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.281430217Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.283750292Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.285449082Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.287028833Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.290279182Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.292095791Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.294964667Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.295034229Z [inf]  
2025-11-03T05:16:17.297832862Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.299567059Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.302463010Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.304154511Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.305849118Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.307213624Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.309316688Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.313822348Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.313840182Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:17.315524449Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.317101214Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.319106950Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.321038826Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.324259256Z [inf]  KeyError: 5
2025-11-03T05:16:17.326736158Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.328474848Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.330466018Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.332589957Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.334371599Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.335838335Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.337660161Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.341519142Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.341525251Z [inf]  KeyError: 5
2025-11-03T05:16:17.343266624Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.345070775Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.349552718Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.349558930Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:17.351840015Z [inf]  KeyError: 5
2025-11-03T05:16:17.353421649Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.355980979Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.358120477Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.359869505Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.361401929Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.363530897Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:17.365479984Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:17.367289506Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.371002033Z [inf]  KeyError: 5
2025-11-03T05:16:17.371015452Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:17.374875907Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.377374648Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.377380453Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.380344908Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.381858693Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.383685916Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.385819639Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.387446232Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.389115712Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.391320877Z [inf]  KeyError: 5
2025-11-03T05:16:17.393070259Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.395532211Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.397366430Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.399606911Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.401385138Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.403506628Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.405644493Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.408047718Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.410224469Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.412322610Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.414554635Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.416427201Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.418536632Z [inf]  KeyError: 5
2025-11-03T05:16:17.420421137Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.422548904Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.424803293Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.426930269Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.428934206Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.430930925Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.433554985Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.433564385Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:17.435220736Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.437655566Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.439760485Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.441543939Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:17.443343029Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.445447133Z [inf]  KeyError: 5
2025-11-03T05:16:17.447653892Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:17.449699651Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:17.451435011Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:17.453322406Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:17.456080814Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.458156208Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:17.460299121Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:17.461756663Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:17.463595088Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:17.465564669Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.231344113Z [inf]  2025-11-03 05:16:18,227 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå SCRUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.231356579Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.231364897Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.231372192Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.231378923Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.231386615Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.231392740Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.231398113Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.231404396Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.233823565Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.251198972Z [inf]  2025-11-03 05:16:18,247 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå GOATUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.251211439Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.251220132Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.251232339Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.251240507Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.251248513Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.251256097Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.251263563Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.251271822Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.281179868Z [inf]  2025-11-03 05:16:18,269 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå MOODENGUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.281195157Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.281202860Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.281210076Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.281216245Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.281223577Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.281230268Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.281238751Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.281247907Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.281256912Z [inf]  KeyError: 5
2025-11-03T05:16:18.281263182Z [inf]  
2025-11-03T05:16:18.281269031Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:18.281274647Z [inf]  
2025-11-03T05:16:18.281280562Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.281285964Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:18.297604497Z [inf]  2025-11-03 05:16:18,292 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå SAFEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.297618470Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.297626459Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.297635903Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.297643781Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.297656360Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.297663352Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.297669408Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.300323630Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.326504524Z [inf]  2025-11-03 05:16:18,313 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå SANTOSUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.326512071Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.326519144Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.326528897Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.326536743Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.326544769Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.326552554Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.326560342Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.326568190Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.326575939Z [inf]  KeyError: 5
2025-11-03T05:16:18.326582876Z [inf]  
2025-11-03T05:16:18.326589176Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:18.326596344Z [inf]  
2025-11-03T05:16:18.328594573Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.339704297Z [inf]  2025-11-03 05:16:18,335 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå PONKEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.339714186Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.339723185Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.339733279Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.339742707Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.339751547Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.342119668Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.364070963Z [inf]  2025-11-03 05:16:18,357 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå COWUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.364086096Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.364094104Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.364100634Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.364108488Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.364116296Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.364123997Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.364131138Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.364138700Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.364146293Z [inf]  KeyError: 5
2025-11-03T05:16:18.364154041Z [inf]  
2025-11-03T05:16:18.365582198Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.380621172Z [inf]  2025-11-03 05:16:18,376 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå CETUSUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.380636776Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.380645646Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.380653979Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.380666350Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.380673746Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.380735949Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.382371893Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.409280532Z [inf]  2025-11-03 05:16:18,399 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå 1000000MOGUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.409298434Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.409307801Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:18.409317615Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:18.409325453Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:18.409334880Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.409343600Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:18.409350478Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.409360628Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:18.409369907Z [inf]  KeyError: 5
2025-11-03T05:16:18.409378661Z [inf]  
2025-11-03T05:16:18.409386594Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:18.409393892Z [inf]  
2025-11-03T05:16:18.409401884Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.425067426Z [inf]  2025-11-03 05:16:18,419 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå GRASSUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:18.425085382Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:18.468917464Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.230055477Z [inf]  2025-11-03 05:16:19,225 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå CGPTUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.230062588Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.230074074Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.230080393Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.230086558Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.230094813Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.230101398Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.230108217Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.230114371Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.231444503Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.262209400Z [inf]  2025-11-03 05:16:19,245 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå HIVEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.262219031Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.262224241Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.262229963Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.262235308Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.262242645Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.262248357Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.262253229Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.262258529Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.262263628Z [inf]  KeyError: 5
2025-11-03T05:16:19.262270643Z [inf]  
2025-11-03T05:16:19.262278557Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:19.262286424Z [inf]  
2025-11-03T05:16:19.262293663Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.262298986Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:19.263947180Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.274499611Z [inf]  2025-11-03 05:16:19,267 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå DEXEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.274506516Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.274513349Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.274521067Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.274529167Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.275915102Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.291792964Z [inf]  2025-11-03 05:16:19,286 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå PHAUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.291808021Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.291817578Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.291825912Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.291833426Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.291842405Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.291853437Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.291861552Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.294402525Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.310521588Z [inf]  2025-11-03 05:16:19,307 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå DFUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.310534937Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.310542364Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.310553300Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.310560140Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.310567305Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.310575005Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.310580763Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.312577397Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.360279130Z [inf]  2025-11-03 05:16:19,330 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå GRIFFAINUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.360287464Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.360294049Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.360299017Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.360303099Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.360307892Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.360312450Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.360316390Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.360321715Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.360327648Z [inf]  KeyError: 5
2025-11-03T05:16:19.360332222Z [inf]  
2025-11-03T05:16:19.360337153Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:19.360341504Z [inf]  
2025-11-03T05:16:19.360346484Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.360352187Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:19.360356525Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:19.360360805Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.360365539Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:19.360369911Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:19.362777353Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.362791638Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:19.362800487Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:19.362808213Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.362815264Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:19.362825893Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:19.364848625Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.366610587Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:19.374907892Z [inf]  2025-11-03 05:16:19,371 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ZEREBROUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.374925121Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.374935299Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.374943801Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.377087048Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.377093542Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:19.407480795Z [inf]  2025-11-03 05:16:19,394 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå BIOUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:19.407490429Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.407498263Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:19.407507864Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:19.407516597Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.407526072Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.407537107Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:19.407544817Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.407552654Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:19.407561102Z [inf]  KeyError: 5
2025-11-03T05:16:19.407569596Z [inf]  
2025-11-03T05:16:19.407577545Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:19.407584073Z [inf]  
2025-11-03T05:16:19.407591059Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:19.407599096Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:19.409044733Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:19.424400652Z [inf]  2025-11-03 05:16:19,418 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå COOKIEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:20.404939556Z [inf]  2025-11-03 05:16:20,396 - src.core.elite.unified_data_pipeline - INFO - ‚úÖ ÊâπÈáèÊï∞ÊçÆËé∑ÂèñÂÆåÊàê: 64‰∏™symbols | ÊàêÂäü64 | Â§±Ë¥•0 | ËÄóÊó∂0.88Áßí | Âπ≥Âùá13.8ms/symbol
2025-11-03T05:16:20.404947367Z [inf]  2025-11-03 05:16:20,397 - src.core.unified_scheduler - INFO - ‚è±Ô∏è  ÊâπÊ¨° 6: 64‰∏™symbolsÊï∞ÊçÆËé∑ÂèñÂÆåÊàêÔºåËÄóÊó∂0.88Áßí
2025-11-03T05:16:20.420972741Z [inf]  2025-11-03 05:16:20,413 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå PROMUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:20.420984257Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.420994692Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:20.421002118Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:20.421008878Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.421016772Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.421023077Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.421029005Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.421036023Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.421044763Z [inf]  KeyError: 5
2025-11-03T05:16:20.421052923Z [inf]  
2025-11-03T05:16:20.421060514Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:20.421067557Z [inf]  
2025-11-03T05:16:20.421073523Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.421079873Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:20.421088401Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:20.421094885Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.421101386Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:20.421107551Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:20.422464700Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:20.422471181Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:20.422477222Z [inf]  KeyError: 5
2025-11-03T05:16:20.422483687Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.422494824Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:20.422503195Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:20.422510861Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.422518516Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:20.422527644Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:20.422537002Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:20.422544794Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:20.422551990Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:20.422560368Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.438421476Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.438434132Z [inf]  2025-11-03 05:16:20,430 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå SUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:20.438437914Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:20.438448930Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:20.438455039Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.438466638Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:20.438475028Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:20.438484629Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.438493255Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.438503037Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.438511995Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.438521514Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.438530385Z [inf]  KeyError: 5
2025-11-03T05:16:20.438541317Z [inf]  
2025-11-03T05:16:20.438550173Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:20.438559882Z [inf]  
2025-11-03T05:16:20.438569285Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.438578715Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:20.438587713Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:20.440771105Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:20.440788019Z [inf]  KeyError: 5
2025-11-03T05:16:20.440828808Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.440835789Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:20.440840454Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:20.440845352Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.440855423Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:20.440860874Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:20.440865883Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:20.440871414Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:20.440877045Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:20.440881989Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.440886560Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:20.476333457Z [inf]  2025-11-03 05:16:20,468 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå ARCUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:20.476336648Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:20.476345263Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.476351333Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.476356884Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:20.476363356Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:20.476366203Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:20.476373411Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:20.476376515Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.476384305Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.476391231Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.476398642Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.476405736Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.476412747Z [inf]  KeyError: 5
2025-11-03T05:16:20.476420545Z [inf]  
2025-11-03T05:16:20.476428203Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:20.476435542Z [inf]  
2025-11-03T05:16:20.476443049Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.476451741Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:20.478407584Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.478414830Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3819, in get_loc
2025-11-03T05:16:20.478418616Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:20.478427210Z [inf]      swings = ICTTools.find_swing_highs_lows(klines, lookback)
2025-11-03T05:16:20.478428818Z [inf]      raise KeyError(key) from err
2025-11-03T05:16:20.478435528Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.478438309Z [inf]  KeyError: 5
2025-11-03T05:16:20.478443872Z [inf]    File "/app/src/utils/ict_tools.py", line 35, in find_swing_highs_lows
2025-11-03T05:16:20.478450377Z [inf]      current_high = klines[i]['high']
2025-11-03T05:16:20.478457206Z [inf]                     ~~~~~~^^^
2025-11-03T05:16:20.478464230Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4113, in __getitem__
2025-11-03T05:16:20.478471462Z [inf]      indexer = self.columns.get_loc(key)
2025-11-03T05:16:20.478485579Z [inf]                ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.497074277Z [inf]  2025-11-03 05:16:20,487 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå AVAAIUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:20.497078970Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.497084898Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:20.497092289Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:20.497093777Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 431, in generate_signal
2025-11-03T05:16:20.497100682Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:20.497105188Z [inf]      ict_features = self.feature_engine._build_ict_smc_features(
2025-11-03T05:16:20.497109124Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.497114456Z [inf]                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.497117720Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.497123366Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:20.497125849Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:20.497132916Z [inf]      market_structure = ICTTools.calculate_market_structure(klines_1h) if self._is_valid_data(klines_1h) else 0
2025-11-03T05:16:20.497133576Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.497140338Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:20.497147041Z [inf]  KeyError: 5
2025-11-03T05:16:20.497152985Z [inf]  
2025-11-03T05:16:20.497158913Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:20.497165253Z [inf]  
2025-11-03T05:16:20.498785844Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:20.498798425Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:21.203432136Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.257689437Z [inf]  2025-11-03 05:16:21,248 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå BABYUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.257695878Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.257701914Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.257707559Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.257714095Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.257720540Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.257727342Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.257733052Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.259704945Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.267726287Z [inf]  2025-11-03 05:16:21,265 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå FORTHUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.267737847Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.267747925Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.267754690Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.269646333Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.287325041Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.287355885Z [inf]  2025-11-03 05:16:21,282 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå PROMPTUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.287362160Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.287367220Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.287371172Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.287377745Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.287386375Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.287392286Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.287397882Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.289753728Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.305112856Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.305132416Z [inf]  2025-11-03 05:16:21,297 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå XCNUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.305145614Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.305160465Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.305168933Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.305178023Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.305186935Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.305195886Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.334795611Z [inf]  2025-11-03 05:16:21,327 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå FHEUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.334810126Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.334816685Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.334823306Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.334830948Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.334837513Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.334848842Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.334854681Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.334859851Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.334865666Z [inf]  KeyError: 5
2025-11-03T05:16:21.334871807Z [inf]  
2025-11-03T05:16:21.334878162Z [inf]  The above exception was the direct cause of the following exception:
2025-11-03T05:16:21.334884025Z [inf]  
2025-11-03T05:16:21.334889650Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.336920752Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.352972822Z [inf]  2025-11-03 05:16:21,343 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå KERNELUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.352986338Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.352994754Z [inf]    File "/app/src/ml/feature_engine.py", line 412, in _build_ict_smc_features
2025-11-03T05:16:21.352995460Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.353002850Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.353015159Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.353022745Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.353029969Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.353037490Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.362989218Z [inf]  2025-11-03 05:16:21,360 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå WCTUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.362999992Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.363007126Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.363016529Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.365012898Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.365021627Z [inf]    File "/app/src/utils/ict_tools.py", line 76, in calculate_market_structure
2025-11-03T05:16:21.380952864Z [inf]  2025-11-03 05:16:21,377 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå INITUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.380964882Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.380974781Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.380982288Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.381004285Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.381010783Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.381017408Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.382878519Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.400133531Z [inf]  2025-11-03 05:16:21,396 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå AERGOUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.400145947Z [inf]  Traceback (most recent call last):
2025-11-03T05:16:21.400155310Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
2025-11-03T05:16:21.400163618Z [inf]      return self._engine.get_loc(casted_key)
2025-11-03T05:16:21.400171536Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.400179446Z [inf]    File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.400187125Z [inf]    File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
2025-11-03T05:16:21.400193727Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.400202835Z [inf]    File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
2025-11-03T05:16:21.402083125Z [inf]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-11-03T05:16:21.420284202Z [inf]  2025-11-03 05:16:21,417 - src.strategies.rule_based_signal_generator - ERROR - ‚ùå BANKUSDT: ICTÁâπÂæµÊßãÂª∫Â§±Êïó: 5
2025-11-03T05:16:21.420293469Z [inf]  Traceback (most recent call last):