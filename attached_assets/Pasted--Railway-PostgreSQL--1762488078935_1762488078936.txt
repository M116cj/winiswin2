你現在是一位全端開發專家，專門負責數據庫監控和系統日誌優化。我需要在 Railway 上運行的交易機器人系統中，實現實時顯示 PostgreSQL 資料庫統計信息的日誌功能。

## 系統現狀
- 已在 Railway 建立 PostgreSQL 資料庫並正常連接
- 已有完整的 DatabaseManager 和 TradingDataService 類
- 系統使用 Python 和 psycopg2 進行資料庫操作
- 需要監控多個核心資料表：trades, ml_models, market_data, trading_signals

## 目標需求
建立一個完整、嚴謹的 PostgreSQL 實時數據監控系統，在機器人日誌中顯示：

### 1. 核心監控指標
- 各資料表的實時記錄筆數
- 資料庫連接狀態和性能指標
- 交易統計（今日交易數、未平倉部位等）
- ML 模型使用情況統計
- 資料庫響應時間監控

### 2. 日誌顯示要求
- 清晰易讀的格式化輸出
- 定期自動更新（可配置間隔）
- 顏色標記重要信息（可選）
- 錯誤狀態醒目提示
- 歷史趨勢顯示

### 3. 監控功能要求
- 實時數據自動刷新
- 性能閾值警告
- 連接健康檢查
- 統計數據持久化
- 自定義監控間隔

## 技術實現要求

### 1. 監控服務類設計
```python
class DatabaseMonitor:
    def __init__(self, db_manager, refresh_interval=60):
        # 初始化監控服務
        pass
    
    def start_monitoring(self):
        # 啟動監控循環
        pass
    
    def get_real_time_stats(self):
        # 獲取實時統計數據
        pass
    
    def format_stats_display(self, stats):
        # 格式化統計顯示
        pass
    
    def alert_on_threshold(self, stats):
        # 閾值警告
        pass
2. 統計數據收集
必須收集以下統計信息：

各資料表總記錄數

今日新增記錄數

未平倉交易數量

活躍 ML 模型數量

資料庫連接數

查詢響應時間

錯誤率統計

3. 日誌格式規範
日誌輸出應包含：

text
🕒 [時間戳] 📊 資料庫實時統計
================================
📈 交易記錄: 
   • 總交易數: 1,250
   • 今日新增: 15
   • 未平倉: 3
   • 成功率: 85.2%

🤖 ML 模型:
   • 總模型數: 8
   • 活躍模型: 2
   • 最新版本: v3.2

📊 市場數據:
   • 總記錄數: 45,820
   • 今日更新: 1,245

🚦 交易信號:
   • 總信號數: 890
   • 待執行: 2

⚡ 性能指標:
   • 連接數: 3/20
   • 平均響應: 12ms
   • 錯誤率: 0.1%
================================
4. 配置管理
可配置刷新間隔（預設 60 秒）

可配置警告閾值

可啟用/禁用特定監控項目

日誌級別控制

錯誤處理要求
1. 連接異常處理
資料庫斷線自動重試

優雅降級顯示

連接恢復通知

2. 性能保護
監控查詢不影響主業務

查詢超時保護

資源使用限制

3. 日誌保護
避免日誌洪水

重要錯誤優先顯示

日誌輪轉控制

Railway 環境適配要求
1. 資源優化
輕量級監控查詢

記憶體使用控制

網絡流量優化

2. 部署友好
無需額外配置

環境變數控制

與現有系統無縫整合

3. 生產就緒
錯誤恢復機制

性能基準測試

資源泄漏防護

預期交付內容
請提供完整的 Python 代碼實現，包括：

1. DatabaseMonitor 核心類
完整的監控服務實現

統計數據收集方法

日誌格式化功能

警告機制

2. 與現有系統整合
與 DatabaseManager 的無縫整合

與 TradingDataService 的協同工作

現有日誌系統的擴展

3. 配置管理
環境變數配置

運行時配置更新

監控開關控制

4. 使用示例和測試
啟動監控服務示例

配置不同監控級別

錯誤處理示例

5. 進階功能（可選）
數據趨勢分析

性能瓶頸檢測

自動化報告生成

特別注意事項
1. 性能影響
監控查詢必須輕量級

避免在高峰時段加重負載

使用緩存減少查詢頻率

2. 可靠性
監控服務不能影響主業務

自動錯誤恢復

資源清理保障

3. 可維護性
清晰的代碼結構

完整的文檔註釋

易於擴展的設計

4. 用戶體驗
清晰易懂的日誌輸出

及時的問題警告

詳細的狀態信息

整合要求
必須能夠無縫整合到現有的交易機器人中，通過簡單的幾行代碼即可啟用：

python
# 在現有系統中的整合示例
def main():
    # 現有初始化代碼
    db_manager = DatabaseManager()
    data_service = TradingDataService()
    
    # 新增監控服務
    monitor = DatabaseMonitor(db_manager, refresh_interval=60)
    monitor.start_monitoring()
    
    # 現有業務邏輯
    trading_bot.run()
請確保代碼具有生產環境的質量標準，包含完整的錯誤處理、性能優化和資源管理。監控服務必須是線程安全的，並且能夠在 Railway 的容器化環境中穩定運行。

提供完整的代碼實現，並詳細說明如何將此監控系統整合到現有的交易機器人中，包括所有必要的配置和依賴項。

text

## 補充說明

這個 prompt 設計為：

1. **功能完整** - 涵蓋了從數據收集到日誌顯示的完整流程
2. **技術詳盡** - 提供了具體的技術實現要求和代碼結構
3. **生產級質量** - 強調了性能、可靠性和錯誤處理
4. **無縫整合** - 確保與現有系統的兼容性
5. **用戶友好** - 清晰的日誌格式和配置選項
