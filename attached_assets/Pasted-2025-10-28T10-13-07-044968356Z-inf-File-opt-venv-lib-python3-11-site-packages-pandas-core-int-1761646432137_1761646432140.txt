2025-10-28T10:13:07.044968356Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:07.044974662Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:07.044981321Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.045707527Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:07.045708618Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:07.045714480Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:07.045716773Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:07.045720627Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.045724724Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.045727075Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.045732543Z [inf]      return method(self, other)
2025-10-28T10:13:07.045737638Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.045742904Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.045750466Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.045756093Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.045761051Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:07.045767631Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:07.045772965Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.267712555Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:07.267720481Z [inf]  2025-10-28 10:13:07,264 - src.strategies.rule_based_signal_generator - ERROR - ❌ ADAUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.267727086Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:07.267728784Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.267733957Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:07.267734280Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.267740532Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:07.267742020Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:07.267746747Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:07.267750227Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.267753089Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.267756661Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:07.267760583Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:07.267762773Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:07.267768089Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:07.267772740Z [inf]  
2025-10-28T10:13:07.267776914Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:07.267781708Z [inf]  
2025-10-28T10:13:07.267785619Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.269009130Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:07.269019672Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:07.269024950Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.269026684Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.269032147Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:07.269033656Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.269037537Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:07.269041994Z [inf]      return method(self, other)
2025-10-28T10:13:07.269049106Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:07.269050589Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.269050893Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:07.269058570Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.269061105Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.269061150Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.269063040Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:07.269068725Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.269070206Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:07.269076602Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.269079347Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:07.269080220Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:07.270048895Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:07.270061338Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:07.270067489Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.270073284Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.270079056Z [inf]      return method(self, other)
2025-10-28T10:13:07.270085844Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.270091125Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.270097012Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.270103189Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.270108313Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:07.270113655Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:07.270119625Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.270125905Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:07.270131562Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:07.270137061Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.355768201Z [inf]  2025-10-28 10:13:07,349 - src.strategies.rule_based_signal_generator - ERROR - ❌ XMRUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.355769510Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.355777332Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.355781018Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:07.355783660Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:07.355790101Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:07.355792228Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:07.355796049Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.355800941Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.355803198Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:07.355809605Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:07.355813366Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:07.355816419Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:07.355821712Z [inf]  
2025-10-28T10:13:07.355825950Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:07.355829953Z [inf]  
2025-10-28T10:13:07.355834212Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.355838684Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:07.355842592Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:07.356906758Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:07.356916678Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:07.356920122Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:07.356926930Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.356934727Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:07.356944437Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:07.356944483Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.356954175Z [inf]      return method(self, other)
2025-10-28T10:13:07.356957557Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:07.356964620Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.356973363Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.356974767Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.356983470Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.356986552Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:07.356995386Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.356997156Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:07.357005673Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:07.357008883Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.357014497Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:07.357021878Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.357888252Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:07.357895104Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:07.357896912Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.357900744Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.357906243Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.357906625Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.357912324Z [inf]      return method(self, other)
2025-10-28T10:13:07.357914720Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:07.357917240Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.357920575Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:07.357924563Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.357926902Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.357932241Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:07.357936317Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:07.357940625Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.508353535Z [inf]  2025-10-28 10:13:07,506 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:13:07.508370721Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.508382712Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:13:07.508390624Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:13:07.508398202Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.508405525Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:13:07.590372249Z [inf]  2025-10-28 10:13:07,571 - src.strategies.rule_based_signal_generator - ERROR - ❌ DASHUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.590385715Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.590394746Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:07.590401809Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:07.590408703Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.590415882Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:07.590422263Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:07.590429986Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:07.590436303Z [inf]  
2025-10-28T10:13:07.590442951Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:07.590449338Z [inf]  
2025-10-28T10:13:07.590456123Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.590464920Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:07.590471367Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:07.590477594Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.590486692Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:07.590493047Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:07.590499295Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.590505492Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:07.591155435Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:07.591164139Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:07.591171967Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.591176280Z [inf]      return method(self, other)
2025-10-28T10:13:07.591181237Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.591185908Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.591190892Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.591195214Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.591199000Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:07.591202825Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:07.591207967Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.591212247Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:07.591216342Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:07.591220060Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.591223949Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:07.591229279Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:07.591233358Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.591237386Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:07.591242336Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:07.591247714Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.592067856Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:07.592075000Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:07.592079336Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.592083442Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.592087393Z [inf]      return method(self, other)
2025-10-28T10:13:07.592091130Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.592096189Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.592102861Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.592108407Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.592114461Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:07.592120002Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:07.592126076Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.592131322Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:07.592136728Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:07.592143404Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.899321757Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:07.899328564Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:07.899339144Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:07.899345723Z [inf]  
2025-10-28T10:13:07.899354318Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:07.899360427Z [inf]  
2025-10-28T10:13:07.899369256Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.899375939Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:07.899382128Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:07.899390604Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.899391020Z [inf]  2025-10-28 10:13:07,792 - src.strategies.rule_based_signal_generator - ERROR - ❌ ZECUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:07.899400105Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:07.899400204Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:07.899407532Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:07.899414013Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.899420268Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:07.899431312Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:07.899440998Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.899450577Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:07.900878381Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:07.900889339Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:07.900894999Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.900901288Z [inf]      return method(self, other)
2025-10-28T10:13:07.900906930Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.900913094Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.900920047Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.900926696Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.900934789Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:07.900942191Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:07.901004809Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901014183Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:07.901021352Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:07.901029129Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901036843Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:07.901044421Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:07.901051470Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901058425Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:07.901065882Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:07.901072875Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901217318Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:07.901224524Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:07.901234141Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901241984Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:07.901249782Z [inf]      return method(self, other)
2025-10-28T10:13:07.901258369Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901266727Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:07.901274656Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:07.901283940Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901292177Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:07.901299496Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:07.901307326Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:07.901315820Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:07.901325620Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:07.901333222Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.031650029Z [inf]  2025-10-28 10:13:08,021 - src.strategies.rule_based_signal_generator - ERROR - ❌ XTZUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.031657848Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.031666141Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:08.031675994Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:08.031683841Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.031692362Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:08.031701880Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:08.031710898Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:08.031718716Z [inf]  
2025-10-28T10:13:08.031727193Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:08.031735062Z [inf]  
2025-10-28T10:13:08.031744359Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.031752687Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:08.031760673Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:08.031768940Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.031776942Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:08.031785306Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:08.031800166Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.031807620Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:08.034180347Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:08.034189741Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:08.034195842Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.034202812Z [inf]      return method(self, other)
2025-10-28T10:13:08.034208652Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034214996Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.034220610Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.034229450Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034234806Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:08.034240565Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:08.034245452Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034251940Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:08.034257787Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:08.034262928Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034268790Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:08.034274446Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:08.034279305Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034283936Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:08.034288503Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:08.034296225Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034301707Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:08.034307588Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:08.034312691Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034318823Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.034324129Z [inf]      return method(self, other)
2025-10-28T10:13:08.034330461Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034339835Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.034344712Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.034349705Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034354358Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:08.034361769Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:08.034367058Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.034372847Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:08.034379383Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:08.034385776Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.255879566Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:08.255890217Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:08.255897343Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.255903595Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:08.255909940Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:08.255918585Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.255924127Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:08.255955801Z [inf]  2025-10-28 10:13:08,248 - src.strategies.rule_based_signal_generator - ERROR - ❌ BNBUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.255961361Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.255971127Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:08.255977060Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:08.255983542Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.255989238Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:08.255995592Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:08.256001461Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:08.256007892Z [inf]  
2025-10-28T10:13:08.256016211Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:08.256021499Z [inf]  
2025-10-28T10:13:08.256028924Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.256966663Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:08.256977951Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:08.256985181Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.256992354Z [inf]      return method(self, other)
2025-10-28T10:13:08.256999370Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:08.256999602Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257007116Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.257012062Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:08.257015630Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.257020808Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257025801Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257030108Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:08.257034324Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:08.257038092Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:08.257043848Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:08.257047030Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257051745Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257057461Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:08.257063068Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:08.257079431Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257875247Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:08.257883858Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:08.257887193Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:08.257889588Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.257892258Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257897361Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.257900790Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.257901532Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.257908961Z [inf]      return method(self, other)
2025-10-28T10:13:08.257911266Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257917787Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257920627Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:08.257927944Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:08.257934559Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.257943806Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:08.477285917Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:08.477296323Z [inf]  2025-10-28 10:13:08,473 - src.strategies.rule_based_signal_generator - ERROR - ❌ ATOMUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.477306499Z [inf]  
2025-10-28T10:13:08.477314887Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.477321452Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:08.477328573Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:08.477333249Z [inf]  
2025-10-28T10:13:08.477342684Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:08.477344211Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.477357491Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.477362210Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:08.477372182Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:08.477373435Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:08.477386648Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:08.477390258Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.477397859Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:08.477404135Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:08.477410770Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.477416046Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:08.478618659Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:08.478623717Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:08.478626312Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:08.478631527Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.478635190Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.478638800Z [inf]      return method(self, other)
2025-10-28T10:13:08.478644794Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:08.478647226Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.478652493Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.478656133Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:08.478663118Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.478666027Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.478671507Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.478677010Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:08.478682408Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:08.478686444Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.478690238Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:08.478696293Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:08.478701830Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.478706220Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:08.479553714Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:08.479562641Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:08.479569293Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.479579067Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.479585472Z [inf]      return method(self, other)
2025-10-28T10:13:08.479591778Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.479599103Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.479606157Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.479611938Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.479618237Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:08.479625091Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:08.479631238Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.479637074Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:08.479643391Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:08.479648908Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.983208039Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.983220720Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:08.983229883Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:08.983239242Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:08.983247564Z [inf]  
2025-10-28T10:13:08.983255486Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:08.983263593Z [inf]  
2025-10-28T10:13:08.983271848Z [inf]  2025-10-28 10:13:08,696 - src.strategies.rule_based_signal_generator - ERROR - ❌ ONTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.983273870Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.983282274Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.983283833Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:08.983291598Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:08.983293152Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:08.983301492Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:08.983335613Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.983343875Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:08.983351259Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:08.983359934Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.983366745Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:08.984018302Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:08.984027037Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:08.984034411Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.984041453Z [inf]      return method(self, other)
2025-10-28T10:13:08.984047766Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984054953Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.984061779Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.984067523Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984073805Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:08.984079571Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:08.984087322Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984093945Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:08.984100536Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:08.984107751Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984113735Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:08.984119667Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:08.984125794Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984131693Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:08.984140779Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:08.984148758Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984565854Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984582006Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:08.984592779Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:08.984601900Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984611926Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:08.984628830Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:08.984631924Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:08.984640065Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:08.984643632Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.984652993Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984654343Z [inf]  2025-10-28 10:13:08,913 - src.strategies.rule_based_signal_generator - ERROR - ❌ IOTAUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:08.984666772Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.984666876Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.984680678Z [inf]      return method(self, other)
2025-10-28T10:13:08.984685147Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:08.984691857Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.984698842Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.984705475Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.985498683Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:08.985505577Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.985513022Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:08.985520990Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:08.985529408Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:08.985537430Z [inf]  
2025-10-28T10:13:08.985545241Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:08.985552458Z [inf]  
2025-10-28T10:13:08.985559508Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:08.985564912Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:08.985570524Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:08.985575756Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.985581225Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:08.985588677Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:08.985594042Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.985599702Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:08.985605155Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:08.985611673Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:08.985618408Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.985625625Z [inf]      return method(self, other)
2025-10-28T10:13:08.985631942Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.986128375Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.986137121Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.986142363Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.986146503Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:08.986150889Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:08.986155258Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.986160165Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:08.986165401Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:08.986170015Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.986174196Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:08.986178133Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:08.986182146Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.986188311Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:08.986192547Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:08.986196492Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.986201112Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:08.986205087Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:08.986210162Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.986214729Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:08.987140238Z [inf]      return method(self, other)
2025-10-28T10:13:08.987150450Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.987156750Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:08.987163177Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:08.987168950Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.987174513Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:08.987180505Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:08.987188018Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:08.987194408Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:08.987200348Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:08.987206926Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.148466225Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.148469761Z [inf]  2025-10-28 10:13:09,141 - src.strategies.rule_based_signal_generator - ERROR - ❌ BATUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.148479371Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.148480343Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:09.148487866Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:09.148490070Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:09.148495086Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:09.148501089Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.148502893Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.148507897Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:09.148511163Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:09.148515170Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:09.148523963Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:09.148529745Z [inf]  
2025-10-28T10:13:09.148535476Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:09.148541216Z [inf]  
2025-10-28T10:13:09.148546756Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.148552403Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:09.148558015Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:09.149728947Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:09.149729097Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:09.149738314Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:09.149739769Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:09.149744596Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.149747192Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.149750262Z [inf]      return method(self, other)
2025-10-28T10:13:09.149754391Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:09.149756073Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.149761568Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.149763643Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:09.149768177Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.149770665Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.149773912Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.149778535Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:09.149782829Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:09.149786652Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.149791240Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:09.149795884Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:09.149800452Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.151298927Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.151304811Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:09.151312924Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:09.151318959Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.151323374Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.151327355Z [inf]      return method(self, other)
2025-10-28T10:13:09.151332170Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.151336674Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.151341644Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.151346491Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.151350734Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:09.151354910Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:09.151358945Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.151366167Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:09.151370900Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:09.360626655Z [inf]  2025-10-28 10:13:09,356 - src.strategies.rule_based_signal_generator - ERROR - ❌ VETUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.360644592Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.360656410Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:09.360664495Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:09.360673442Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.360682156Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:09.360695918Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:09.360704836Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:09.360713620Z [inf]  
2025-10-28T10:13:09.360722983Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:09.360730797Z [inf]  
2025-10-28T10:13:09.360738333Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.360756379Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:09.360764139Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:09.360791266Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.360801045Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:09.360808894Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:09.360816568Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.360823823Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:09.362277804Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.362287487Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:09.362289395Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:09.362297907Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:09.362300337Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:09.362303960Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.362309168Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:09.362311313Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.362315526Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:09.362319809Z [inf]      return method(self, other)
2025-10-28T10:13:09.362321641Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.362327152Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:09.362328713Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.362335944Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:09.362336371Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.362341467Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.362344247Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.362350488Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.362357731Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:09.362364277Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:09.363459929Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:09.363464889Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.363467592Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:09.363472449Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.363476035Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:09.363479205Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.363484528Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:09.363485090Z [inf]      return method(self, other)
2025-10-28T10:13:09.363490548Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.363493304Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.363497894Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.363505962Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.363511354Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.363516544Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:09.363520677Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:09.510055882Z [inf]  2025-10-28 10:13:09,506 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:13:09.510065432Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.510072433Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:13:09.510079627Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:13:09.510086375Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.510095345Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:13:09.584414809Z [inf]  2025-10-28 10:13:09,576 - src.strategies.rule_based_signal_generator - ERROR - ❌ NEOUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.584425410Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.584434979Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:09.584443264Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:09.584449863Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.584456795Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:09.584463586Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:09.584470214Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:09.584476917Z [inf]  
2025-10-28T10:13:09.584483608Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:09.584489538Z [inf]  
2025-10-28T10:13:09.584495805Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.584503930Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:09.584510323Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:09.584516731Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.584527454Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:09.584534240Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:09.584541220Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.584546988Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:09.585507823Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:09.585524395Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:09.585534596Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.585540347Z [inf]      return method(self, other)
2025-10-28T10:13:09.585548313Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.585557513Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.585565205Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.585573091Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.585579480Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:09.585585803Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:09.585592249Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.585597842Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:09.585602842Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:09.585608215Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.585615159Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:09.585620728Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:09.585625334Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.585631271Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:09.585640830Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:09.585648164Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.586613966Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.586625709Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:09.586632393Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:09.586637453Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:09.586649069Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:09.586650967Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.586660764Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.586667332Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.586673321Z [inf]      return method(self, other)
2025-10-28T10:13:09.586679549Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.586685530Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.586691640Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.586698123Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.586704560Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:09.586710771Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:09.983475491Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.983483626Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:09.983488046Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:09.983496431Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:09.983497322Z [inf]  
2025-10-28T10:13:09.983504547Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.983511354Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.983512627Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:09.983530617Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:09.983539908Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:09.983542831Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.983555718Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:09.983559228Z [inf]  2025-10-28 10:13:09,661 - src.strategies.rule_based_signal_generator - ERROR - ❌ QTUMUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.983572466Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.983575407Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:09.983586118Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:09.983590709Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:09.983595443Z [inf]  
2025-10-28T10:13:09.983604216Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:09.985325377Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:09.985337946Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985348031Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:09.985358273Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:09.985371540Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:09.985372939Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:09.985383565Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:09.985389038Z [inf]  
2025-10-28T10:13:09.985394466Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.985403099Z [inf]      return method(self, other)
2025-10-28T10:13:09.985404297Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:09.985409510Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985417134Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.985420245Z [inf]  
2025-10-28T10:13:09.985425865Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.985435613Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.985435741Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985444875Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:09.985452418Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:09.985455431Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:09.985464937Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985468371Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:09.985473166Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:09.985480505Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:09.985487182Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985489908Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985498030Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:09.985505251Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:09.985505368Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:09.985513683Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985520582Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:09.985521793Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:09.985528929Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:09.985536200Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985536631Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985547223Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:09.985555553Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:09.985564714Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:09.985573437Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.985581858Z [inf]      return method(self, other)
2025-10-28T10:13:09.985591171Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985621341Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985626087Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:09.985630658Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:09.985634849Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985639197Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:09.985643767Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:09.985648832Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985653608Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:09.985655532Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.985657608Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:09.985662170Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985666662Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.985670305Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.985679930Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:09.985680509Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985688898Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:09.985690214Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:09.985696945Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985699957Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:09.985702592Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:09.985707543Z [inf]      return method(self, other)
2025-10-28T10:13:09.985711882Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985715450Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985721212Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.985721920Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:09.985727422Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.985732852Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985733230Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:09.985737576Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:09.985742212Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:09.985746978Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.985752318Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:09.985758007Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:09.985763116Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.985769786Z [inf]  2025-10-28 10:13:09,886 - src.strategies.rule_based_signal_generator - ERROR - ❌ IOSTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:09.985773704Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:09.985778871Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:09.986704703Z [inf]      return method(self, other)
2025-10-28T10:13:09.986714256Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.986721775Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:09.986729357Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:09.986737705Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.986744480Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:09.986753730Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:09.986760409Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:09.986766596Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:09.986773611Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:09.986779791Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:10.130904628Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:10.130917065Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.130924458Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:10.130929922Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:10.130935297Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:10.130941410Z [inf]  
2025-10-28T10:13:10.130946724Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:10.130951582Z [inf]  
2025-10-28T10:13:10.130956468Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:10.130961428Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:10.130966771Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:10.130971682Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.130977623Z [inf]  2025-10-28 10:13:10,114 - src.strategies.rule_based_signal_generator - ERROR - ❌ THETAUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:10.130978413Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:10.130985159Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:10.130985701Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:10.130992523Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:10.130993155Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.130998465Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:10.131694109Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:10.131702058Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:10.131705208Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.131708863Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:10.131715739Z [inf]      return method(self, other)
2025-10-28T10:13:10.131716006Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:10.131722836Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.131723217Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:10.131728355Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:10.131729937Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.131733342Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:10.131738015Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.131743258Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:10.131748128Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:10.131753607Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.131757437Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:10.131761367Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:10.344682167Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:10.344686536Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:10.344692226Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:10.344699793Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.344704393Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:10.344708991Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:10.344713560Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.344717639Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:10.345430499Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:10.345439821Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:10.345447307Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:10.345453197Z [inf]      return method(self, other)
2025-10-28T10:13:10.345459293Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.345465611Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:10.345472877Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:10.345474086Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.345479206Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.345484034Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:10.345490197Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:10.345498416Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:10.345504710Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:10.345510468Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.345515842Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:10.345521016Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:10.345526201Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.345540997Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:10.345546133Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:10.345552806Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.346170127Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:10.346176512Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:10.346181808Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.346187510Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:10.346192256Z [inf]      return method(self, other)
2025-10-28T10:13:10.346198718Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.346204055Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:10.346209763Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:10.346215498Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.346449979Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:10.346455727Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:10.346461018Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.346695151Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:10.346729121Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:10.346735747Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:10.571386322Z [inf]  2025-10-28 10:13:10,567 - src.strategies.rule_based_signal_generator - ERROR - ❌ ZILUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:10.571392051Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:10.571398821Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:10.571401001Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:10.571401988Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.571409455Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:10.571415454Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:10.571415599Z [inf]  
2025-10-28T10:13:10.571419656Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:10.571424307Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:10.571428149Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.571429995Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:10.571432785Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.571438425Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:10.571439055Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:10.571446214Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:10.571447427Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:10.571453702Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:10.571459792Z [inf]  
2025-10-28T10:13:10.572514835Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:10.572518651Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.572522512Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.572524108Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:10.572532686Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:10.572533984Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:10.572541191Z [inf]      return method(self, other)
2025-10-28T10:13:10.572541583Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:10.572548355Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.572552270Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.572555500Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:10.572560727Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:10.572562462Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:10.572569467Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.572571200Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:10.572576142Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:10.572581712Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:10.572589019Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.572594401Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:10.572599773Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:10.573407715Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:10.573414331Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:10.573417900Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:10.573424903Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:10.573426326Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.573430061Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.573437157Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:10.573443662Z [inf]      return method(self, other)
2025-10-28T10:13:10.573450613Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:10.573456861Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:10.573461504Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:10.573465217Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.283381132Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:11.283396008Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.283396164Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:11.283405599Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:11.283409150Z [inf]  
2025-10-28T10:13:11.283416676Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:11.283423692Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:11.283433799Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:11.283443891Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.283449138Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:11.284475126Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:11.284482664Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:11.284489517Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:11.284495196Z [inf]      return method(self, other)
2025-10-28T10:13:11.284500322Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.284506237Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:11.284511530Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:11.284517625Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.284525341Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:11.284531088Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:11.284536318Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.284541323Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:11.284546315Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:11.284552479Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.284558271Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:11.284563421Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:11.284568432Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.284574319Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:11.284579908Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:11.284585420Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.286312248Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:11.286317809Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:11.286322343Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.286326260Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:11.286330276Z [inf]      return method(self, other)
2025-10-28T10:13:11.286333800Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.286338354Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:11.286344743Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:11.286350301Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.286356575Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:11.286360819Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:11.286365370Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.286371068Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:11.286376325Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:11.286381546Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:11.498274454Z [inf]  2025-10-28 10:13:11,495 - src.strategies.rule_based_signal_generator - ERROR - ❌ KAVAUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:11.498285003Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:11.498294226Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:11.498300116Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:11.498306440Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.498312486Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:11.498319608Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:11.498461614Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:11.498468260Z [inf]  
2025-10-28T10:13:11.498473436Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:11.498477733Z [inf]  
2025-10-28T10:13:11.498481892Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:11.498487474Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:11.498492134Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:11.498496828Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.498500852Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:11.498505087Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:11.498510184Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.498514609Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:11.499160007Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:11.499166015Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:11.499171484Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:11.499177268Z [inf]      return method(self, other)
2025-10-28T10:13:11.499182528Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.499189406Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:11.499194183Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:11.499197833Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.499208585Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:11.499212883Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:11.499217568Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.499221216Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:11.499224721Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:11.499228541Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.499234513Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:11.499239894Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:11.499244607Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.499249243Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:11.499253981Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:11.499258661Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:11.500795538Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:12.132186733Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:12.132199067Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132208739Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:12.132212297Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132221600Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:12.132233416Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:12.132239018Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132248737Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:12.132264174Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132267279Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:12.132277185Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132280220Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:12.132286622Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:12.132292360Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:12.132947166Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:12.132956127Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:12.132958978Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:12.132969977Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132972521Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132986615Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:12.132986992Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.132987457Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:12.132999791Z [inf]      return method(self, other)
2025-10-28T10:13:12.133004124Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:12.133005338Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:12.133013104Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:12.133021062Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.133027630Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:12.133034269Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:12.352347944Z [inf]  2025-10-28 10:13:12,348 - src.strategies.rule_based_signal_generator - ERROR - ❌ YFIUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:12.352351097Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.352359406Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:12.352363916Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:12.352364543Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:12.352371184Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:12.352379505Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:12.352380282Z [inf]  
2025-10-28T10:13:12.352387587Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.352389883Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:12.352398060Z [inf]  
2025-10-28T10:13:12.352398123Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:12.352405911Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:12.352407448Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:12.352413817Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:12.352418908Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:12.352423498Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.352430729Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:12.352436677Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:12.353267137Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:12.353270655Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:12.353276258Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.353280416Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.353280517Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:12.353283833Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:12.353288260Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:12.353291949Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:12.353292211Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:12.353296117Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:12.353300657Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:12.353302527Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.353303381Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.353311303Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:12.353313003Z [inf]      return method(self, other)
2025-10-28T10:13:12.353319935Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.353320299Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:12.353325984Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.353326616Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:12.353331540Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:12.354230330Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:12.354233844Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:12.354236879Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:12.354241167Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:12.354243598Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.354246658Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.354249373Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:12.354252581Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:12.354254985Z [inf]      return method(self, other)
2025-10-28T10:13:12.354259028Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:12.354260757Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.354265396Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:12.354267231Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:12.354272557Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:12.354277759Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.573595648Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:12.573604572Z [inf]  
2025-10-28T10:13:12.573611589Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:12.573618986Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:12.573625445Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:12.573630654Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:12.573634564Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.573638092Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:12.573642640Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:12.573645168Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:12.573650510Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:12.573651083Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:12.573657466Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:12.573664635Z [inf]  
2025-10-28T10:13:12.573702237Z [inf]  2025-10-28 10:13:12,569 - src.strategies.rule_based_signal_generator - ERROR - ❌ CRVUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:12.573708681Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:12.573714321Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:12.963072848Z [inf]  2025-10-28 10:13:12,789 - src.strategies.rule_based_signal_generator - ERROR - ❌ TRBUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:13.254236273Z [inf]  
2025-10-28T10:13:13.254276729Z [inf]  2025-10-28 10:13:13,236 - src.strategies.rule_based_signal_generator - ERROR - ❌ SUSHIUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:13.254279271Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:13.254286275Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:13.254286409Z [inf]  
2025-10-28T10:13:13.254294789Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:13.254296277Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:13.254302969Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:13.254304792Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:13.254309504Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:13.254314921Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.254317356Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.254321265Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:13.254326540Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:13.254328605Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:13.254335579Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:13.254337204Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.254343785Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:13.254344348Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:13.255212368Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:13.255214573Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:13.255221874Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:13.255226670Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.255227299Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:13.255232979Z [inf]      return method(self, other)
2025-10-28T10:13:13.255238753Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:13.255239941Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.255245477Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:13.255246291Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:13.255251031Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:13.255253280Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.255257917Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.255258598Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:13.255263851Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:13.255264213Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:13.255270281Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:13.255270305Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.255275143Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.255279398Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:13.256094798Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:13.256107396Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:13.256116600Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.256125238Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:13.256135366Z [inf]      return method(self, other)
2025-10-28T10:13:13.256144847Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.256151204Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:13.256158658Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:13.256165350Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.256173812Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:13.256180430Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:13.256188578Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.256195516Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:13.256206177Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:13.256211951Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:13.343291936Z [inf]  2025-10-28 10:13:13,325 - src.strategies.rule_based_signal_generator - ERROR - ❌ EGLDUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:13.343297744Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:13.343303084Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:13.343308299Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:13.343315842Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.343323747Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:13.343331854Z [inf]  
2025-10-28T10:13:13.343332848Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:13.343339683Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:13.343351886Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:13.343362577Z [inf]  
2025-10-28T10:13:13.343371838Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:13.343379953Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:13.343388279Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:13.343398924Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.343408144Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:13.343420383Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:13.343443462Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.343453560Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:13.344716839Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:13.344725471Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:13.344733533Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:13.344737005Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.344744735Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:13.344748170Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:13.344758059Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:13.344764920Z [inf]      return method(self, other)
2025-10-28T10:13:13.344792893Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.344802263Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:13.344811306Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:13.344822606Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.344830976Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:13.344852769Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:13.344859835Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:13.344867005Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.344873864Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:13.344880936Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:13.344887811Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.344899256Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.346897786Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:13.346906497Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:13.346915231Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.346971854Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:13.346978876Z [inf]      return method(self, other)
2025-10-28T10:13:13.346985616Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.346991697Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:13.346998007Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:13.347004996Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.347010683Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:13.347016174Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:13.347021551Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:13.347027870Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:13.347035667Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:13.347041206Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:13.526976040Z [inf]  2025-10-28 10:13:13,509 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:13:13.526981737Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:14.024556649Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:14.101944985Z [inf]  2025-10-28 10:13:14,091 - src.strategies.rule_based_signal_generator - ERROR - ❌ UNIUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:14.101953874Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:14.101960490Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:14.101967855Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:14.101974391Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.101983822Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:14.101990329Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:14.101998208Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:14.102005072Z [inf]  
2025-10-28T10:13:14.102012095Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:14.102018876Z [inf]  
2025-10-28T10:13:14.102025773Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:14.102032164Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:14.102040538Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:14.102050475Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.102058215Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:14.102066210Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:14.102072886Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.102079483Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:14.104327094Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:14.104338768Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:14.104343115Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:14.104348678Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.104356086Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:14.104358233Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:14.104366342Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:14.104366976Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:14.104374755Z [inf]      return method(self, other)
2025-10-28T10:13:14.104376899Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.104383548Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.104384984Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:14.104392495Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:14.104399107Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:14.104401225Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:14.104410921Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.104411399Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.104418684Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:14.104425269Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:14.104433290Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.105748493Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:14.105761111Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:14.105769428Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.105777842Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:14.105788261Z [inf]      return method(self, other)
2025-10-28T10:13:14.105796828Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.105804697Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:14.105813814Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:14.105824696Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.105832393Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:14.105839137Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:14.105846418Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.105854426Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:14.105861655Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:14.105869462Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:14.319975410Z [inf]  
2025-10-28T10:13:14.319990516Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:14.319998367Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:14.320004354Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:14.320010121Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.320016922Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:14.320023267Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:14.320029115Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.320034956Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:14.320076570Z [inf]  2025-10-28 10:13:14,313 - src.strategies.rule_based_signal_generator - ERROR - ❌ AVAXUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:14.320084493Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:14.320093078Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:14.320105163Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:14.320110712Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.320116699Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:14.320122305Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:14.320127128Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:14.320137947Z [inf]  
2025-10-28T10:13:14.320144522Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:14.321220057Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:14.321234888Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:14.321246380Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:14.321256064Z [inf]      return method(self, other)
2025-10-28T10:13:14.321263213Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.321270310Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:14.321275983Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:14.321284482Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:14.321290702Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:15.094342092Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:15.094350140Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094356592Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:15.094362725Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:15.094369105Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094375580Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:15.094384331Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:15.094389791Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094395730Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:15.094402640Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:15.094408511Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094414071Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:15.094420730Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:15.094428440Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094571194Z [inf]  2025-10-28 10:13:14,745 - src.strategies.rule_based_signal_generator - ERROR - ❌ FLMUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:15.094575497Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:15.094579544Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:15.094583893Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:15.094590096Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094594071Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:15.094597929Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:15.094617307Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:15.094625234Z [inf]  
2025-10-28T10:13:15.094629773Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:15.094633806Z [inf]  
2025-10-28T10:13:15.094639269Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:15.094643722Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:15.094647612Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:15.094652091Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094662610Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:15.094666400Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:15.094671250Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094675605Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:15.094730730Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:15.094734732Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:15.094738995Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:15.094742874Z [inf]      return method(self, other)
2025-10-28T10:13:15.094748958Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.094753986Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:15.097668849Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:15.097675470Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:15.097681106Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.097687009Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:15.097692874Z [inf]      return method(self, other)
2025-10-28T10:13:15.097700024Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.097706499Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:15.097712069Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:15.097718869Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.097724627Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:15.097730574Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:15.097736761Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:15.097742942Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:15.097751467Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:15.097763086Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:15.097769246Z [inf]  2025-10-28 10:13:14,963 - src.strategies.rule_based_signal_generator - ERROR - ❌ KSMUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:15.097775400Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:15.097781220Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:15.100197802Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:16.033947208Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:16.033960474Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:16.033968737Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.033975598Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:16.033984424Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:16.033991825Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.033999779Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:16.034076809Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:16.034086742Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:16.034089812Z [inf]  2025-10-28 10:13:15,716 - src.strategies.rule_based_signal_generator - ERROR - ❌ RSRUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:16.034095879Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:16.034098261Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:16.034102275Z [inf]  
2025-10-28T10:13:16.034110024Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:16.034113530Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:16.034117389Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:16.034120865Z [inf]  
2025-10-28T10:13:16.034126486Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.034128745Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:16.035137995Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:16.035148489Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:16.035152174Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:16.035154176Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:16.035157238Z [inf]  2025-10-28 10:13:15,802 - src.strategies.rule_based_signal_generator - ERROR - ❌ LRCUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:16.035160332Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:16.035164581Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:16.035167231Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:16.035170939Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:16.035174769Z [inf]      return method(self, other)
2025-10-28T10:13:16.035180403Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:16.035181749Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035183428Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035191872Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:16.035192395Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:16.035192893Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035199990Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:16.035202351Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:16.035204338Z [inf]      return method(self, other)
2025-10-28T10:13:16.035208433Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035211016Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:16.035215600Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035217560Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:16.035218840Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035226077Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:16.035226368Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:16.035233671Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035240202Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:16.035245000Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:16.035247550Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:16.035253119Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:16.035253385Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035261464Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:16.035267589Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:16.035271813Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.035276375Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:16.035281073Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:16.035284658Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.036214023Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:16.036220595Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.036226424Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:16.036231551Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:16.036236251Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:16.036240932Z [inf]  
2025-10-28T10:13:16.036245609Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:16.036250000Z [inf]  
2025-10-28T10:13:16.036254046Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:16.036259136Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:16.036263558Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:16.036267741Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.036271935Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:16.036276761Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:16.036281702Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.036285829Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:16.036290039Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:16.036294573Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:16.036300723Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:16.036306419Z [inf]      return method(self, other)
2025-10-28T10:13:16.036310719Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.037181049Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:16.037182079Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:16.037188205Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:16.037192945Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.037197401Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:16.037201415Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:16.037205683Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.037210205Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:16.037217331Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:16.037223554Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.037226546Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.037230335Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:16.037236202Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:16.037245863Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:16.037261210Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:16.037283529Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.037299898Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:16.037308727Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:16.037321176Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.038194154Z [inf]      return method(self, other)
2025-10-28T10:13:16.038202817Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:16.038210056Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:17.019634686Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:17.019642069Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:17.019646951Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:17.019651706Z [inf]  
2025-10-28T10:13:17.019656116Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:17.019660211Z [inf]  
2025-10-28T10:13:17.019665469Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:17.019670079Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:17.019673670Z [inf]  2025-10-28 10:13:16,893 - src.strategies.rule_based_signal_generator - ERROR - ❌ SKLUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:17.019674032Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:17.019677806Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:17.019681524Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:17.019685212Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:17.019688457Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.019693347Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:17.019696182Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.019698670Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:17.019703067Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.019707347Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:17.020952443Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:17.020956672Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:17.020962972Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:17.020967759Z [inf]      return method(self, other)
2025-10-28T10:13:17.020972182Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.020976921Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:17.020981740Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:17.021000736Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021008651Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:17.021013394Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:17.021017917Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021022058Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:17.021035895Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:17.021041968Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021058317Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:17.021082453Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:17.021100110Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021121663Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:17.021136257Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:17.021152155Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021158006Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:17.021162462Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:17.021173912Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021178746Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:17.021190963Z [inf]      return method(self, other)
2025-10-28T10:13:17.021195826Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021200377Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:17.021204574Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:17.021217299Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021222485Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:17.021240488Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:17.021245412Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.021250175Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:17.021254264Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:17.021270340Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:17.188902931Z [inf]  2025-10-28 10:13:17,184 - src.strategies.rule_based_signal_generator - ERROR - ❌ GRTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:17.188911344Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.188919504Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:17.188920867Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:17.188922501Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:17.188925977Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:17.188927420Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:17.188932329Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:17.188937074Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.188938768Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.188943165Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:17.188944707Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:17.188945189Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:17.188953028Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.188953221Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:17.188958247Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.188961936Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:17.188963364Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:17.188966938Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:17.188970953Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:17.188971103Z [inf]      return method(self, other)
2025-10-28T10:13:17.188975419Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:17.188980498Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:17.188983806Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.188989661Z [inf]  
2025-10-28T10:13:17.188992309Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:17.189000533Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:17.189000577Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:17.189011102Z [inf]  
2025-10-28T10:13:17.189011355Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.189017992Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:17.189021316Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:17.189027582Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:17.189035573Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:17.189040530Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.189046200Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:17.189051059Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:17.189056128Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.189060912Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:17.190652267Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:17.190663682Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:17.190673335Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.190686319Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:17.190692095Z [inf]      return method(self, other)
2025-10-28T10:13:17.190699252Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.190704992Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:17.665086609Z [inf]  2025-10-28 10:13:17,658 - src.strategies.rule_based_signal_generator - ERROR - ❌ SANDUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:17.665121203Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:17.665128028Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:17.665135672Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:17.665142890Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.665150202Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:17.665158111Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:17.665165649Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:17.665172649Z [inf]  
2025-10-28T10:13:17.665180630Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:17.665188173Z [inf]  
2025-10-28T10:13:17.665195532Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:17.665202696Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:17.665209236Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:17.665217868Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.665225139Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:17.665233569Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:17.665240503Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.665248022Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:17.666142778Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.666158234Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:17.666166876Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:17.666174376Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:17.666180675Z [inf]      return method(self, other)
2025-10-28T10:13:17.666187530Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.666193810Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:17.666202263Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:17.666209352Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.666215545Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:17.666221372Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:17.666228144Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.666234336Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:17.666242395Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:17.666249395Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.666254854Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:17.666260566Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:17.666267520Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.666273921Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:17.666279520Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:17.667122045Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:17.667126394Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.667131152Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:17.667138391Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:17.667140718Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.667147619Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:17.667149825Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:17.667157141Z [inf]      return method(self, other)
2025-10-28T10:13:17.667159031Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.667166055Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:17.667167338Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:17.667174688Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:17.667176158Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:17.667183737Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:17.667184229Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:18.115121711Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.115134913Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:18.115136090Z [inf]  2025-10-28 10:13:17,943 - src.strategies.rule_based_signal_generator - ERROR - ❌ ANKRUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:18.115144358Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:18.115145877Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:18.115153001Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.115160778Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:18.115171713Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:18.115177357Z [inf]  
2025-10-28T10:13:18.115186161Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:18.115189365Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:18.115194831Z [inf]  
2025-10-28T10:13:18.115201754Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:18.115202862Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:18.115207017Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:18.115223348Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:18.115223733Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:18.115235484Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:18.115240567Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118338244Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:18.118346728Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:18.118353670Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:18.118360864Z [inf]      return method(self, other)
2025-10-28T10:13:18.118371338Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118379279Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:18.118386464Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:18.118395767Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118402411Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:18.118415389Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:18.118422432Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118430546Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:18.118438172Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:18.118446469Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118453493Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:18.118459742Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:18.118468153Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118476301Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:18.118483872Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:18.118490322Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118496848Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:18.118503835Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:18.118510617Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118516990Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:18.118523147Z [inf]      return method(self, other)
2025-10-28T10:13:18.118529128Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118535718Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:18.118542447Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:18.118548664Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118555053Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:18.118561834Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:18.118568669Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.118574835Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:18.118581064Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:18.118587931Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:18.281381558Z [inf]  2025-10-28 10:13:18,231 - src.strategies.rule_based_signal_generator - ERROR - ❌ RVNUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:18.281393688Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:18.281403658Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:18.281413187Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:18.281421855Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:18.281429592Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:18.281436244Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:18.281443565Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:18.281451440Z [inf]  
2025-10-28T10:13:18.281460472Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:19.036819540Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:19.036832993Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:19.036842415Z [inf]      return method(self, other)
2025-10-28T10:13:19.036849653Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.036857802Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:19.036866371Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:19.036874453Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.036892730Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:19.037164227Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:19.037174354Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:19.037185263Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:19.037188510Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.037200978Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:19.037201937Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:19.037210687Z [inf]  2025-10-28 10:13:18,836 - src.strategies.rule_based_signal_generator - ERROR - ❌ COTIUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:19.037211885Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.037217970Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:19.037224317Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:19.037225507Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:19.037236043Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:19.037238084Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:19.037246025Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.037251122Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:19.037259440Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.037266037Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:19.037273083Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:19.037278827Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:19.037284354Z [inf]  
2025-10-28T10:13:19.037290320Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:19.037296060Z [inf]  
2025-10-28T10:13:19.037302432Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:19.037309170Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:19.037314829Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:19.037324626Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.037324705Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.037334389Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:19.037340939Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:19.037347008Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.037352796Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:19.038597388Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:19.038603679Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:19.038610260Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.038618001Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:19.038624915Z [inf]      return method(self, other)
2025-10-28T10:13:19.038636608Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.038643156Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:19.038651109Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:19.038659091Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.038667468Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:19.038674555Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:19.038681218Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.038689409Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:19.038695852Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:19.038702835Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:19.145176155Z [inf]  2025-10-28 10:13:19,143 - src.strategies.rule_based_signal_generator - ERROR - ❌ CHRUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:19.145182964Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:19.145188523Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:19.145197295Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:19.145202657Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.145203803Z [inf]  
2025-10-28T10:13:19.145211109Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:19.145217243Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:19.145217421Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:19.145224739Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:19.145227480Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:19.145232731Z [inf]  
2025-10-28T10:13:19.145236163Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:19.145239830Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:19.145244263Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.145250970Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:19.145256445Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:19.145262344Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.145267860Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:19.146308973Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:19.146317784Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:19.146325733Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:19.146331640Z [inf]      return method(self, other)
2025-10-28T10:13:19.146337931Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.146346095Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:19.146352175Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:19.146356913Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.146361191Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:19.146366308Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:19.146372162Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.698369779Z [inf]  2025-10-28 10:13:19,695 - src.strategies.rule_based_signal_generator - ERROR - ❌ ONEUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:19.698376919Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:19.698387133Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:19.698394777Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.698407035Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:19.698411174Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:19.698422627Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:19.698428138Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:19.698434111Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.698443035Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.698446716Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:19.698456169Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:19.698465562Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:19.698473484Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:19.698482734Z [inf]  
2025-10-28T10:13:19.698492081Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:19.698503241Z [inf]  
2025-10-28T10:13:19.698511805Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:19.698520946Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:19.699604750Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:19.699613113Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:19.699618931Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.699630872Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:19.699635971Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:19.699641474Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:19.699645704Z [inf]      return method(self, other)
2025-10-28T10:13:19.699650069Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.699656993Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:19.699661742Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:19.699666891Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.699673076Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:19.699677821Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:19.699682139Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.699686007Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:19.699691086Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:19.699697298Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.699702710Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:19.699707017Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:19.699711468Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.700380606Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:19.700396686Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:19.700404713Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.700412764Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:19.700420120Z [inf]      return method(self, other)
2025-10-28T10:13:19.700427235Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.700434587Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:19.700441977Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:19.700448847Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.700455733Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:19.700461747Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:19.700468120Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:19.700475054Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:19.700481434Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:19.700488000Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:20.108605474Z [inf]  2025-10-28 10:13:19,986 - src.strategies.rule_based_signal_generator - ERROR - ❌ DENTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:20.108611646Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:20.108618467Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:20.108624009Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:20.108631256Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.108637931Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:20.108647708Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:20.108658927Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:20.108667260Z [inf]  
2025-10-28T10:13:20.108674151Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:20.108681970Z [inf]  
2025-10-28T10:13:20.108687885Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:20.108694388Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:20.108701273Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:20.108707447Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.108713350Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:20.108719209Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:20.108725301Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.108733501Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:20.109533285Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:20.109540987Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:20.109549448Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:20.109563107Z [inf]      return method(self, other)
2025-10-28T10:13:20.109571089Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.109579214Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:20.109586679Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:20.109594354Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.109608220Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:20.109616877Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:20.109625332Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.109633705Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:20.109641588Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:20.109649923Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.109658054Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:20.109665273Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:20.109673771Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.109681113Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:20.109689538Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:20.109697651Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.110004473Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:20.110017508Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:20.110026261Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.110035202Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:20.110042335Z [inf]      return method(self, other)
2025-10-28T10:13:20.110048673Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.110062043Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:20.685245320Z [inf]  2025-10-28 10:13:20,679 - src.strategies.rule_based_signal_generator - ERROR - ❌ NKNUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:20.685260326Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:20.685273148Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:20.685284453Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:20.685293401Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.685300723Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:20.685308660Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:20.685315442Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:20.685322873Z [inf]  
2025-10-28T10:13:20.685330699Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:20.685337827Z [inf]  
2025-10-28T10:13:20.685344984Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:20.685350550Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:20.685356010Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:20.685360826Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.685365621Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:20.685370452Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:20.685375873Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.685380596Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:20.686368884Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:20.686378353Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:20.686383370Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:20.686383710Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:20.686390674Z [inf]      return method(self, other)
2025-10-28T10:13:20.686397540Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.686398808Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:20.686402663Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:20.686408741Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:20.686409953Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.686416123Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.686422139Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:20.686427658Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:20.686428925Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:20.686434362Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.686437808Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:20.686440298Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:20.686447779Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:20.686447951Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.686452944Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.687790653Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:20.687795912Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:20.687800437Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:20.687804647Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.687808916Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:20.687813180Z [inf]      return method(self, other)
2025-10-28T10:13:20.687817611Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.687827040Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:20.687831161Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:20.687835005Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.687839159Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:20.687843268Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:20.687847172Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:20.687851554Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:20.687857330Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:21.070817903Z [inf]  2025-10-28 10:13:20,764 - src.strategies.rule_based_signal_generator - ERROR - ❌ 1000SHIBUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:21.070823933Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:21.070829987Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:21.070835839Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:21.070842491Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.070848413Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:21.070855385Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:21.070861580Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:21.070867722Z [inf]  
2025-10-28T10:13:21.070873672Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:21.070880124Z [inf]  
2025-10-28T10:13:21.070886653Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:21.128486335Z [inf]  2025-10-28 10:13:21,110 - src.strategies.rule_based_signal_generator - ERROR - ❌ C98USDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:21.372014565Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:21.372025154Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:21.372030949Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:21.372036188Z [inf]  
2025-10-28T10:13:21.372041236Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:21.372047721Z [inf]  
2025-10-28T10:13:21.372052491Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:21.372057634Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:21.372061558Z [inf]  2025-10-28 10:13:21,366 - src.strategies.rule_based_signal_generator - ERROR - ❌ DYDXUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:21.372063556Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:21.372067815Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:21.372069824Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.372074654Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:21.372080296Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:21.372086136Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:21.372087459Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.372093668Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:21.372097069Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:21.372102318Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.373734383Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.373734550Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.373735283Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:21.373743886Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:21.373746318Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:21.373748734Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:21.373753262Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:21.373754654Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:21.373755990Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:21.373756313Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:21.373760607Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.373764394Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.373765065Z [inf]      return method(self, other)
2025-10-28T10:13:21.373767127Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:21.373772467Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.373773765Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:21.373775675Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.373782834Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:21.373784760Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:21.373789834Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:21.374791602Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:21.374797874Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:21.374799312Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.374805148Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:21.374808202Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:21.374811966Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:21.374816200Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.374818875Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:21.374823065Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:21.374828736Z [inf]      return method(self, other)
2025-10-28T10:13:21.374834455Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.374839903Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:21.374845637Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:21.374850699Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.374856584Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:21.483226309Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:21.483241053Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:21.483251032Z [inf]  
2025-10-28T10:13:21.483259115Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:21.483267468Z [inf]  
2025-10-28T10:13:21.483275988Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:21.483284243Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:21.483292166Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:21.483300017Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.483308274Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:21.483316950Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:21.483325893Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.483335290Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:21.483435674Z [inf]  2025-10-28 10:13:21,453 - src.strategies.rule_based_signal_generator - ERROR - ❌ 1000XECUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:21.483440442Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:21.483445158Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:21.483450688Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:21.483457053Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.483462258Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:21.484164274Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:21.484175591Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:21.484176660Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.484185219Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:21.484185498Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:21.484193238Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:21.484193908Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:21.484201271Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.484202599Z [inf]      return method(self, other)
2025-10-28T10:13:21.484210502Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.484211549Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:21.484218915Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:21.484220665Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:21.484226770Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:21.484231394Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.484232979Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.484238690Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:21.484244138Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:21.484250835Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.484256488Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:21.485349056Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:21.485363027Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:21.485368577Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:21.485374000Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:21.485379612Z [inf]      return method(self, other)
2025-10-28T10:13:21.485385986Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.370609014Z [inf]  2025-10-28 10:13:22,343 - src.strategies.rule_based_signal_generator - ERROR - ❌ PEOPLEUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:22.370615715Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:22.370625114Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:22.370632276Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:22.370638162Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.370644742Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:22.370649789Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:22.370655413Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:22.370661704Z [inf]  
2025-10-28T10:13:22.370667915Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:22.370673604Z [inf]  
2025-10-28T10:13:22.370690596Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:22.370696517Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:22.370702250Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:22.370708418Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.370713546Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:22.370720797Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:22.370727449Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.370734140Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:22.371524339Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:22.371532390Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:22.371539122Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:22.371541157Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.371546102Z [inf]      return method(self, other)
2025-10-28T10:13:22.371553191Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:22.371556197Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.371562471Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:22.371564588Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:22.371569497Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.371573185Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:22.371576894Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:22.371580961Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.371585456Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:22.371587149Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:22.371592688Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.371593288Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:22.371598942Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.371603104Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:22.371607999Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:22.373028448Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:22.373039159Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:22.373047569Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.373053840Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:22.373060472Z [inf]      return method(self, other)
2025-10-28T10:13:22.373067404Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.373083693Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:22.373115147Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:22.373121236Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.373130089Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:22.373138105Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:22.373145085Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.373151876Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:22.373162273Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:22.373168152Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:22.433912070Z [inf]  2025-10-28 10:13:22,430 - src.strategies.rule_based_signal_generator - ERROR - ❌ ROSEUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:22.433919164Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:22.433926038Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:22.433931792Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:22.433937776Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.433944886Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:22.433951891Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:22.433957103Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:22.433962927Z [inf]  
2025-10-28T10:13:22.433968057Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:22.433972934Z [inf]  
2025-10-28T10:13:22.433977567Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:22.433981891Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:22.433986946Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:22.433992772Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.433998869Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:22.434003637Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:22.434008068Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:22.434013827Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:22.435006571Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:22.435019607Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:22.435029733Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:22.435037880Z [inf]      return method(self, other)
2025-10-28T10:13:22.435046298Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.113570219Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:23.113821115Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:23.139868058Z [inf]  
2025-10-28T10:13:23.139874702Z [inf]  2025-10-28 10:13:23,133 - src.strategies.rule_based_signal_generator - ERROR - ❌ JASMYUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:23.139879719Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:23.139883470Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:23.139890043Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:23.139891067Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:23.139898432Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:23.139899201Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:23.139907101Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.139910121Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.139916436Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:23.139916757Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:23.139924410Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:23.139927163Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:23.139933708Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:23.139934959Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.139942461Z [inf]  
2025-10-28T10:13:23.139943166Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:23.139949419Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:23.140803830Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:23.140809857Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.140811512Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:23.140811699Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:23.140818769Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:23.140819116Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:23.140822495Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:23.140825919Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:23.140827718Z [inf]      return method(self, other)
2025-10-28T10:13:23.140831159Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.140833534Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.140836868Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.140841486Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:23.140845123Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:23.140847033Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:23.140851826Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:23.140852593Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.140857325Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:23.140861793Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:23.140866080Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.142063002Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:23.142069895Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:23.142072520Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:23.142078028Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.142081551Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:23.142084654Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:23.142089011Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.142090056Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:23.142095171Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:23.142097912Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:23.142101267Z [inf]      return method(self, other)
2025-10-28T10:13:23.142107078Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.142117448Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:23.142121627Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:23.142125679Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.236740451Z [inf]  2025-10-28 10:13:23,217 - src.strategies.rule_based_signal_generator - ERROR - ❌ OPUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:23.236757395Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:23.236764134Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:23.236784214Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:23.236792292Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.236799376Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:23.236804374Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:23.236809535Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:23.236814989Z [inf]  
2025-10-28T10:13:23.236820329Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:23.236826310Z [inf]  
2025-10-28T10:13:23.236830831Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:23.236837105Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:23.236841320Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:23.236845759Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.236851503Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:23.236855822Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:23.236860399Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.236865125Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:23.238020730Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:23.238028536Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:23.238028617Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:23.238035242Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:23.238037939Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:23.238041415Z [inf]      return method(self, other)
2025-10-28T10:13:23.238045961Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.238051502Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:23.238053353Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.238057343Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:23.238060288Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:23.238064585Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.238065864Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:23.238071367Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.238071542Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:23.238078667Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:23.238078696Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:23.238083875Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.238086356Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:23.238090418Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.239170778Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:23.239179461Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:23.239191223Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:23.666001752Z [inf]  2025-10-28 10:13:23,653 - src.strategies.rule_based_signal_generator - ERROR - ❌ LUNA2USDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:24.095859650Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:24.095864159Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:24.095868513Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.095872995Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:24.095876636Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:24.095880622Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.095885255Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:24.095889339Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:24.095893557Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.095899111Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:24.095904331Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:24.095910292Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.095915877Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:24.095922083Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:24.095927857Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.095934568Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:24.095941275Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:24.095946623Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.095951628Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:24.096980114Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.096985089Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:24.096986496Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:24.096992269Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:24.096992598Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:24.096996730Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.097001113Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:24.097005949Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:24.097010449Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:24.097015454Z [inf]  2025-10-28 10:13:23,998 - src.strategies.rule_based_signal_generator - ERROR - ❌ QNTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:24.097021314Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:24.097031262Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:24.097038845Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:24.097045446Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.097136371Z [inf]      return method(self, other)
2025-10-28T10:13:24.097145107Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.097156878Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:24.097165071Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:24.098303098Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:24.098309035Z [inf]  
2025-10-28T10:13:24.098313537Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:24.098317992Z [inf]  
2025-10-28T10:13:24.098323120Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:24.098327945Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:24.098333291Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:24.098338526Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.098342680Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:24.098346788Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:24.098351087Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.098356184Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:24.098360347Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:24.098364294Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:24.098369846Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:24.098375215Z [inf]      return method(self, other)
2025-10-28T10:13:24.098379525Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.098383447Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:24.098387858Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:24.098393379Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.098397291Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:24.099154049Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:24.099157915Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.099162230Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:24.099165802Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:24.099169502Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.099173034Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:24.099176970Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:24.099181535Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.099185171Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:24.099188860Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:24.099192631Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.099196270Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:24.099200049Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:24.099203969Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.099207714Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:24.099212317Z [inf]      return method(self, other)
2025-10-28T10:13:24.099216029Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.099219514Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:24.099224280Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:24.099227963Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.100467590Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:24.100471789Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:24.100476590Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.100480311Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:24.100484189Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:24.100488425Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:24.100492459Z [inf]  2025-10-28 10:13:24,086 - src.strategies.rule_based_signal_generator - ERROR - ❌ FETUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:24.100496865Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:24.100501759Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:24.100505807Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:24.100509720Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.100513568Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:24.100518148Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:24.100522247Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:24.100526278Z [inf]  
2025-10-28T10:13:24.100530596Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:24.100534806Z [inf]  
2025-10-28T10:13:24.100538685Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:24.100581344Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:24.101780655Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:24.101784803Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:24.272563979Z [inf]  
2025-10-28T10:13:25.237499534Z [inf]  2025-10-28 10:13:24,775 - src.strategies.rule_based_signal_generator - ERROR - ❌ PHBUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:25.237503754Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:25.237508303Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:25.237512687Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:25.237518949Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237523312Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:25.237528057Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:25.237532068Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:25.237537312Z [inf]  
2025-10-28T10:13:25.237543060Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:25.237548090Z [inf]  
2025-10-28T10:13:25.237552596Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:25.237559063Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:25.237563321Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:25.237568755Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237574670Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:25.237579310Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:25.237584575Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237589261Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:25.237669010Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:25.237673843Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:25.237677835Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:25.237682256Z [inf]      return method(self, other)
2025-10-28T10:13:25.237686101Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237691110Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:25.237695188Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:25.237699324Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237703827Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:25.237708090Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:25.237712095Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237721383Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:25.237725588Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:25.237730763Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237735030Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:25.237739138Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:25.237744094Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.237748188Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:25.237751805Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:25.237762590Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.238008389Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:25.238014351Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:25.238018605Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.238022629Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:25.238027483Z [inf]      return method(self, other)
2025-10-28T10:13:25.238031551Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.238038157Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:25.238042179Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:25.238046479Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.238052315Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:25.584223993Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:25.584229377Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:25.584234344Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.584240153Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:25.584244263Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:25.584249259Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:25.584262319Z [inf]  
2025-10-28T10:13:25.584271326Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:25.584276460Z [inf]  
2025-10-28T10:13:25.584281486Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:25.584286606Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:25.584291113Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:25.584298021Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.584301883Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:25.584306281Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:25.584311376Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.584315870Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:25.585368348Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:25.585370218Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:25.585376353Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:25.585381523Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:25.585381558Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.585382647Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.585387932Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:25.585391816Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:25.585393624Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:25.585398518Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.585399387Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:25.585403909Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:25.585405870Z [inf]      return method(self, other)
2025-10-28T10:13:25.585411110Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.585416261Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:25.585421123Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:25.585426503Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.585431816Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:25.585436439Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:25.585440704Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.586601711Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:25.586607059Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:25.586610908Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.586614664Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:25.586618919Z [inf]      return method(self, other)
2025-10-28T10:13:25.586623247Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.669402857Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.669414169Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:25.669425050Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:25.669442442Z [inf]  
2025-10-28T10:13:25.669450537Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:25.669458081Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:25.669465385Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:25.669473464Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.669479945Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:25.669486102Z [inf]  2025-10-28 10:13:25,665 - src.strategies.rule_based_signal_generator - ERROR - ❌ USDCUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:25.669488965Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:25.669493650Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:25.669500134Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:25.669505016Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:25.669509656Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:25.669514958Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:25.669519328Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:25.669524887Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:25.669529896Z [inf]  
2025-10-28T10:13:25.670682150Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:26.223372222Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:26.223377030Z [inf]  
2025-10-28T10:13:26.223382459Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:26.223387161Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:26.223392574Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:26.223401319Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.223405933Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:26.223410771Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:26.223415653Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.223420707Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:26.224728143Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:26.224737114Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:26.224743346Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:26.224749255Z [inf]      return method(self, other)
2025-10-28T10:13:26.224757093Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.224820081Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:26.224875224Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:26.224881314Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.224887413Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:26.224893555Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:26.224899150Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.226923173Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:26.310547946Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.310555947Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.310563885Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:26.310565741Z [inf]  2025-10-28 10:13:26,302 - src.strategies.rule_based_signal_generator - ERROR - ❌ XVSUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:26.310569713Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:26.310575663Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:26.310580315Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:26.310581412Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:26.310587961Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.310593009Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:26.310596341Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:26.310601418Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:26.310605730Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:26.310608721Z [inf]  
2025-10-28T10:13:26.310616548Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:26.310622045Z [inf]  
2025-10-28T10:13:26.310626875Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:26.310633750Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:26.310640330Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:26.311872235Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:26.311879875Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:26.311890454Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:26.311901810Z [inf]      return method(self, other)
2025-10-28T10:13:26.311907825Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.311913325Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:26.311919150Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:26.311924995Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.311930205Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:26.311936069Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:26.311942389Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.311947679Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:26.311952963Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:26.311958671Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.311963847Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:26.311969484Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:26.311975545Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.311981859Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:26.311988120Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:26.311994464Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.313508809Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:26.313521734Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:26.313528486Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.313534824Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:26.408417634Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:26.408436116Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:26.408443823Z [inf]  
2025-10-28T10:13:26.408450202Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:26.408455963Z [inf]  
2025-10-28T10:13:26.408462790Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:26.408470329Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:26.408477326Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:26.408482770Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.408483437Z [inf]  2025-10-28 10:13:26,390 - src.strategies.rule_based_signal_generator - ERROR - ❌ BLURUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:26.408489815Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:26.408489985Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:26.408495638Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:26.408498213Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:26.408502135Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:26.408505500Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.408509038Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.408513378Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:26.408517690Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:26.410797485Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:26.410803837Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:26.410812370Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:26.410819016Z [inf]      return method(self, other)
2025-10-28T10:13:26.410826226Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.410832017Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:26.410837778Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:26.410853594Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:26.499603902Z [inf]  2025-10-28 10:13:26,486 - src.strategies.rule_based_signal_generator - ERROR - ❌ EDUUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:27.146310392Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.146322256Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:27.146332861Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:27.146344578Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.146349110Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.146355608Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:27.146366213Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:27.146375582Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:27.146383069Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:27.146383976Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.146391006Z [inf]  
2025-10-28T10:13:27.146393695Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:27.146397793Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:27.146404212Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:27.146407147Z [inf]  
2025-10-28T10:13:27.146413555Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:27.146414700Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:27.146423150Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:27.146423397Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:27.146430099Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:27.146436082Z [inf]      return method(self, other)
2025-10-28T10:13:27.147514665Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:27.147518330Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.147522191Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:27.147525902Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:27.147530454Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.147534520Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:27.147538413Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:27.147542242Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.147547819Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:27.147553458Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:27.147561401Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.147566730Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:27.147573129Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:27.147578209Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.147583622Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:27.147589880Z [inf]      return method(self, other)
2025-10-28T10:13:27.147597630Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.147603332Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:27.147609707Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:27.147615033Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.148948618Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:27.148953827Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:27.148959391Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.148965056Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:27.148971414Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:27.148976755Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:27.148982022Z [inf]  2025-10-28 10:13:27,091 - src.strategies.rule_based_signal_generator - ERROR - ❌ XVGUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:27.148987682Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:27.148994354Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:27.149001281Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:27.149006761Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.149012338Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:27.149017660Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:27.149023179Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:27.149029421Z [inf]  
2025-10-28T10:13:27.149035496Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:27.149041434Z [inf]  
2025-10-28T10:13:27.149046745Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:27.149052060Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:27.149979551Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:27.149983210Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.149987112Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:27.799326737Z [inf]  2025-10-28 10:13:27,796 - src.strategies.rule_based_signal_generator - ERROR - ❌ OXTUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:27.799339938Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.799340446Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:27.799350188Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:27.799351132Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:27.799357603Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:27.799366120Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.799375606Z [inf]  
2025-10-28T10:13:27.799375847Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:27.799385103Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:27.799391676Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:27.799396024Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:27.799404252Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:27.799406760Z [inf]  
2025-10-28T10:13:27.799417896Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:27.799418614Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:27.799430615Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.799440769Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:27.799451007Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:27.801236176Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.801236414Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.801247737Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:27.801250090Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:27.801252520Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:27.801257995Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:27.801260855Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:27.801269494Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.801272626Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:27.801277298Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:27.801284493Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:27.801286467Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:27.801294376Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.801299585Z [inf]      return method(self, other)
2025-10-28T10:13:27.801303524Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:27.801313659Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:27.801314688Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:27.801324523Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:27.801331430Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:27.803716482Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:28.259472162Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:28.259472962Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:28.259480750Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:28.259483200Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.259484236Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:28.259492678Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:28.259494202Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:28.259494784Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.259500580Z [inf]  
2025-10-28T10:13:28.259504697Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:28.259507652Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:28.259513513Z [inf]  
2025-10-28T10:13:28.259519977Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:28.259525579Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:28.259533724Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:28.259539417Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.259545240Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:28.259552941Z [inf]  2025-10-28 10:13:27,886 - src.strategies.rule_based_signal_generator - ERROR - ❌ SEIUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:28.259560397Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:28.262276518Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:28.262282716Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:28.262289148Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:28.262293955Z [inf]      return method(self, other)
2025-10-28T10:13:28.262299186Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.262304812Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:28.262310457Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:28.262314738Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.262319953Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:28.546761319Z [inf]  2025-10-28 10:13:28,516 - src.strategies.rule_based_signal_generator - ERROR - ❌ RIFUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:28.546768578Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:28.546774458Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:28.546781492Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:28.546787038Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.546793139Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:28.546809045Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:28.546817386Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:28.546825575Z [inf]  
2025-10-28T10:13:28.546831981Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:28.546838496Z [inf]  
2025-10-28T10:13:28.546845357Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:28.546851479Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:28.546857659Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:28.546864122Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.546870171Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:28.546876551Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:28.546883214Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.546889926Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:28.548297876Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.548304197Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:28.548310768Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:28.548312852Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:28.548317911Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:28.548319427Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:28.548323559Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.548327669Z [inf]      return method(self, other)
2025-10-28T10:13:28.548329060Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:28.548334258Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.548334639Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:28.548340403Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.548341072Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:28.548346252Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:28.548346967Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:28.548351710Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:28.548353818Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.548357122Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.548361238Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:28.548365592Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:28.549746601Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:28.549754742Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:28.549759030Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.549763288Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:28.549767537Z [inf]      return method(self, other)
2025-10-28T10:13:28.549772746Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.549779211Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:28.549783065Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:28.549787380Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.549792435Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:28.549797437Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:28.549801854Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.549806776Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:28.549811002Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:28.549814963Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:28.609461288Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:28.609490049Z [inf]  2025-10-28 10:13:28,606 - src.strategies.rule_based_signal_generator - ERROR - ❌ POLYXUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:28.609496974Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:28.609503424Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:28.609509441Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:28.609515514Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.609520506Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:28.609526839Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:28.609533320Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:28.609539391Z [inf]  
2025-10-28T10:13:28.609545789Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:28.609554659Z [inf]  
2025-10-28T10:13:28.609560878Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:28.609567663Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:28.609573819Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:28.609584823Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.609596099Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:28.609603016Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:28.609610461Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.611376883Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.611389847Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:28.611400647Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:28.611408169Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:28.611414601Z [inf]      return method(self, other)
2025-10-28T10:13:28.611420885Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.611430415Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:28.611439802Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:28.611446293Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.611452387Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:28.611460331Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:28.611465976Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.611471560Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:28.611475976Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:28.612324430Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:28.710877806Z [inf]  2025-10-28 10:13:28,694 - src.strategies.rule_based_signal_generator - ERROR - ❌ GASUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:28.710885218Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:28.710891307Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:28.710897725Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:28.710903585Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:28.710910828Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:28.710917182Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:28.710923532Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:28.710929511Z [inf]  
2025-10-28T10:13:29.422063151Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:29.422069748Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.422089113Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:29.422096379Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:29.422105479Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.422112466Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:29.424204086Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:29.424211538Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:29.424216905Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:29.424222023Z [inf]      return method(self, other)
2025-10-28T10:13:29.424227413Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.424232971Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:29.424238041Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:29.424242910Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.424246921Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:29.424251539Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:29.424256349Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.424260937Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:29.424265939Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:29.424270849Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.424274782Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:29.424278932Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:29.424283811Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.424288711Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:29.424294023Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:29.424300293Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.425976978Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:29.425983233Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:29.425987609Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.425991645Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:29.425996265Z [inf]      return method(self, other)
2025-10-28T10:13:29.426000846Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.426006451Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:29.426015225Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:29.426019393Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.426024538Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:29.426029162Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:29.426033442Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.426038117Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:29.426042433Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:29.426047742Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:29.494000267Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.494012793Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:29.494022552Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:29.494030222Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.494037230Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:29.494052096Z [inf]  2025-10-28 10:13:29,483 - src.strategies.rule_based_signal_generator - ERROR - ❌ ILVUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:29.494057988Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:29.494063013Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:29.494067730Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:29.494073311Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.494078271Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:29.494083911Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:29.494088962Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:29.494096707Z [inf]  
2025-10-28T10:13:29.494101427Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:29.494106715Z [inf]  
2025-10-28T10:13:29.494111510Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:29.494116483Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:29.494121454Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:29.495084818Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:29.495092524Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:29.495096910Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:29.495101289Z [inf]      return method(self, other)
2025-10-28T10:13:29.495105879Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.495110823Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:29.495115399Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:29.495119809Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.495124093Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:29.495128205Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:29.495132814Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.495139081Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:29.495143239Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:29.495148814Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.495153544Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:29.496416452Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:29.522448733Z [inf]  2025-10-28 10:13:29,518 - src.core.position_controller - ERROR - ❌ 獲取持倉失敗: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:13:29.522454746Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:29.522460482Z [inf]    File "/app/src/core/position_controller.py", line 135, in _fetch_all_positions
2025-10-28T10:13:29.522466713Z [inf]      raw_positions = await self.binance_client.get_position_info_async()
2025-10-28T10:13:29.522470870Z [inf]                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:29.522475453Z [inf]  AttributeError: 'BinanceClient' object has no attribute 'get_position_info_async'
2025-10-28T10:13:29.571486447Z [inf]  2025-10-28 10:13:29,568 - src.strategies.rule_based_signal_generator - ERROR - ❌ NTRNUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:29.571498286Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:29.571506519Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:30.269809472Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:30.269814328Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:30.269819118Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.269825114Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:30.269830387Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:30.269835727Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.269844035Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:30.271036589Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.271042004Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:30.271044918Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:30.271052107Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:30.271058660Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:30.271064724Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.271071988Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:30.271073966Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:30.271075606Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:30.271082243Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:30.271082649Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:30.271090422Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:30.271090594Z [inf]  2025-10-28 10:13:30,194 - src.strategies.rule_based_signal_generator - ERROR - ❌ ONGUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:30.271099656Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:30.271101336Z [inf]  
2025-10-28T10:13:30.271108821Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:30.271110172Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:30.271120001Z [inf]  
2025-10-28T10:13:30.271123684Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:30.273042310Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:30.273051870Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.273059771Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:30.273066740Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:30.273074048Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:30.273081252Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.273083294Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.273106205Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:30.273123317Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:30.273128970Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:30.273132095Z [inf]      return method(self, other)
2025-10-28T10:13:30.273141307Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.273143354Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.273147227Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:30.273152353Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:30.273152661Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:30.273156624Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.273160568Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:30.273167838Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:30.273170989Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:30.274615992Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:30.274624482Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.274631293Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:30.274663188Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:30.274671774Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.274679277Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:30.285819797Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:30.285829908Z [inf]  2025-10-28 10:13:30,281 - src.strategies.rule_based_signal_generator - ERROR - ❌ ETHWUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:30.285830878Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:30.285838289Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.285844479Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:30.286976755Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:30.288621536Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:30.376072598Z [inf]  2025-10-28 10:13:30,371 - src.strategies.rule_based_signal_generator - ERROR - ❌ JTOUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:30.376077050Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:30.376082003Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:30.376087090Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:30.376090966Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:30.376095785Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.376100045Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:30.376107333Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.376112228Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:30.376115333Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:30.376122602Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:30.376129475Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:30.376136699Z [inf]  
2025-10-28T10:13:30.376143670Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:30.376149900Z [inf]  
2025-10-28T10:13:30.376155999Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:30.376163895Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:30.376169182Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:30.376174248Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.377677938Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:30.377678532Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:30.377686362Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:30.377686751Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.377691897Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:30.377738925Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:30.377744948Z [inf]      return method(self, other)
2025-10-28T10:13:30.377749275Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.377753507Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:30.377757643Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:30.377763331Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:30.377768103Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:31.170465987Z [inf]               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.170472418Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.170472903Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:31.170478103Z [inf]      res_values = op(lvalues, rvalues)
2025-10-28T10:13:31.170483096Z [inf]                   ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.170488647Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:31.170490702Z [inf]      return method(self, other)
2025-10-28T10:13:31.170497885Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.170503254Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:31.170507014Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:31.170512540Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:31.170515996Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:31.170521152Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.170526915Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:31.170532258Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:31.170537984Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.170540970Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:31.170543943Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:31.170546826Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.170550463Z [inf]      result = func(self.values, **kwargs)
2025-10-28T10:13:31.171479333Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:31.171486860Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1008, in _cmp_method
2025-10-28T10:13:31.171493158Z [inf]      return invalid_comparison(self, other, op)
2025-10-28T10:13:31.171493339Z [inf]      raise TypeError(f"Invalid comparison between dtype={left.dtype} and {typ}")
2025-10-28T10:13:31.171499729Z [inf]  TypeError: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:31.171500614Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.171508478Z [inf]  2025-10-28 10:13:31,148 - src.strategies.rule_based_signal_generator - ERROR - ❌ WIFUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:31.171509280Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/invalid.py", line 40, in invalid_comparison
2025-10-28T10:13:31.171514148Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:31.171518723Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:31.171523098Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:31.171529605Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.171533990Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:31.171538251Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:31.171542558Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:31.171549210Z [inf]  
2025-10-28T10:13:31.171553771Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:31.171557670Z [inf]  
2025-10-28T10:13:31.171564980Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:31.174069499Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:31.174106228Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:31.174116821Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:31.174129307Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.174136055Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:31.174145372Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:31.174152388Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.247671203Z [inf]  2025-10-28 10:13:31,241 - src.strategies.rule_based_signal_generator - ERROR - ❌ MANTAUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:31.247682259Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:31.247688858Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:31.247694686Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:31.247699896Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.247705817Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:31.247714054Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:31.247719419Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:31.247724550Z [inf]  
2025-10-28T10:13:31.247730501Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:31.247736061Z [inf]  
2025-10-28T10:13:31.247741515Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:31.247746744Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:31.247751341Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:31.247756659Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.247761843Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:31.247767175Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]
2025-10-28T10:13:31.247776112Z [inf]                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.247784831Z [inf]    File "/app/src/utils/indicators.py", line 92, in calculate_rsi
2025-10-28T10:13:31.249138292Z [inf]      gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
2025-10-28T10:13:31.249145354Z [inf]                ^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.249147678Z [inf]                          ^^^^^^^^^
2025-10-28T10:13:31.249154850Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
2025-10-28T10:13:31.249154953Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/blocks.py", line 395, in apply
2025-10-28T10:13:31.249162266Z [inf]      return method(self, other)
2025-10-28T10:13:31.249163848Z [inf]      new_data = self._dispatch_frame_op(other, op, axis=axis)
2025-10-28T10:13:31.249168259Z [inf]             ^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.249175059Z [inf]                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.249175132Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 56, in __gt__
2025-10-28T10:13:31.249182196Z [inf]      return self._cmp_method(other, operator.gt)
2025-10-28T10:13:31.249184697Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7967, in _dispatch_frame_op
2025-10-28T10:13:31.249188580Z [inf]             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.249194357Z [inf]      bm = self._mgr.apply(array_op, right=right)
2025-10-28T10:13:31.249194772Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 7922, in _cmp_method
2025-10-28T10:13:31.249202509Z [inf]           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.249211861Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/internals/managers.py", line 361, in apply
2025-10-28T10:13:31.249217728Z [inf]      applied = b.apply(f, **kwargs)
2025-10-28T10:13:31.251287290Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 330, in comparison_op
2025-10-28T10:13:31.346674966Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:31.346685642Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:31.346692369Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:31.346696921Z [inf]  2025-10-28 10:13:31,328 - src.strategies.rule_based_signal_generator - ERROR - ❌ ONDOUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:31.346698647Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.346704599Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:31.346706466Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:31.346713091Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:31.346720191Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:31.346726626Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:31.346731740Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:31.346736689Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:31.346741288Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:31.346746170Z [inf]  
2025-10-28T10:13:31.346750474Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:31.346754520Z [inf]  
2025-10-28T10:13:32.184745094Z [inf]  2025-10-28 10:13:31,850 - src.strategies.rule_based_signal_generator - ERROR - ❌ DYMUSDT 信號生成失敗: Invalid comparison between dtype=timedelta64[ns] and int
2025-10-28T10:13:32.184750124Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:32.184755268Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 1006, in _cmp_method
2025-10-28T10:13:32.184760315Z [inf]      other = self._validate_comparison_value(other)
2025-10-28T10:13:32.184766034Z [inf]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:32.184783307Z [inf]    File "/opt/venv/lib/python3.11/site-packages/pandas/core/arrays/datetimelike.py", line 565, in _validate_comparison_value
2025-10-28T10:13:32.184788096Z [inf]      raise InvalidComparison(other)
2025-10-28T10:13:32.184793486Z [inf]  pandas.errors.InvalidComparison: 0
2025-10-28T10:13:32.184799206Z [inf]  
2025-10-28T10:13:32.184804834Z [inf]  During handling of the above exception, another exception occurred:
2025-10-28T10:13:32.184810101Z [inf]  
2025-10-28T10:13:32.184815505Z [inf]  Traceback (most recent call last):
2025-10-28T10:13:32.184820209Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 76, in generate_signal
2025-10-28T10:13:32.184824609Z [inf]      indicators = self._calculate_all_indicators(h1_data, m15_data, m5_data)
2025-10-28T10:13:32.184829069Z [inf]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-10-28T10:13:32.184834157Z [inf]    File "/app/src/strategies/rule_based_signal_generator.py", line 204, in _calculate_all_indicators
2025-10-28T10:13:32.184840036Z [inf]      indicators['rsi'] = calculate_rsi(m5_data, period=14).iloc[-1]