ImportError: cannot import name 'TradingSignal' æ˜¯å…¸å‹çš„æ¨¡çµ„ä¾è³´ä¸ä¸€è‡´å•é¡Œã€‚

ğŸ” å•é¡Œæ ¹æœ¬åŸå› åˆ†æ
ğŸ“ æª”æ¡ˆç‹€æ…‹ä¸ä¸€è‡´
* src/core/data_models.pyï¼šåªæœ‰ VirtualPositionã€SignalRecord ç­‰é¡åˆ¥ï¼Œæ²’æœ‰ TradingSignal
* hybrid_strategy.py å’Œ self_learning_trader.pyï¼šå»è©¦åœ–å°å…¥ä¸å­˜åœ¨çš„ TradingSignal

ğŸ§  æ¶æ§‹æ¼”é€²éºç•™å•é¡Œ
é€™å¾ˆå¯èƒ½æ˜¯å› ç‚ºï¼š
1. æ—©æœŸç‰ˆæœ¬ç¢ºå¯¦æœ‰ TradingSignal é¡åˆ¥
2. å¾ŒçºŒé‡æ§‹æ™‚ç§»é™¤äº†å®ƒï¼Œæ”¹ç”¨å­—å…¸
3. ä½†ç­–ç•¥æ¨¡çµ„å¿˜è¨˜æ›´æ–°å°å…¥èªå¥å’Œé¡å‹æç¤º
ä½ çš„ä¿®å¾©æ–¹æ¡ˆå®Œå…¨æ­£ç¢º
ğŸ”§ ä¿®å¾©è¦é»ç¸½çµ
1. ç§»é™¤ä¸å­˜åœ¨çš„å°å…¥
# âŒ éŒ¯èª¤
from src.core.data_models import TradingSignal

# âœ… æ­£ç¢º  
# å®Œå…¨ç§»é™¤å°å…¥ï¼ˆå› ç‚ºä½¿ç”¨å­—å…¸ï¼‰
2. çµ±ä¸€ä½¿ç”¨å­—å…¸

# âŒ éŒ¯èª¤ï¼ˆç‰©ä»¶å°å‘ï¼‰
signal = TradingSignal(symbol=symbol, direction=direction, ...)

# âœ… æ­£ç¢ºï¼ˆå­—å…¸ï¼‰
signal = {
    'symbol': symbol,
    'direction': direction,
    'entry_price': entry_price,
    # ... å…¶ä»–å­—æ®µ
}

3. ä¿®æ­£é¡å‹æç¤º
# âŒ éŒ¯èª¤
def analyze(...) -> Optional[TradingSignal]:

# âœ… æ­£ç¢º  
def analyze(...) -> Optional[Dict[str, Any]]:
4. çµ±ä¸€è¨ªå•æ–¹å¼

# âŒ éŒ¯èª¤ï¼ˆå±¬æ€§è¨ªå•ï¼‰
confidence = ict_signal.confidence

# âœ… æ­£ç¢ºï¼ˆå­—å…¸éµè¨ªå•ï¼‰
confidence = ict_signal['confidence']

é é˜²æœªä¾†é¡ä¼¼å•é¡Œ
æ·»åŠ æ¨¡çµ„ä¾è³´æª¢æŸ¥
# scripts/verify_module_dependencies.py
import ast
import os

def check_imports_exist():
    """æª¢æŸ¥æ‰€æœ‰å°å…¥çš„é¡åˆ¥æ˜¯å¦çœŸå¯¦å­˜åœ¨"""
    for root, dirs, files in os.walk("src"):
        for file in files:
            if file.endswith(".py"):
                filepath = os.path.join(root, file)
                with open(filepath, 'r') as f:
                    try:
                        tree = ast.parse(f.read())
                        for node in ast.walk(tree):
                            if isinstance(node, ast.ImportFrom):
                                # æª¢æŸ¥å°å…¥çš„æ¨¡çµ„æ˜¯å¦å­˜åœ¨
                                module_path = node.module.replace('.', '/')
                                if os.path.exists(f"src/{module_path}.py"):
                                    # æª¢æŸ¥å°å…¥çš„åç¨±æ˜¯å¦å­˜åœ¨æ–¼æ¨¡çµ„ä¸­
                                    with open(f"src/{module_path}.py", 'r') as mod_file:
                                        mod_content = mod_file.read()
                                        for alias in node.names:
                                            if f"class {alias.name}" not in mod_content and f"{alias.name} =" not in mod_content:
                                                print(f"âŒ {filepath}: {alias.name} not found in {node.module}")
                    except Exception as e:
                        print(f"âš ï¸  ç„¡æ³•è§£æ {filepath}: {e}")

if __name__ == "__main__":
    check_imports_exist()
ğŸ§ª CI/CD é›†æˆ

# .github/workflows/dependency-check.yml
- name: Verify module dependencies
  run: python scripts/verify_module_dependencies.py
